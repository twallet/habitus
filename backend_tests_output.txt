[dotenv@17.2.3] injecting env (19) from config\.env -- tip: âš™ï¸  load multiple .env files with { path: ['.env.local', '.env'] }

[1m[46m RUN [49m[22m [36mv4.0.14 [39m[90mD:/Code/habitus[39m

 [32mâœ“[39m backend/src/db/__tests__/database.test.ts[2m > [22mDatabase[2m > [22mConstructor and Path Resolution[2m > [22mshould use :memory: when provided as custom path[32m 6[2mms[22m[39m
 [32mâœ“[39m backend/src/db/__tests__/database.test.ts[2m > [22mDatabase[2m > [22mConstructor and Path Resolution[2m > [22mshould use file: URI when provided as custom path[32m 2[2mms[22m[39m
 [32mâœ“[39m backend/src/db/__tests__/database.test.ts[2m > [22mDatabase[2m > [22mConstructor and Path Resolution[2m > [22mshould resolve relative custom path[32m 2[2mms[22m[39m
 [32mâœ“[39m backend/src/db/__tests__/database.test.ts[2m > [22mDatabase[2m > [22mConstructor and Path Resolution[2m > [22mshould resolve absolute custom path[32m 2[2mms[22m[39m
 [32mâœ“[39m backend/src/db/__tests__/database.test.ts[2m > [22mDatabase[2m > [22mConstructor and Path Resolution[2m > [22mshould use DB_PATH environment variable when set[32m 2[2mms[22m[39m
 [32mâœ“[39m backend/src/db/__tests__/database.test.ts[2m > [22mDatabase[2m > [22mConstructor and Path Resolution[2m > [22mshould use relative DB_PATH environment variable[32m 1[2mms[22m[39m
 [32mâœ“[39m backend/src/db/__tests__/database.test.ts[2m > [22mDatabase[2m > [22mConstructor and Path Resolution[2m > [22mshould create data directory when using default path[32m 50[2mms[22m[39m
 [32mâœ“[39m backend/src/db/__tests__/database.test.ts[2m > [22mDatabase[2m > [22minitialize[2m > [22mshould initialize database with :memory:[32m 8[2mms[22m[39m
[90mstderr[2m | backend/src/db/__tests__/database.test.ts[2m > [22m[2mDatabase[2m > [22m[2minitialize[2m > [22m[2mshould enable foreign keys
[22m[39m[2026-01-15T18:50:45.749Z] ERROR   | DATABASE | Query execution failed: INSERT INTO child (id, parent_id) VALUES (1, 999) [Error: SQLITE_CONSTRAINT: FOREIGN KEY constraint failed] {
  errno: [33m19[39m,
  code: [32m'SQLITE_CONSTRAINT'[39m
}

 [32mâœ“[39m backend/src/services/__tests__/emailService.test.ts[2m > [22mEmailService[2m > [22mconstructor[2m > [22mshould use environment variables when no config provided[32m 4[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/emailService.test.ts[2m > [22mEmailService[2m > [22mconstructor[2m > [22mshould use provided config over environment variables[32m 1[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/emailService.test.ts[2m > [22mEmailService[2m > [22mconstructor[2m > [22mshould use defaults when no config or environment variables[32m 1[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/emailService.test.ts[2m > [22mEmailService[2m > [22msendMagicLink[2m > [22mshould send registration magic link email successfully[32m 5[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/emailService.test.ts[2m > [22mEmailService[2m > [22msendMagicLink[2m > [22mshould send login magic link email successfully[32m 1[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/emailService.test.ts[2m > [22mEmailService[2m > [22msendMagicLink[2m > [22mshould include magic link in email[32m 1[2mms[22m[39m
 [32mâœ“[39m backend/src/models/__tests__/Tracking.test.ts[2m > [22mTracking Model[2m > [22mconstructor[2m > [22mshould create Tracking instance with provided data[32m 7[2mms[22m[39m
 [32mâœ“[39m backend/src/models/__tests__/Tracking.test.ts[2m > [22mTracking Model[2m > [22mconstructor[2m > [22mshould create Tracking instance with minimal data[32m 3[2mms[22m[39m
 [32mâœ“[39m backend/src/models/__tests__/Tracking.test.ts[2m > [22mTracking Model[2m > [22mvalidate[2m > [22mshould validate and normalize tracking fields[32m 2[2mms[22m[39m
 [32mâœ“[39m backend/src/models/__tests__/Tracking.test.ts[2m > [22mTracking Model[2m > [22mvalidate[2m > [22mshould throw error for invalid question[32m 2[2mms[22m[39m
 [32mâœ“[39m backend/src/models/__tests__/Tracking.test.ts[2m > [22mTracking Model[2m > [22msave[2m > [22mshould create new tracking when id is not set[32m 3[2mms[22m[39m
 [32mâœ“[39m backend/src/models/__tests__/Tracking.test.ts[2m > [22mTracking Model[2m > [22msave[2m > [22mshould update existing tracking when id is set[32m 5[2mms[22m[39m
 [32mâœ“[39m backend/src/models/__tests__/Tracking.test.ts[2m > [22mTracking Model[2m > [22msave[2m > [22mshould throw error if creation fails[32m 4[2mms[22m[39m
 [32mâœ“[39m backend/src/models/__tests__/Tracking.test.ts[2m > [22mTracking Model[2m > [22mupdate[2m > [22mshould update tracking fields[32m 2[2mms[22m[39m
 [32mâœ“[39m backend/src/models/__tests__/Tracking.test.ts[2m > [22mTracking Model[2m > [22mupdate[2m > [22mshould throw error if tracking has no id[32m 2[2mms[22m[39m
 [32mâœ“[39m backend/src/models/__tests__/Tracking.test.ts[2m > [22mTracking Model[2m > [22mdelete[2m > [22mshould delete tracking from database[32m 2[2mms[22m[39m
 [32mâœ“[39m backend/src/models/__tests__/Tracking.test.ts[2m > [22mTracking Model[2m > [22mdelete[2m > [22mshould throw error if tracking has no id[32m 2[2mms[22m[39m
 [32mâœ“[39m backend/src/models/__tests__/Tracking.test.ts[2m > [22mTracking Model[2m > [22mdelete[2m > [22mshould throw error if tracking not found[32m 2[2mms[22m[39m
 [32mâœ“[39m backend/src/models/__tests__/Tracking.test.ts[2m > [22mTracking Model[2m > [22mtoData[2m > [22mshould convert tracking instance to TrackingData[32m 2[2mms[22m[39m
 [32mâœ“[39m backend/src/models/__tests__/Tracking.test.ts[2m > [22mTracking Model[2m > [22mloadById[2m > [22mshould load tracking by id[32m 3[2mms[22m[39m
 [32mâœ“[39m backend/src/models/__tests__/Tracking.test.ts[2m > [22mTracking Model[2m > [22mloadById[2m > [22mshould return null for non-existent tracking[32m 2[2mms[22m[39m
 [32mâœ“[39m backend/src/models/__tests__/Tracking.test.ts[2m > [22mTracking Model[2m > [22mloadById[2m > [22mshould return null for tracking belonging to different user[32m 2[2mms[22m[39m
 [32mâœ“[39m backend/src/models/__tests__/Tracking.test.ts[2m > [22mTracking Model[2m > [22mloadByUserId[2m > [22mshould load all trackings for a user[32m 5[2mms[22m[39m
 [32mâœ“[39m backend/src/models/__tests__/Tracking.test.ts[2m > [22mTracking Model[2m > [22mloadByUserId[2m > [22mshould return empty array when user has no trackings[32m 3[2mms[22m[39m
 [32mâœ“[39m backend/src/models/__tests__/Tracking.test.ts[2m > [22mTracking Model[2m > [22mvalidateQuestion[2m > [22mshould accept valid questions[32m 2[2mms[22m[39m
 [32mâœ“[39m backend/src/models/__tests__/Tracking.test.ts[2m > [22mTracking Model[2m > [22mvalidateQuestion[2m > [22mshould trim whitespace[32m 1[2mms[22m[39m
 [32mâœ“[39m backend/src/models/__tests__/Tracking.test.ts[2m > [22mTracking Model[2m > [22mvalidateQuestion[2m > [22mshould throw TypeError for empty question[32m 2[2mms[22m[39m
 [32mâœ“[39m backend/src/models/__tests__/Tracking.test.ts[2m > [22mTracking Model[2m > [22mvalidateQuestion[2m > [22mshould throw TypeError for non-string question[32m 3[2mms[22m[39m
 [32mâœ“[39m backend/src/models/__tests__/Tracking.test.ts[2m > [22mTracking Model[2m > [22mvalidateQuestion[2m > [22mshould throw TypeError for question exceeding max length[32m 2[2mms[22m[39m
 [32mâœ“[39m backend/src/models/__tests__/Tracking.test.ts[2m > [22mTracking Model[2m > [22mvalidateQuestion[2m > [22mshould accept question with exactly MAX_QUESTION_LENGTH characters[32m 2[2mms[22m[39m
 [32mâœ“[39m backend/src/models/__tests__/Tracking.test.ts[2m > [22mTracking Model[2m > [22mvalidateNotes[2m > [22mshould accept valid notes[32m 2[2mms[22m[39m
 [32mâœ“[39m backend/src/models/__tests__/Tracking.test.ts[2m > [22mTracking Model[2m > [22mvalidateNotes[2m > [22mshould return undefined for empty/null/undefined notes[32m 3[2mms[22m[39m
 [32mâœ“[39m backend/src/models/__tests__/Tracking.test.ts[2m > [22mTracking Model[2m > [22mvalidateNotes[2m > [22mshould throw TypeError for non-string notes[32m 3[2mms[22m[39m
 [32mâœ“[39m backend/src/models/__tests__/Tracking.test.ts[2m > [22mTracking Model[2m > [22mvalidateUserId[2m > [22mshould accept valid user IDs[32m 2[2mms[22m[39m
 [32mâœ“[39m backend/src/models/__tests__/Tracking.test.ts[2m > [22mTracking Model[2m > [22mvalidateUserId[2m > [22mshould throw TypeError for invalid user ID format[32m 5[2mms[22m[39m
 [32mâœ“[39m backend/src/models/__tests__/Tracking.test.ts[2m > [22mTracking Model[2m > [22mvalidateUserId[2m > [22mshould throw TypeError for non-number user ID[32m 3[2mms[22m[39m
 [32mâœ“[39m backend/src/models/__tests__/Tracking.test.ts[2m > [22mTracking Model[2m > [22mvalidateUserId[2m > [22mshould throw TypeError for NaN[32m 2[2mms[22m[39m
 [32mâœ“[39m backend/src/models/__tests__/Tracking.test.ts[2m > [22mTracking Model[2m > [22mvalidateIcon[2m > [22mshould accept valid icons[32m 2[2mms[22m[39m
 [32mâœ“[39m backend/src/models/__tests__/Tracking.test.ts[2m > [22mTracking Model[2m > [22mvalidateIcon[2m > [22mshould trim whitespace[32m 2[2mms[22m[39m
 [32mâœ“[39m backend/src/models/__tests__/Tracking.test.ts[2m > [22mTracking Model[2m > [22mvalidateIcon[2m > [22mshould return undefined for empty/null/undefined icons[32m 2[2mms[22m[39m
 [32mâœ“[39m backend/src/models/__tests__/Tracking.test.ts[2m > [22mTracking Model[2m > [22mvalidateIcon[2m > [22mshould throw TypeError for non-string icons[32m 2[2mms[22m[39m
 [32mâœ“[39m backend/src/db/__tests__/database.test.ts[2m > [22mDatabase[2m > [22minitialize[2m > [22mshould initialize database with file path[32m 42[2mms[22m[39m
 [32mâœ“[39m backend/src/db/__tests__/database.test.ts[2m > [22mDatabase[2m > [22minitialize[2m > [22mshould enable foreign keys[32m 8[2mms[22m[39m
 [32mâœ“[39m backend/src/db/__tests__/database.test.ts[2m > [22mDatabase[2m > [22minitialize[2m > [22mshould enable WAL mode for file-based databases[32m 40[2mms[22m[39m
 [32mâœ“[39m backend/src/db/__tests__/database.test.ts[2m > [22mDatabase[2m > [22minitialize[2m > [22mshould create users table[32m 6[2mms[22m[39m
 [32mâœ“[39m backend/src/db/__tests__/database.test.ts[2m > [22mDatabase[2m > [22minitialize[2m > [22mshould create trackings table[32m 6[2mms[22m[39m
 [32mâœ“[39m backend/src/db/__tests__/database.test.ts[2m > [22mDatabase[2m > [22minitialize[2m > [22mshould create indexes[32m 9[2mms[22m[39m
[90mstderr[2m | backend/src/services/__tests__/userService.test.ts[2m > [22m[2mUserService[2m > [22m[2mupdateProfile[2m > [22m[2mshould handle file deletion errors gracefully
[22m[39m[2026-01-15T18:50:45.855Z] USER | Error deleting old profile picture file for userId: 1: Error: File system error
    at Object.<anonymous> (D:/Code/habitus/backend/src/services/__tests__/userService.test.ts:455:17)
    at Object.unlinkSync [90m(file:///D:/Code/habitus/[39mnode_modules/[4m@vitest/spy[24m/dist/index.js:280:34[90m)[39m
    at UserService.updateProfile (D:/Code/habitus/backend/src/services/userService.ts:150:16)
    at D:/Code/habitus/backend/src/services/__tests__/userService.test.ts:467:7
    at [90mfile:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:919:20

 [32mâœ“[39m backend/src/services/__tests__/userService.test.ts[2m > [22mUserService[2m > [22mgetAllUsers[2m > [22mshould return empty array when no users exist[32m 6[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/userService.test.ts[2m > [22mUserService[2m > [22mgetAllUsers[2m > [22mshould return all users ordered by id[32m 4[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/userService.test.ts[2m > [22mUserService[2m > [22mgetAllUsers[2m > [22mshould return users with correct structure[32m 3[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/userService.test.ts[2m > [22mUserService[2m > [22mgetAllUsers[2m > [22mshould return users with optional fields when present[32m 2[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/userService.test.ts[2m > [22mUserService[2m > [22mgetAllUsers[2m > [22mshould return undefined for optional fields when null[32m 3[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/userService.test.ts[2m > [22mUserService[2m > [22mgetUserById[2m > [22mshould return null for non-existent user[32m 4[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/userService.test.ts[2m > [22mUserService[2m > [22mgetUserById[2m > [22mshould return user for existing id[32m 2[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/userService.test.ts[2m > [22mUserService[2m > [22mgetUserById[2m > [22mshould return user with correct structure[32m 3[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/userService.test.ts[2m > [22mUserService[2m > [22mgetUserById[2m > [22mshould return user with optional fields when present[32m 2[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/userService.test.ts[2m > [22mUserService[2m > [22mgetUserById[2m > [22mshould return undefined for optional fields when null[32m 2[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/userService.test.ts[2m > [22mUserService[2m > [22mupdateProfile[2m > [22mshould update user name[32m 3[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/userService.test.ts[2m > [22mUserService[2m > [22mupdateProfile[2m > [22mshould update profile picture URL[32m 2[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/userService.test.ts[2m > [22mUserService[2m > [22mupdateProfile[2m > [22mshould update multiple fields at once[32m 2[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/userService.test.ts[2m > [22mUserService[2m > [22mupdateProfile[2m > [22mshould throw error if no fields to update[32m 3[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/userService.test.ts[2m > [22mUserService[2m > [22mupdateProfile[2m > [22mshould throw error if user not found[32m 2[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/userService.test.ts[2m > [22mUserService[2m > [22mupdateProfile[2m > [22mshould remove profile picture when profilePictureUrl is null[32m 2[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/userService.test.ts[2m > [22mUserService[2m > [22mupdateProfile[2m > [22mshould delete old profile picture file when updating to new one[32m 4[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/userService.test.ts[2m > [22mUserService[2m > [22mupdateProfile[2m > [22mshould handle profile picture URL with query parameters and fragments[32m 4[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/userService.test.ts[2m > [22mUserService[2m > [22mupdateProfile[2m > [22mshould handle invalid profile picture URL format gracefully[32m 4[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/userService.test.ts[2m > [22mUserService[2m > [22mupdateProfile[2m > [22mshould handle file deletion errors gracefully[32m 12[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/userService.test.ts[2m > [22mUserService[2m > [22mupdateProfile[2m > [22mshould handle missing old profile picture file gracefully[32m 3[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/userService.test.ts[2m > [22mUserService[2m > [22mupdateProfile[2m > [22mshould protect against path traversal in profile picture filename[32m 4[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/userService.test.ts[2m > [22mUserService[2m > [22mdeleteUser[2m > [22mshould delete user successfully[32m 3[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/userService.test.ts[2m > [22mUserService[2m > [22mdeleteUser[2m > [22mshould throw error if user not found[32m 2[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/userService.test.ts[2m > [22mUserService[2m > [22mdeleteUser[2m > [22mshould delete profile picture file when user has profile picture URL[32m 4[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/userService.test.ts[2m > [22mUserService[2m > [22mdeleteUser[2m > [22mshould handle missing profile picture file gracefully[32m 4[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/userService.test.ts[2m > [22mUserService[2m > [22mdeleteUser[2m > [22mshould handle invalid profile picture URL format gracefully[32m 3[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/userService.test.ts[2m > [22mUserService[2m > [22mdeleteUser[2m > [22mshould handle profile picture URL with query parameters and fragments[32m 3[2mms[22m[39m
[90mstderr[2m | backend/src/services/__tests__/userService.test.ts[2m > [22m[2mUserService[2m > [22m[2mdeleteUser[2m > [22m[2mshould handle file deletion errors gracefully and still delete user
[22m[39m[2026-01-15T18:50:45.896Z] USER | Error deleting profile picture file for userId: 1: Error: File system error
    at Object.<anonymous> (D:/Code/habitus/backend/src/services/__tests__/userService.test.ts:776:17)
    at Object.unlinkSync [90m(file:///D:/Code/habitus/[39mnode_modules/[4m@vitest/spy[24m/dist/index.js:280:34[90m)[39m
    at UserService.deleteUser (D:/Code/habitus/backend/src/services/userService.ts:498:16)
    at D:/Code/habitus/backend/src/services/__tests__/userService.test.ts:782:7
    at [90mfile:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:919:20

[90mstderr[2m | backend/src/db/__tests__/database.test.ts[2m > [22m[2mDatabase[2m > [22m[2mrun[2m > [22m[2mshould handle query errors
[22m[39m[2026-01-15T18:50:45.897Z] ERROR   | DATABASE | Query execution failed: INSERT INTO nonexistent_table (col) VALUES (?) [Error: SQLITE_ERROR: no such table: nonexistent_table] {
  errno: [33m1[39m,
  code: [32m'SQLITE_ERROR'[39m
}

[90mstderr[2m | backend/src/db/__tests__/database.test.ts[2m > [22m[2mDatabase[2m > [22m[2mrun[2m > [22m[2mshould handle invalid SQL
[22m[39m[2026-01-15T18:50:45.902Z] ERROR   | DATABASE | Query execution failed: INVALID SQL STATEMENT [Error: SQLITE_ERROR: near "INVALID": syntax error] {
  errno: [33m1[39m,
  code: [32m'SQLITE_ERROR'[39m
}

[90mstderr[2m | backend/src/middleware/__tests__/upload.test.ts[2m > [22m[2mUpload Middleware[2m > [22m[2mCloudinary Storage[2m > [22m[2muploadToCloudinary[2m > [22m[2mshould handle Cloudinary upload errors
[22m[39m[2026-01-15T18:50:45.911Z] UPLOAD | Cloudinary upload failed: Error: Cloudinary upload failed
    at D:/Code/habitus/backend/src/middleware/__tests__/upload.test.ts:954:27
    at [90mfile:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
    at [90mfile:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:919:26
    at [90mfile:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1244:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1210:10[90m)[39m
    at [90mfile:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1654:37
    at Traces.$ [90m(file:///D:/Code/habitus/[39mnode_modules/[4mvitest[24m/dist/chunks/traces.U4xDYhzZ.js:115:27[90m)[39m
    at trace [90m(file:///D:/Code/habitus/[39mnode_modules/[4mvitest[24m/dist/chunks/test.DqQZzsWf.js:234:21[90m)[39m
    at runTest [90m(file:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1654:12[90m)[39m

[90mstderr[2m | backend/src/db/__tests__/database.test.ts[2m > [22m[2mDatabase[2m > [22m[2mget[2m > [22m[2mshould handle query errors
[22m[39m[2026-01-15T18:50:45.919Z] ERROR   | DATABASE | Query execution failed: SELECT * FROM nonexistent_table WHERE id = ? [Error: SQLITE_ERROR: no such table: nonexistent_table] {
  errno: [33m1[39m,
  code: [32m'SQLITE_ERROR'[39m
}

 [32mâœ“[39m backend/src/__tests__/server.test.ts[2m > [22mServer Configuration - Integration Tests[2m > [22mTrust Proxy Configuration[2m > [22mshould set trust proxy when TRUST_PROXY is true[32m 5[2mms[22m[39m
 [32mâœ“[39m backend/src/__tests__/server.test.ts[2m > [22mServer Configuration - Integration Tests[2m > [22mTrust Proxy Configuration[2m > [22mshould not set trust proxy when TRUST_PROXY is not true[32m 1[2mms[22m[39m
 [32mâœ“[39m backend/src/__tests__/server.test.ts[2m > [22mServer Configuration - Integration Tests[2m > [22mRequest Logging Middleware Logic[2m > [22mshould log requests in production mode[32m 46[2mms[22m[39m
 [32mâœ“[39m backend/src/__tests__/server.test.ts[2m > [22mServer Configuration - Integration Tests[2m > [22mRequest Logging Middleware Logic[2m > [22mshould log errors in development mode[32m 12[2mms[22m[39m
 [32mâœ“[39m backend/src/__tests__/server.test.ts[2m > [22mServer Configuration - Integration Tests[2m > [22mRequest Logging Middleware Logic[2m > [22mshould skip logging for Vite HMR routes in development[32m 21[2mms[22m[39m
 [32mâœ“[39m backend/src/__tests__/server.test.ts[2m > [22mServer Configuration - Integration Tests[2m > [22mRequest Logging Middleware Logic[2m > [22mshould log requests when VERBOSE_LOGGING is enabled in development[32m 12[2mms[22m[39m
 [32mâœ“[39m backend/src/models/__tests__/Tracking.test.ts[2m > [22mTracking Model[2m > [22mvalidateIcon[2m > [22mshould throw TypeError for icon exceeding max length[32m 2[2mms[22m[39m
 [32mâœ“[39m backend/src/models/__tests__/Tracking.test.ts[2m > [22mTracking Model[2m > [22mvalidateIcon[2m > [22mshould accept icon with exactly max length[32m 2[2mms[22m[39m
 [32mâœ“[39m backend/src/models/__tests__/Tracking.test.ts[2m > [22mTracking Model[2m > [22mvalidateFrequency[2m > [22mshould accept valid daily frequency[32m 2[2mms[22m[39m
 [32mâœ“[39m backend/src/models/__tests__/Tracking.test.ts[2m > [22mTracking Model[2m > [22mvalidateFrequency[2m > [22mshould accept valid weekly frequency[32m 2[2mms[22m[39m
 [32mâœ“[39m backend/src/models/__tests__/Tracking.test.ts[2m > [22mTracking Model[2m > [22mvalidateFrequency[2m > [22mshould accept valid monthly frequency with day_number kind[32m 2[2mms[22m[39m
 [32mâœ“[39m backend/src/models/__tests__/Tracking.test.ts[2m > [22mTracking Model[2m > [22mvalidateFrequency[2m > [22mshould accept valid monthly frequency with last_day kind[32m 1[2mms[22m[39m
 [32mâœ“[39m backend/src/models/__tests__/Tracking.test.ts[2m > [22mTracking Model[2m > [22mvalidateFrequency[2m > [22mshould accept valid monthly frequency with weekday_ordinal kind[32m 2[2mms[22m[39m
 [32mâœ“[39m backend/src/models/__tests__/Tracking.test.ts[2m > [22mTracking Model[2m > [22mvalidateFrequency[2m > [22mshould accept valid yearly frequency with date kind[32m 2[2mms[22m[39m
 [32mâœ“[39m backend/src/models/__tests__/Tracking.test.ts[2m > [22mTracking Model[2m > [22mvalidateFrequency[2m > [22mshould accept valid yearly frequency with weekday_ordinal kind[32m 2[2mms[22m[39m
 [32mâœ“[39m backend/src/models/__tests__/Tracking.test.ts[2m > [22mTracking Model[2m > [22mvalidateFrequency[2m > [22mshould accept valid one-time frequency[32m 2[2mms[22m[39m
 [32mâœ“[39m backend/src/models/__tests__/Tracking.test.ts[2m > [22mTracking Model[2m > [22mvalidateFrequency[2m > [22mshould throw TypeError for null/undefined frequency[32m 2[2mms[22m[39m
 [32mâœ“[39m backend/src/models/__tests__/Tracking.test.ts[2m > [22mTracking Model[2m > [22mvalidateFrequency[2m > [22mshould throw TypeError for non-object frequency[32m 2[2mms[22m[39m
 [32mâœ“[39m backend/src/models/__tests__/Tracking.test.ts[2m > [22mTracking Model[2m > [22mvalidateFrequency[2m > [22mshould throw TypeError for missing frequency type[32m 2[2mms[22m[39m
 [32mâœ“[39m backend/src/models/__tests__/Tracking.test.ts[2m > [22mTracking Model[2m > [22mvalidateFrequency[2m > [22mshould throw TypeError for invalid frequency type[32m 5[2mms[22m[39m
 [32mâœ“[39m backend/src/models/__tests__/Tracking.test.ts[2m > [22mTracking Model[2m > [22mvalidateFrequency[2m > [22mshould throw TypeError for weekly frequency missing days array[32m 4[2mms[22m[39m
 [32mâœ“[39m backend/src/models/__tests__/Tracking.test.ts[2m > [22mTracking Model[2m > [22mvalidateFrequency[2m > [22mshould throw TypeError for weekly frequency with empty days array[32m 4[2mms[22m[39m
 [32mâœ“[39m backend/src/models/__tests__/Tracking.test.ts[2m > [22mTracking Model[2m > [22mvalidateFrequency[2m > [22mshould throw TypeError for weekly frequency with invalid day values[32m 2[2mms[22m[39m
 [32mâœ“[39m backend/src/models/__tests__/Tracking.test.ts[2m > [22mTracking Model[2m > [22mvalidateFrequency[2m > [22mshould throw TypeError for weekly frequency with duplicate days[32m 2[2mms[22m[39m
 [32mâœ“[39m backend/src/models/__tests__/Tracking.test.ts[2m > [22mTracking Model[2m > [22mvalidateFrequency[2m > [22mshould throw TypeError for monthly frequency missing kind[32m 2[2mms[22m[39m
 [32mâœ“[39m backend/src/models/__tests__/Tracking.test.ts[2m > [22mTracking Model[2m > [22mvalidateFrequency[2m > [22mshould throw TypeError for monthly frequency with invalid kind[32m 3[2mms[22m[39m
 [32mâœ“[39m backend/src/models/__tests__/Tracking.test.ts[2m > [22mTracking Model[2m > [22mvalidateFrequency[2m > [22mshould throw TypeError for monthly frequency day_number missing day_numbers[32m 2[2mms[22m[39m
 [32mâœ“[39m backend/src/models/__tests__/Tracking.test.ts[2m > [22mTracking Model[2m > [22mvalidateFrequency[2m > [22mshould throw TypeError for monthly frequency day_number with invalid day_numbers[32m 2[2mms[22m[39m
 [32mâœ“[39m backend/src/models/__tests__/Tracking.test.ts[2m > [22mTracking Model[2m > [22mvalidateFrequency[2m > [22mshould throw TypeError for monthly frequency weekday_ordinal missing weekday[32m 2[2mms[22m[39m
 [32mâœ“[39m backend/src/models/__tests__/Tracking.test.ts[2m > [22mTracking Model[2m > [22mvalidateFrequency[2m > [22mshould throw TypeError for monthly frequency weekday_ordinal with invalid weekday[32m 3[2mms[22m[39m
 [32mâœ“[39m backend/src/models/__tests__/Tracking.test.ts[2m > [22mTracking Model[2m > [22mvalidateFrequency[2m > [22mshould throw TypeError for monthly frequency weekday_ordinal missing ordinal[32m 2[2mms[22m[39m
 [32mâœ“[39m backend/src/models/__tests__/Tracking.test.ts[2m > [22mTracking Model[2m > [22mvalidateFrequency[2m > [22mshould throw TypeError for monthly frequency weekday_ordinal with invalid ordinal[32m 2[2mms[22m[39m
 [32mâœ“[39m backend/src/models/__tests__/Tracking.test.ts[2m > [22mTracking Model[2m > [22mvalidateFrequency[2m > [22mshould throw TypeError for yearly frequency missing kind[32m 2[2mms[22m[39m
 [32mâœ“[39m backend/src/models/__tests__/Tracking.test.ts[2m > [22mTracking Model[2m > [22mvalidateFrequency[2m > [22mshould throw TypeError for yearly frequency with invalid kind[32m 2[2mms[22m[39m
 [32mâœ“[39m backend/src/models/__tests__/Tracking.test.ts[2m > [22mTracking Model[2m > [22mvalidateFrequency[2m > [22mshould throw TypeError for yearly frequency date kind missing month[32m 2[2mms[22m[39m
 [32mâœ“[39m backend/src/models/__tests__/Tracking.test.ts[2m > [22mTracking Model[2m > [22mvalidateFrequency[2m > [22mshould throw TypeError for yearly frequency date kind with invalid month[32m 3[2mms[22m[39m
 [32mâœ“[39m backend/src/models/__tests__/Tracking.test.ts[2m > [22mTracking Model[2m > [22mvalidateFrequency[2m > [22mshould throw TypeError for yearly frequency date kind missing day[32m 2[2mms[22m[39m
 [32mâœ“[39m backend/src/models/__tests__/Tracking.test.ts[2m > [22mTracking Model[2m > [22mvalidateFrequency[2m > [22mshould throw TypeError for yearly frequency date kind with invalid day[32m 2[2mms[22m[39m
 [32mâœ“[39m backend/src/models/__tests__/Tracking.test.ts[2m > [22mTracking Model[2m > [22mvalidateFrequency[2m > [22mshould throw TypeError for yearly frequency weekday_ordinal kind missing weekday[32m 2[2mms[22m[39m
 [32mâœ“[39m backend/src/models/__tests__/Tracking.test.ts[2m > [22mTracking Model[2m > [22mvalidateFrequency[2m > [22mshould throw TypeError for yearly frequency weekday_ordinal kind with invalid weekday[32m 3[2mms[22m[39m
 [32mâœ“[39m backend/src/models/__tests__/Tracking.test.ts[2m > [22mTracking Model[2m > [22mvalidateFrequency[2m > [22mshould throw TypeError for yearly frequency weekday_ordinal kind missing ordinal[32m 2[2mms[22m[39m
 [32mâœ“[39m backend/src/models/__tests__/Tracking.test.ts[2m > [22mTracking Model[2m > [22mvalidateFrequency[2m > [22mshould throw TypeError for yearly frequency weekday_ordinal kind with invalid ordinal[32m 2[2mms[22m[39m
 [32mâœ“[39m backend/src/models/__tests__/Tracking.test.ts[2m > [22mTracking Model[2m > [22mvalidateFrequency[2m > [22mshould throw TypeError for one-time frequency missing date[32m 2[2mms[22m[39m
 [32mâœ“[39m backend/src/models/__tests__/Tracking.test.ts[2m > [22mTracking Model[2m > [22mvalidateFrequency[2m > [22mshould throw TypeError for one-time frequency with invalid date format[32m 2[2mms[22m[39m
 [32mâœ“[39m backend/src/models/__tests__/Tracking.test.ts[2m > [22mTracking Model[2m > [22mvalidateFrequency[2m > [22mshould throw TypeError for one-time frequency with past date[32m 3[2mms[22m[39m
 [32mâœ“[39m backend/src/models/__tests__/Tracking.test.ts[2m > [22mTracking Model[2m > [22mvalidate with icon and frequency[2m > [22mshould validate icon when present[32m 3[2mms[22m[39m
 [32mâœ“[39m backend/src/models/__tests__/Tracking.test.ts[2m > [22mTracking Model[2m > [22mvalidate with icon and frequency[2m > [22mshould validate frequency pattern when present[32m 2[2mms[22m[39m
 [32mâœ“[39m backend/src/models/__tests__/Tracking.test.ts[2m > [22mTracking Model[2m > [22mvalidate with icon and frequency[2m > [22mshould throw error for invalid icon[32m 2[2mms[22m[39m
 [32mâœ“[39m backend/src/models/__tests__/Tracking.test.ts[2m > [22mTracking Model[2m > [22mvalidate with icon and frequency[2m > [22mshould throw error for invalid frequency pattern[32m 3[2mms[22m[39m
 [32mâœ“[39m backend/src/middleware/__tests__/upload.test.ts[2m > [22mUpload Middleware[2m > [22mgetUploadsDirectory[2m > [22mshould return uploads directory path[32m 2[2mms[22m[39m
 [32mâœ“[39m backend/src/middleware/__tests__/upload.test.ts[2m > [22mUpload Middleware[2m > [22mgetUploadsDirectory[2m > [22mshould create uploads directory if it does not exist[32m 0[2mms[22m[39m
 [32mâœ“[39m backend/src/middleware/__tests__/upload.test.ts[2m > [22mUpload Middleware[2m > [22muploadProfilePicture[2m > [22mshould be a function[32m 0[2mms[22m[39m
 [32mâœ“[39m backend/src/middleware/__tests__/upload.test.ts[2m > [22mUpload Middleware[2m > [22mUploadConfig[2m > [22mconstructor[2m > [22mshould create instance with default settings[32m 1[2mms[22m[39m
 [32mâœ“[39m backend/src/middleware/__tests__/upload.test.ts[2m > [22mUpload Middleware[2m > [22mUploadConfig[2m > [22mconstructor[2m > [22mshould create instance with custom max file size[32m 0[2mms[22m[39m
 [32mâœ“[39m backend/src/middleware/__tests__/upload.test.ts[2m > [22mUpload Middleware[2m > [22mUploadConfig[2m > [22mconstructor[2m > [22mshould use DB_PATH environment variable if set (relative path)[32m 2[2mms[22m[39m
 [32mâœ“[39m backend/src/middleware/__tests__/upload.test.ts[2m > [22mUpload Middleware[2m > [22mUploadConfig[2m > [22mconstructor[2m > [22mshould use DB_PATH environment variable if set (absolute path)[32m 2[2mms[22m[39m
 [32mâœ“[39m backend/src/middleware/__tests__/upload.test.ts[2m > [22mUpload Middleware[2m > [22mUploadConfig[2m > [22mgetUploadsDirectory[2m > [22mshould return the uploads directory path[32m 1[2mms[22m[39m
 [32mâœ“[39m backend/src/middleware/__tests__/upload.test.ts[2m > [22mUpload Middleware[2m > [22mUploadConfig[2m > [22mgetUploadsDirectory[2m > [22mshould return consistent path for same instance[32m 0[2mms[22m[39m
 [32mâœ“[39m backend/src/middleware/__tests__/upload.test.ts[2m > [22mUpload Middleware[2m > [22mUploadConfig[2m > [22mgetMulterInstance[2m > [22mshould return multer instance[32m 1[2mms[22m[39m
 [32mâœ“[39m backend/src/middleware/__tests__/upload.test.ts[2m > [22mUpload Middleware[2m > [22mUploadConfig[2m > [22mgetMulterInstance[2m > [22mshould return same instance on multiple calls[32m 0[2mms[22m[39m
 [32mâœ“[39m backend/src/middleware/__tests__/upload.test.ts[2m > [22mUpload Middleware[2m > [22mUploadConfig[2m > [22mgetProfilePictureMiddleware[2m > [22mshould return middleware function[32m 0[2mms[22m[39m
 [32mâœ“[39m backend/src/middleware/__tests__/upload.test.ts[2m > [22mUpload Middleware[2m > [22mUploadConfig[2m > [22mmulter configuration[2m > [22mshould create multer instance with storage configured[32m 0[2mms[22m[39m
 [32mâœ“[39m backend/src/middleware/__tests__/upload.test.ts[2m > [22mUpload Middleware[2m > [22mUploadConfig[2m > [22mmulter configuration[2m > [22mshould create middleware function[32m 0[2mms[22m[39m
 [32mâœ“[39m backend/src/middleware/__tests__/upload.test.ts[2m > [22mUpload Middleware[2m > [22mUploadConfig[2m > [22mmulter configuration[2m > [22mshould use configured uploads directory[32m 1[2mms[22m[39m
 [32mâœ“[39m backend/src/middleware/__tests__/upload.test.ts[2m > [22mUpload Middleware[2m > [22mUploadConfig[2m > [22mmulter configuration[2m > [22mshould return same multer instance on multiple calls[32m 0[2mms[22m[39m
 [32mâœ“[39m backend/src/middleware/__tests__/upload.test.ts[2m > [22mUpload Middleware[2m > [22mUploadConfig[2m > [22mmulter configuration[2m > [22mshould generate unique filenames through storage[32m 13[2mms[22m[39m
 [32mâœ“[39m backend/src/middleware/__tests__/upload.test.ts[2m > [22mUpload Middleware[2m > [22mUploadConfig[2m > [22mmulter configuration[2m > [22mshould sanitize special characters in filenames[32m 6[2mms[22m[39m
 [32mâœ“[39m backend/src/middleware/__tests__/upload.test.ts[2m > [22mUpload Middleware[2m > [22mUploadConfig[2m > [22mmulter configuration[2m > [22mshould use correct destination directory in storage[32m 4[2mms[22m[39m
 [32mâœ“[39m backend/src/middleware/__tests__/upload.test.ts[2m > [22mUpload Middleware[2m > [22mUploadConfig[2m > [22mfileFilter[2m > [22mshould accept JPEG files[32m 1[2mms[22m[39m
 [32mâœ“[39m backend/src/middleware/__tests__/upload.test.ts[2m > [22mUpload Middleware[2m > [22mUploadConfig[2m > [22mfileFilter[2m > [22mshould accept JPG files[32m 1[2mms[22m[39m
 [32mâœ“[39m backend/src/middleware/__tests__/upload.test.ts[2m > [22mUpload Middleware[2m > [22mUploadConfig[2m > [22mfileFilter[2m > [22mshould accept PNG files[32m 1[2mms[22m[39m
 [32mâœ“[39m backend/src/middleware/__tests__/upload.test.ts[2m > [22mUpload Middleware[2m > [22mUploadConfig[2m > [22mfileFilter[2m > [22mshould accept GIF files[32m 0[2mms[22m[39m
 [32mâœ“[39m backend/src/middleware/__tests__/upload.test.ts[2m > [22mUpload Middleware[2m > [22mUploadConfig[2m > [22mfileFilter[2m > [22mshould accept WebP files[32m 0[2mms[22m[39m
 [32mâœ“[39m backend/src/middleware/__tests__/upload.test.ts[2m > [22mUpload Middleware[2m > [22mUploadConfig[2m > [22mfileFilter[2m > [22mshould reject non-image files[32m 1[2mms[22m[39m
 [32mâœ“[39m backend/src/middleware/__tests__/upload.test.ts[2m > [22mUpload Middleware[2m > [22mUploadConfig[2m > [22mfileFilter[2m > [22mshould reject text files[32m 0[2mms[22m[39m
 [32mâœ“[39m backend/src/middleware/__tests__/upload.test.ts[2m > [22mUpload Middleware[2m > [22mUploadConfig[2m > [22mconstructor edge cases[2m > [22mshould create directory if it does not exist[32m 2[2mms[22m[39m
 [32mâœ“[39m backend/src/middleware/__tests__/upload.test.ts[2m > [22mUpload Middleware[2m > [22mUploadConfig[2m > [22mconstructor edge cases[2m > [22mshould not fail if directory already exists[32m 3[2mms[22m[39m
 [32mâœ“[39m backend/src/middleware/__tests__/upload.test.ts[2m > [22mUpload Middleware[2m > [22mUploadConfig[2m > [22mfile size limits[2m > [22mshould use custom max file size[32m 0[2mms[22m[39m
 [32mâœ“[39m backend/src/middleware/__tests__/upload.test.ts[2m > [22mUpload Middleware[2m > [22mUploadConfig[2m > [22mfile size limits[2m > [22mshould use default max file size (5MB)[32m 0[2mms[22m[39m
 [32mâœ“[39m backend/src/middleware/__tests__/upload.test.ts[2m > [22mUpload Middleware[2m > [22muploadProfilePicture middleware[2m > [22mshould execute middleware function[32m 1[2mms[22m[39m
 [32mâœ“[39m backend/src/middleware/__tests__/upload.test.ts[2m > [22mUpload Middleware[2m > [22muploadProfilePicture middleware[2m > [22mshould return same middleware instance on multiple calls[32m 0[2mms[22m[39m
 [32mâœ“[39m backend/src/middleware/__tests__/upload.test.ts[2m > [22mUpload Middleware[2m > [22mgetUploadsDirectory function[2m > [22mshould return same directory on multiple calls[32m 0[2mms[22m[39m
 [32mâœ“[39m backend/src/middleware/__tests__/upload.test.ts[2m > [22mUpload Middleware[2m > [22mgetUploadsDirectory function[2m > [22mshould use singleton UploadConfig instance[32m 0[2mms[22m[39m
 [32mâœ“[39m backend/src/middleware/__tests__/upload.test.ts[2m > [22mUpload Middleware[2m > [22mCloudinary Storage[2m > [22mgetStorageType[2m > [22mshould return LOCAL when Cloudinary credentials are not set[32m 1[2mms[22m[39m
 [32mâœ“[39m backend/src/middleware/__tests__/upload.test.ts[2m > [22mUpload Middleware[2m > [22mCloudinary Storage[2m > [22mgetStorageType[2m > [22mshould return CLOUDINARY when all Cloudinary credentials are set[32m 1[2mms[22m[39m
 [32mâœ“[39m backend/src/middleware/__tests__/upload.test.ts[2m > [22mUpload Middleware[2m > [22mCloudinary Storage[2m > [22mgetStorageType[2m > [22mshould return LOCAL when only some Cloudinary credentials are set[32m 0[2mms[22m[39m
 [32mâœ“[39m backend/src/middleware/__tests__/upload.test.ts[2m > [22mUpload Middleware[2m > [22mCloudinary Storage[2m > [22misCloudinaryStorage[2m > [22mshould return false when Cloudinary is not configured[32m 2[2mms[22m[39m
 [32mâœ“[39m backend/src/middleware/__tests__/upload.test.ts[2m > [22mUpload Middleware[2m > [22mCloudinary Storage[2m > [22misCloudinaryStorage[2m > [22mshould return true when Cloudinary is configured[32m 2[2mms[22m[39m
 [32mâœ“[39m backend/src/middleware/__tests__/upload.test.ts[2m > [22mUpload Middleware[2m > [22mCloudinary Storage[2m > [22mUploadConfig with Cloudinary[2m > [22mshould configure Cloudinary when credentials are present[32m 3[2mms[22m[39m
 [32mâœ“[39m backend/src/middleware/__tests__/upload.test.ts[2m > [22mUpload Middleware[2m > [22mCloudinary Storage[2m > [22mUploadConfig with Cloudinary[2m > [22mshould not create uploads directory when using Cloudinary[32m 1[2mms[22m[39m
 [32mâœ“[39m backend/src/middleware/__tests__/upload.test.ts[2m > [22mUpload Middleware[2m > [22mCloudinary Storage[2m > [22muploadToCloudinary[2m > [22mshould throw error when Cloudinary is not configured[32m 2[2mms[22m[39m
 [32mâœ“[39m backend/src/middleware/__tests__/upload.test.ts[2m > [22mUpload Middleware[2m > [22mCloudinary Storage[2m > [22muploadToCloudinary[2m > [22mshould upload file to Cloudinary successfully[32m 8[2mms[22m[39m
 [32mâœ“[39m backend/src/middleware/__tests__/upload.test.ts[2m > [22mUpload Middleware[2m > [22mCloudinary Storage[2m > [22muploadToCloudinary[2m > [22mshould handle Cloudinary upload errors[32m 10[2mms[22m[39m
 [32mâœ“[39m backend/src/middleware/__tests__/upload.test.ts[2m > [22mUpload Middleware[2m > [22mCloudinary Storage[2m > [22muploadToCloudinary[2m > [22mshould handle Cloudinary upload with no URL returned[32m 12[2mms[22m[39m
 [32mâœ“[39m backend/src/db/__tests__/database.test.ts[2m > [22mDatabase[2m > [22minitialize[2m > [22mshould handle initialization with file path[32m 41[2mms[22m[39m
 [32mâœ“[39m backend/src/db/__tests__/database.test.ts[2m > [22mDatabase[2m > [22mgetConnection[2m > [22mshould return database connection after initialization[32m 6[2mms[22m[39m
 [32mâœ“[39m backend/src/db/__tests__/database.test.ts[2m > [22mDatabase[2m > [22mgetConnection[2m > [22mshould throw error if database not initialized[32m 4[2mms[22m[39m
 [32mâœ“[39m backend/src/db/__tests__/database.test.ts[2m > [22mDatabase[2m > [22mclose[2m > [22mshould close database connection[32m 4[2mms[22m[39m
 [32mâœ“[39m backend/src/db/__tests__/database.test.ts[2m > [22mDatabase[2m > [22mclose[2m > [22mshould handle closing already closed database[32m 5[2mms[22m[39m
 [32mâœ“[39m backend/src/db/__tests__/database.test.ts[2m > [22mDatabase[2m > [22mclose[2m > [22mshould handle closing uninitialized database[32m 1[2mms[22m[39m
 [32mâœ“[39m backend/src/db/__tests__/database.test.ts[2m > [22mDatabase[2m > [22mrun[2m > [22mshould execute INSERT query[32m 6[2mms[22m[39m
 [32mâœ“[39m backend/src/db/__tests__/database.test.ts[2m > [22mDatabase[2m > [22mrun[2m > [22mshould execute UPDATE query[32m 5[2mms[22m[39m
 [32mâœ“[39m backend/src/db/__tests__/database.test.ts[2m > [22mDatabase[2m > [22mrun[2m > [22mshould execute DELETE query[32m 5[2mms[22m[39m
 [32mâœ“[39m backend/src/db/__tests__/database.test.ts[2m > [22mDatabase[2m > [22mrun[2m > [22mshould handle query errors[32m 8[2mms[22m[39m
 [32mâœ“[39m backend/src/db/__tests__/database.test.ts[2m > [22mDatabase[2m > [22mrun[2m > [22mshould handle invalid SQL[32m 5[2mms[22m[39m
 [32mâœ“[39m backend/src/db/__tests__/database.test.ts[2m > [22mDatabase[2m > [22mget[2m > [22mshould return single row[32m 5[2mms[22m[39m
 [32mâœ“[39m backend/src/db/__tests__/database.test.ts[2m > [22mDatabase[2m > [22mget[2m > [22mshould return undefined when row not found[32m 5[2mms[22m[39m
 [32mâœ“[39m backend/src/db/__tests__/database.test.ts[2m > [22mDatabase[2m > [22mget[2m > [22mshould handle query errors[32m 7[2mms[22m[39m
 [32mâœ“[39m backend/src/db/__tests__/database.test.ts[2m > [22mDatabase[2m > [22mget[2m > [22mshould work with empty params array[32m 6[2mms[22m[39m
 [32mâœ“[39m backend/src/db/__tests__/database.test.ts[2m > [22mDatabase[2m > [22mall[2m > [22mshould return all rows[32m 12[2mms[22m[39m
[90mstderr[2m | backend/src/db/__tests__/database.test.ts[2m > [22m[2mDatabase[2m > [22m[2mall[2m > [22m[2mshould handle query errors
[22m[39m[2026-01-15T18:50:45.952Z] ERROR   | DATABASE | Query execution failed: SELECT * FROM nonexistent_table [Error: SQLITE_ERROR: no such table: nonexistent_table] {
  errno: [33m1[39m,
  code: [32m'SQLITE_ERROR'[39m
}

[90mstderr[2m | backend/src/db/__tests__/database.test.ts[2m > [22m[2mDatabase[2m > [22m[2mIntegration Tests[2m > [22m[2mshould handle foreign key constraints
[22m[39m[2026-01-15T18:50:45.973Z] ERROR   | DATABASE | Query execution failed: INSERT INTO trackings (user_id, question, frequency) VALUES (?, ?, ?) [Error: SQLITE_CONSTRAINT: FOREIGN KEY constraint failed] {
  errno: [33m19[39m,
  code: [32m'SQLITE_CONSTRAINT'[39m
}

[90mstderr[2m | backend/src/middleware/__tests__/upload.test.ts[2m > [22m[2mUpload Middleware[2m > [22m[2mCloudinary Storage[2m > [22m[2muploadProfilePicture with Cloudinary[2m > [22m[2mshould handle Cloudinary upload errors in middleware
[22m[39m[2026-01-15T18:50:45.984Z] UPLOAD | Cloudinary upload failed: Error: Cloudinary upload failed
    at D:/Code/habitus/backend/src/middleware/__tests__/upload.test.ts:1234:27
    at [90mfile:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:919:20

[90mstderr[2m | backend/src/middleware/__tests__/upload.test.ts[2m > [22m[2mUpload Middleware[2m > [22m[2mCloudinary Storage[2m > [22m[2muploadProfilePicture with Cloudinary[2m > [22m[2mshould handle Cloudinary upload errors in middleware
[22m[39m[2026-01-15T18:50:45.985Z] UPLOAD | Error uploading to Cloudinary: Error: Cloudinary upload failed
    at D:/Code/habitus/backend/src/middleware/__tests__/upload.test.ts:1234:27
    at [90mfile:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:919:20

 [32mâœ“[39m backend/src/services/__tests__/userService.test.ts[2m > [22mUserService[2m > [22mdeleteUser[2m > [22mshould protect against path traversal in profile picture filename[32m 3[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/userService.test.ts[2m > [22mUserService[2m > [22mdeleteUser[2m > [22mshould handle file deletion errors gracefully and still delete user[32m 4[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/userService.test.ts[2m > [22mUserService[2m > [22mdeleteUser[2m > [22mshould delete user without profile picture URL[32m 2[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/userService.test.ts[2m > [22mUserService[2m > [22mupdateLastAccess[2m > [22mshould update last access timestamp[32m 3[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/userService.test.ts[2m > [22mUserService[2m > [22mupdateLastAccess[2m > [22mshould not throw error for non-existent user[32m 2[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/userService.test.ts[2m > [22mUserService[2m > [22mverifyEmailChange[2m > [22mshould verify email change successfully[32m 4[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/userService.test.ts[2m > [22mUserService[2m > [22mverifyEmailChange[2m > [22mshould throw error for invalid token[32m 2[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/userService.test.ts[2m > [22mUserService[2m > [22mverifyEmailChange[2m > [22mshould throw error for expired token[32m 6[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/userService.test.ts[2m > [22mUserService[2m > [22mverifyEmailChange[2m > [22mshould throw error if pending email is already taken[32m 4[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/userService.test.ts[2m > [22mUserService[2m > [22mverifyEmailChange[2m > [22mshould handle token without expiration date[32m 3[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/userService.test.ts[2m > [22mUserService[2m > [22mverifyEmailChange[2m > [22mshould throw error if user not found after update[32m 2[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/userService.test.ts[2m > [22mUserService[2m > [22mupdateNotificationPreferences[2m > [22mshould update notification channels and telegram chat ID[32m 8[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/userService.test.ts[2m > [22mUserService[2m > [22mupdateNotificationPreferences[2m > [22mshould update only notification channels without telegram chat ID[32m 3[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/userService.test.ts[2m > [22mUserService[2m > [22mupdateNotificationPreferences[2m > [22mshould throw error if Telegram is enabled without chat ID[32m 2[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/userService.test.ts[2m > [22mUserService[2m > [22mupdateNotificationPreferences[2m > [22mshould throw error for invalid notification channels[32m 2[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/userService.test.ts[2m > [22mUserService[2m > [22mupdateNotificationPreferences[2m > [22mshould throw error if user not found[32m 2[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/userService.test.ts[2m > [22mUserService[2m > [22mupdateNotificationPreferences[2m > [22mshould throw error if Telegram is enabled with empty chat ID[32m 4[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/userService.test.ts[2m > [22mUserService[2m > [22mupdateNotificationPreferences[2m > [22mshould throw error if Telegram is enabled with whitespace-only chat ID[32m 2[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/userService.test.ts[2m > [22mUserService[2m > [22mupdateNotificationPreferences[2m > [22mshould keep existing telegram_chat_id when Telegram is enabled and existing one is provided[32m 3[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/userService.test.ts[2m > [22mUserService[2m > [22mupdateNotificationPreferences[2m > [22mshould preserve telegram_chat_id when switching to Email[32m 3[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/userService.test.ts[2m > [22mUserService[2m > [22mupdateNotificationPreferences[2m > [22mshould allow switching back to Telegram after switching to Email[32m 3[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/userService.test.ts[2m > [22mUserService[2m > [22mdisconnectTelegram[2m > [22mshould disconnect Telegram and switch to Email[32m 3[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/userService.test.ts[2m > [22mUserService[2m > [22mdisconnectTelegram[2m > [22mshould work even if Telegram is not connected[32m 4[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/userService.test.ts[2m > [22mUserService[2m > [22mdisconnectTelegram[2m > [22mshould throw error if user not found[32m 2[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/userService.test.ts[2m > [22mUserService[2m > [22mupdateLocaleAndTimezone[2m > [22mshould update locale and timezone[32m 2[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/userService.test.ts[2m > [22mUserService[2m > [22mupdateLocaleAndTimezone[2m > [22mshould update only locale[32m 3[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/userService.test.ts[2m > [22mUserService[2m > [22mupdateLocaleAndTimezone[2m > [22mshould update only timezone[32m 6[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/userService.test.ts[2m > [22mUserService[2m > [22mupdateLocaleAndTimezone[2m > [22mshould throw error if no fields to update[32m 3[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/userService.test.ts[2m > [22mUserService[2m > [22mupdateLocaleAndTimezone[2m > [22mshould set locale to undefined when empty string is provided[32m 4[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/userService.test.ts[2m > [22mUserService[2m > [22mupdateLocaleAndTimezone[2m > [22mshould set timezone to undefined when empty string is provided[32m 3[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/userService.test.ts[2m > [22mUserService[2m > [22mupdateLocaleAndTimezone[2m > [22mshould throw error if user not found[32m 2[2mms[22m[39m
 [32mâœ“[39m backend/src/models/__tests__/Tracking.test.ts[2m > [22mTracking Model[2m > [22msave with optional fields[2m > [22mshould create tracking with notes, icon, and frequency[32m 3[2mms[22m[39m
 [32mâœ“[39m backend/src/models/__tests__/Tracking.test.ts[2m > [22mTracking Model[2m > [22msave with optional fields[2m > [22mshould update tracking with notes, icon, and frequency[32m 3[2mms[22m[39m
 [32mâœ“[39m backend/src/models/__tests__/Tracking.test.ts[2m > [22mTracking Model[2m > [22msave with optional fields[2m > [22mshould update tracking with null notes and icon (frequency is required)[32m 4[2mms[22m[39m
 [32mâœ“[39m backend/src/models/__tests__/Tracking.test.ts[2m > [22mTracking Model[2m > [22mupdate with all fields[2m > [22mshould update tracking with icon[32m 2[2mms[22m[39m
 [32mâœ“[39m backend/src/models/__tests__/Tracking.test.ts[2m > [22mTracking Model[2m > [22mupdate with all fields[2m > [22mshould update tracking with frequency pattern[32m 3[2mms[22m[39m
 [32mâœ“[39m backend/src/models/__tests__/Tracking.test.ts[2m > [22mTracking Model[2m > [22mupdate with all fields[2m > [22mshould update tracking with notes[32m 3[2mms[22m[39m
 [32mâœ“[39m backend/src/models/__tests__/Tracking.test.ts[2m > [22mTracking Model[2m > [22mupdate with all fields[2m > [22mshould update tracking with multiple fields[32m 4[2mms[22m[39m
 [32mâœ“[39m backend/src/models/__tests__/Tracking.test.ts[2m > [22mTracking Model[2m > [22mloadById with frequency parsing[2m > [22mshould load tracking with valid frequency JSON[32m 3[2mms[22m[39m
 [32mâœ“[39m backend/src/models/__tests__/Tracking.test.ts[2m > [22mTracking Model[2m > [22mloadById with frequency parsing[2m > [22mshould handle invalid frequency JSON gracefully[32m 4[2mms[22m[39m
 [32mâœ“[39m backend/src/models/__tests__/Tracking.test.ts[2m > [22mTracking Model[2m > [22mloadByUserId with frequency parsing[2m > [22mshould load trackings with valid frequency JSON[32m 4[2mms[22m[39m
 [32mâœ“[39m backend/src/models/__tests__/Tracking.test.ts[2m > [22mTracking Model[2m > [22mState validation[2m > [22mshould validate valid state values[32m 2[2mms[22m[39m
 [32mâœ“[39m backend/src/models/__tests__/Tracking.test.ts[2m > [22mTracking Model[2m > [22mState validation[2m > [22mshould throw TypeError for invalid state[32m 2[2mms[22m[39m
 [32mâœ“[39m backend/src/models/__tests__/Tracking.test.ts[2m > [22mTracking Model[2m > [22mState validation[2m > [22mshould throw TypeError for non-string state[32m 2[2mms[22m[39m
 [32mâœ“[39m backend/src/models/__tests__/Tracking.test.ts[2m > [22mTracking Model[2m > [22mState transitions[2m > [22mshould allow transition from Running to Paused[32m 3[2mms[22m[39m
 [32mâœ“[39m backend/src/models/__tests__/Tracking.test.ts[2m > [22mTracking Model[2m > [22mState transitions[2m > [22mshould allow transition from Running to Archived[32m 2[2mms[22m[39m
 [32mâœ“[39m backend/src/models/__tests__/Tracking.test.ts[2m > [22mTracking Model[2m > [22mState transitions[2m > [22mshould allow transition from Paused to Running[32m 2[2mms[22m[39m
 [32mâœ“[39m backend/src/models/__tests__/Tracking.test.ts[2m > [22mTracking Model[2m > [22mState transitions[2m > [22mshould allow transition from Paused to Archived[32m 4[2mms[22m[39m
 [32mâœ“[39m backend/src/models/__tests__/Tracking.test.ts[2m > [22mTracking Model[2m > [22mState transitions[2m > [22mshould allow transition from Archived to Running[32m 3[2mms[22m[39m
 [32mâœ“[39m backend/src/models/__tests__/Tracking.test.ts[2m > [22mTracking Model[2m > [22mState transitions[2m > [22mshould allow transition from Archived to Paused[32m 3[2mms[22m[39m
 [32mâœ“[39m backend/src/models/__tests__/Tracking.test.ts[2m > [22mTracking Model[2m > [22mState transitions[2m > [22mshould throw TypeError for same state transition[32m 4[2mms[22m[39m
 [32mâœ“[39m backend/src/models/__tests__/Tracking.test.ts[2m > [22mTracking Model[2m > [22mState transitions[2m > [22mshould include error message in TypeError for same state transition[32m 5[2mms[22m[39m
[90mstderr[2m | backend/src/db/__tests__/database.test.ts[2m > [22m[2mDatabase[2m > [22m[2mPostgreSQL Support[2m > [22m[2mPostgreSQL Initialization[2m > [22m[2mshould handle PostgreSQL initialization errors
[22m[39m[2026-01-15T18:50:45.998Z] ERROR   | DATABASE | Failed to initialize PostgreSQL: Error: Connection failed
    at D:/Code/habitus/backend/src/db/__tests__/database.test.ts:676:27
    at [90mfile:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
    at [90mfile:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:919:26
    at [90mfile:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1244:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1210:10[90m)[39m
    at [90mfile:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1654:37
    at Traces.$ [90m(file:///D:/Code/habitus/[39mnode_modules/[4mvitest[24m/dist/chunks/traces.U4xDYhzZ.js:115:27[90m)[39m
    at trace [90m(file:///D:/Code/habitus/[39mnode_modules/[4mvitest[24m/dist/chunks/test.DqQZzsWf.js:234:21[90m)[39m
    at runTest [90m(file:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1654:12[90m)[39m

[90mstderr[2m | backend/src/db/__tests__/database.test.ts[2m > [22m[2mDatabase[2m > [22m[2mPostgreSQL Support[2m > [22m[2mPostgreSQL Initialization[2m > [22m[2mshould handle PostgreSQL schema creation errors
[22m[39m[2026-01-15T18:50:46.008Z] ERROR   | DATABASE | Failed to initialize PostgreSQL: Error: Schema creation failed
    at D:/Code/habitus/backend/src/db/__tests__/database.test.ts:702:44
    at [90mfile:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
    at [90mfile:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:919:26
    at [90mfile:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1244:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1210:10[90m)[39m
    at [90mfile:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1654:37
    at Traces.$ [90m(file:///D:/Code/habitus/[39mnode_modules/[4mvitest[24m/dist/chunks/traces.U4xDYhzZ.js:115:27[90m)[39m
    at trace [90m(file:///D:/Code/habitus/[39mnode_modules/[4mvitest[24m/dist/chunks/test.DqQZzsWf.js:234:21[90m)[39m
    at runTest [90m(file:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1654:12[90m)[39m

 [32mâœ“[39m backend/src/middleware/__tests__/upload.test.ts[2m > [22mUpload Middleware[2m > [22mCloudinary Storage[2m > [22muploadToCloudinary[2m > [22mshould handle Cloudinary upload with null result[32m 12[2mms[22m[39m
 [32mâœ“[39m backend/src/middleware/__tests__/upload.test.ts[2m > [22mUpload Middleware[2m > [22mCloudinary Storage[2m > [22muploadProfilePicture with Cloudinary[2m > [22mshould use Cloudinary when configured[32m 7[2mms[22m[39m
 [32mâœ“[39m backend/src/middleware/__tests__/upload.test.ts[2m > [22mUpload Middleware[2m > [22mCloudinary Storage[2m > [22muploadProfilePicture with Cloudinary[2m > [22mshould upload file to Cloudinary and set file properties[32m 29[2mms[22m[39m
 [32mâœ“[39m backend/src/middleware/__tests__/upload.test.ts[2m > [22mUpload Middleware[2m > [22mCloudinary Storage[2m > [22muploadProfilePicture with Cloudinary[2m > [22mshould handle Cloudinary upload errors in middleware[32m 18[2mms[22m[39m
 [32mâœ“[39m backend/src/middleware/__tests__/upload.test.ts[2m > [22mUpload Middleware[2m > [22mCloudinary Storage[2m > [22muploadProfilePicture with Cloudinary[2m > [22mshould handle multer errors in Cloudinary mode[32m 11[2mms[22m[39m
 [32mâœ“[39m backend/src/middleware/__tests__/upload.test.ts[2m > [22mUpload Middleware[2m > [22mCloudinary Storage[2m > [22muploadProfilePicture with Cloudinary[2m > [22mshould accept valid image types in Cloudinary mode[32m 4[2mms[22m[39m
 [32mâœ“[39m backend/src/middleware/__tests__/upload.test.ts[2m > [22mUpload Middleware[2m > [22mCloudinary Storage[2m > [22muploadProfilePicture with Cloudinary[2m > [22mshould reject invalid file types in Cloudinary mode[32m 2[2mms[22m[39m
 [32mâœ“[39m backend/src/__tests__/server.test.ts[2m > [22mServer Configuration - Integration Tests[2m > [22mCORS Configuration[2m > [22mshould use CORS with origin true in development[32m 1[2mms[22m[39m
 [32mâœ“[39m backend/src/__tests__/server.test.ts[2m > [22mServer Configuration - Integration Tests[2m > [22mCORS Configuration[2m > [22mshould use default CORS in production[32m 1[2mms[22m[39m
 [32mâœ“[39m backend/src/__tests__/server.test.ts[2m > [22mServer Configuration - Integration Tests[2m > [22mHealth Check Endpoint[2m > [22mshould return ok status for health check[32m 13[2mms[22m[39m
 [32mâœ“[39m backend/src/__tests__/server.test.ts[2m > [22mServer Configuration - Integration Tests[2m > [22mStatic File Serving[2m > [22mshould configure static file serving for uploads[32m 3[2mms[22m[39m
 [32mâœ“[39m backend/src/__tests__/server.test.ts[2m > [22mServer Configuration - Integration Tests[2m > [22mVite Dev Server Initialization Logic[2m > [22mshould return null in production mode[32m 1[2mms[22m[39m
 [32mâœ“[39m backend/src/__tests__/server.test.ts[2m > [22mServer Configuration - Integration Tests[2m > [22mVite Dev Server Initialization Logic[2m > [22mshould handle Vite initialization logic in development[32m 0[2mms[22m[39m
 [32mâœ“[39m backend/src/__tests__/server.test.ts[2m > [22mServer Configuration - Integration Tests[2m > [22mProduction Static File Serving Logic[2m > [22mshould serve static files from frontend/dist in production[32m 1[2mms[22m[39m
 [32mâœ“[39m backend/src/__tests__/server.test.ts[2m > [22mServer Configuration - Integration Tests[2m > [22mProduction Static File Serving Logic[2m > [22mshould serve index.html for all non-API routes in production[32m 0[2mms[22m[39m
 [32mâœ“[39m backend/src/__tests__/server.test.ts[2m > [22mServer Configuration - Integration Tests[2m > [22mDevelopment Vite Route Handling Logic[2m > [22mshould skip API routes when serving via Vite[32m 17[2mms[22m[39m
 [32mâœ“[39m backend/src/__tests__/server.test.ts[2m > [22mServer Configuration - Integration Tests[2m > [22mDevelopment Vite Route Handling Logic[2m > [22mshould skip uploads routes when serving via Vite[32m 22[2mms[22m[39m
 [32mâœ“[39m backend/src/__tests__/server.test.ts[2m > [22mServer Configuration - Integration Tests[2m > [22mDevelopment Vite Route Handling Logic[2m > [22mshould skip health check route when serving via Vite[32m 9[2mms[22m[39m
 [32mâœ“[39m backend/src/__tests__/server.test.ts[2m > [22mServer Configuration - Integration Tests[2m > [22mDevelopment Vite Route Handling Logic[2m > [22mshould handle errors when transforming index.html[32m 8[2mms[22m[39m
 [32mâœ“[39m backend/src/__tests__/server.test.ts[2m > [22mServer Configuration - Integration Tests[2m > [22mServer Initialization and Shutdown Logic[2m > [22mshould handle database initialization failure[32m 3[2mms[22m[39m
[90mstderr[2m | backend/src/db/__tests__/database.test.ts[2m > [22m[2mDatabase[2m > [22m[2mPostgreSQL Support[2m > [22m[2mPostgreSQL Query Operations[2m > [22m[2mrunPostgreSQL[2m > [22m[2mshould handle query errors
[22m[39m[2026-01-15T18:50:46.033Z] ERROR   | DATABASE | Query execution failed: INSERT INTO users (name, email) VALUES ($1, $2) Error: Query failed
    at D:/Code/habitus/backend/src/db/__tests__/database.test.ts:869:44
    at [90mfile:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:919:20

[90mstderr[2m | backend/src/db/__tests__/database.test.ts[2m > [22m[2mDatabase[2m > [22m[2mPostgreSQL Support[2m > [22m[2mPostgreSQL Query Operations[2m > [22m[2mgetPostgreSQL[2m > [22m[2mshould handle query errors
[22m[39m[2026-01-15T18:50:46.048Z] ERROR   | DATABASE | Query execution failed: SELECT * FROM users WHERE id = $1 Error: Query failed
    at D:/Code/habitus/backend/src/db/__tests__/database.test.ts:964:44
    at [90mfile:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:919:20

 [32mâœ“[39m backend/src/db/__tests__/database.test.ts[2m > [22mDatabase[2m > [22mall[2m > [22mshould return empty array when no rows[32m 10[2mms[22m[39m
 [32mâœ“[39m backend/src/db/__tests__/database.test.ts[2m > [22mDatabase[2m > [22mall[2m > [22mshould handle query errors[32m 4[2mms[22m[39m
 [32mâœ“[39m backend/src/db/__tests__/database.test.ts[2m > [22mDatabase[2m > [22mall[2m > [22mshould work with empty params array[32m 5[2mms[22m[39m
 [32mâœ“[39m backend/src/db/__tests__/database.test.ts[2m > [22mDatabase[2m > [22mIntegration Tests[2m > [22mshould handle full CRUD operations[32m 6[2mms[22m[39m
 [32mâœ“[39m backend/src/db/__tests__/database.test.ts[2m > [22mDatabase[2m > [22mIntegration Tests[2m > [22mshould store and retrieve notification_channels as single string[32m 6[2mms[22m[39m
 [32mâœ“[39m backend/src/db/__tests__/database.test.ts[2m > [22mDatabase[2m > [22mIntegration Tests[2m > [22mshould handle foreign key constraints[32m 6[2mms[22m[39m
 [32mâœ“[39m backend/src/db/__tests__/database.test.ts[2m > [22mDatabase[2m > [22mPostgreSQL Support[2m > [22mPostgreSQL Detection[2m > [22mshould detect PostgreSQL when DATABASE_URL is set[32m 2[2mms[22m[39m
 [32mâœ“[39m backend/src/db/__tests__/database.test.ts[2m > [22mDatabase[2m > [22mPostgreSQL Support[2m > [22mPostgreSQL Detection[2m > [22mshould use SQLite when DATABASE_URL is not set[32m 2[2mms[22m[39m
 [32mâœ“[39m backend/src/db/__tests__/database.test.ts[2m > [22mDatabase[2m > [22mPostgreSQL Support[2m > [22mPostgreSQL Initialization[2m > [22mshould initialize PostgreSQL database successfully[32m 3[2mms[22m[39m
 [32mâœ“[39m backend/src/db/__tests__/database.test.ts[2m > [22mDatabase[2m > [22mPostgreSQL Support[2m > [22mPostgreSQL Initialization[2m > [22mshould throw error when DATABASE_URL is missing for PostgreSQL[32m 9[2mms[22m[39m
 [32mâœ“[39m backend/src/db/__tests__/database.test.ts[2m > [22mDatabase[2m > [22mPostgreSQL Support[2m > [22mPostgreSQL Initialization[2m > [22mshould configure SSL for production environment[32m 2[2mms[22m[39m
 [32mâœ“[39m backend/src/db/__tests__/database.test.ts[2m > [22mDatabase[2m > [22mPostgreSQL Support[2m > [22mPostgreSQL Initialization[2m > [22mshould not configure SSL for non-production environment[32m 3[2mms[22m[39m
 [32mâœ“[39m backend/src/db/__tests__/database.test.ts[2m > [22mDatabase[2m > [22mPostgreSQL Support[2m > [22mPostgreSQL Initialization[2m > [22mshould handle PostgreSQL initialization errors[32m 9[2mms[22m[39m
 [32mâœ“[39m backend/src/db/__tests__/database.test.ts[2m > [22mDatabase[2m > [22mPostgreSQL Support[2m > [22mPostgreSQL Initialization[2m > [22mshould handle PostgreSQL schema creation errors[32m 5[2mms[22m[39m
 [32mâœ“[39m backend/src/db/__tests__/database.test.ts[2m > [22mDatabase[2m > [22mPostgreSQL Support[2m > [22mPostgreSQL Query Operations[2m > [22mrunPostgreSQL[2m > [22mshould execute INSERT with automatic RETURNING id[32m 5[2mms[22m[39m
 [32mâœ“[39m backend/src/db/__tests__/database.test.ts[2m > [22mDatabase[2m > [22mPostgreSQL Support[2m > [22mPostgreSQL Query Operations[2m > [22mrunPostgreSQL[2m > [22mshould execute INSERT with existing RETURNING clause[32m 2[2mms[22m[39m
 [32mâœ“[39m backend/src/db/__tests__/database.test.ts[2m > [22mDatabase[2m > [22mPostgreSQL Support[2m > [22mPostgreSQL Query Operations[2m > [22mrunPostgreSQL[2m > [22mshould handle INSERT with semicolon[32m 2[2mms[22m[39m
 [32mâœ“[39m backend/src/db/__tests__/database.test.ts[2m > [22mDatabase[2m > [22mPostgreSQL Support[2m > [22mPostgreSQL Query Operations[2m > [22mrunPostgreSQL[2m > [22mshould execute UPDATE query[32m 2[2mms[22m[39m
 [32mâœ“[39m backend/src/db/__tests__/database.test.ts[2m > [22mDatabase[2m > [22mPostgreSQL Support[2m > [22mPostgreSQL Query Operations[2m > [22mrunPostgreSQL[2m > [22mshould execute DELETE query[32m 2[2mms[22m[39m
 [32mâœ“[39m backend/src/db/__tests__/database.test.ts[2m > [22mDatabase[2m > [22mPostgreSQL Support[2m > [22mPostgreSQL Query Operations[2m > [22mrunPostgreSQL[2m > [22mshould handle query errors[32m 11[2mms[22m[39m
 [32mâœ“[39m backend/src/db/__tests__/database.test.ts[2m > [22mDatabase[2m > [22mPostgreSQL Support[2m > [22mPostgreSQL Query Operations[2m > [22mrunPostgreSQL[2m > [22mshould throw error when database not initialized[32m 2[2mms[22m[39m
 [32mâœ“[39m backend/src/db/__tests__/database.test.ts[2m > [22mDatabase[2m > [22mPostgreSQL Support[2m > [22mPostgreSQL Query Operations[2m > [22mrunPostgreSQL[2m > [22mshould handle INSERT with no rows returned[32m 5[2mms[22m[39m
 [32mâœ“[39m backend/src/db/__tests__/database.test.ts[2m > [22mDatabase[2m > [22mPostgreSQL Support[2m > [22mPostgreSQL Query Operations[2m > [22mgetPostgreSQL[2m > [22mshould return single row[32m 3[2mms[22m[39m
 [32mâœ“[39m backend/src/db/__tests__/database.test.ts[2m > [22mDatabase[2m > [22mPostgreSQL Support[2m > [22mPostgreSQL Query Operations[2m > [22mgetPostgreSQL[2m > [22mshould return undefined when row not found[32m 2[2mms[22m[39m
[90mstderr[2m | backend/src/db/__tests__/database.test.ts[2m > [22m[2mDatabase[2m > [22m[2mPostgreSQL Support[2m > [22m[2mPostgreSQL Query Operations[2m > [22m[2mallPostgreSQL[2m > [22m[2mshould handle query errors
[22m[39m[2026-01-15T18:50:46.060Z] ERROR   | DATABASE | Query execution failed: SELECT * FROM users Error: Query failed
    at D:/Code/habitus/backend/src/db/__tests__/database.test.ts:1030:44
    at [90mfile:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:919:20

 [32mâœ“[39m backend/src/db/__tests__/database.test.ts[2m > [22mDatabase[2m > [22mPostgreSQL Support[2m > [22mPostgreSQL Query Operations[2m > [22mgetPostgreSQL[2m > [22mshould handle query errors[32m 4[2mms[22m[39m
 [32mâœ“[39m backend/src/db/__tests__/database.test.ts[2m > [22mDatabase[2m > [22mPostgreSQL Support[2m > [22mPostgreSQL Query Operations[2m > [22mgetPostgreSQL[2m > [22mshould throw error when database not initialized[32m 2[2mms[22m[39m
 [32mâœ“[39m backend/src/db/__tests__/database.test.ts[2m > [22mDatabase[2m > [22mPostgreSQL Support[2m > [22mPostgreSQL Query Operations[2m > [22mallPostgreSQL[2m > [22mshould return all rows[32m 3[2mms[22m[39m
 [32mâœ“[39m backend/src/db/__tests__/database.test.ts[2m > [22mDatabase[2m > [22mPostgreSQL Support[2m > [22mPostgreSQL Query Operations[2m > [22mallPostgreSQL[2m > [22mshould return empty array when no rows[32m 2[2mms[22m[39m
 [32mâœ“[39m backend/src/db/__tests__/database.test.ts[2m > [22mDatabase[2m > [22mPostgreSQL Support[2m > [22mPostgreSQL Query Operations[2m > [22mallPostgreSQL[2m > [22mshould handle query errors[32m 2[2mms[22m[39m
 [32mâœ“[39m backend/src/db/__tests__/database.test.ts[2m > [22mDatabase[2m > [22mPostgreSQL Support[2m > [22mPostgreSQL Query Operations[2m > [22mallPostgreSQL[2m > [22mshould throw error when database not initialized[32m 2[2mms[22m[39m
 [32mâœ“[39m backend/src/db/__tests__/database.test.ts[2m > [22mDatabase[2m > [22mPostgreSQL Support[2m > [22mPostgreSQL Connection Management[2m > [22mshould throw error when getConnection() called on PostgreSQL[32m 2[2mms[22m[39m
 [32mâœ“[39m backend/src/db/__tests__/database.test.ts[2m > [22mDatabase[2m > [22mPostgreSQL Support[2m > [22mPostgreSQL Connection Management[2m > [22mshould close PostgreSQL connection pool[32m 2[2mms[22m[39m
 [32mâœ“[39m backend/src/db/__tests__/database.test.ts[2m > [22mDatabase[2m > [22mPostgreSQL Support[2m > [22mPostgreSQL Connection Management[2m > [22mshould handle closing already closed PostgreSQL pool[32m 2[2mms[22m[39m
 [32mâœ“[39m backend/src/db/__tests__/database.test.ts[2m > [22mDatabase[2m > [22mSQLite Error Handling[2m > [22mshould handle database open errors[32m 8[2mms[22m[39m
 [32mâœ“[39m backend/src/db/__tests__/database.test.ts[2m > [22mDatabase[2m > [22mSQLite Error Handling[2m > [22mshould handle foreign keys enable errors[32m 8[2mms[22m[39m
 [32mâœ“[39m backend/src/db/__tests__/database.test.ts[2m > [22mDatabase[2m > [22mSQLite Error Handling[2m > [22mshould handle WAL mode enable errors[32m 4[2mms[22m[39m
 [32mâœ“[39m backend/src/db/__tests__/database.test.ts[2m > [22mDatabase[2m > [22mSQLite Error Handling[2m > [22mshould handle schema creation errors[32m 3[2mms[22m[39m
 [32mâœ“[39m backend/src/db/__tests__/database.test.ts[2m > [22mDatabase[2m > [22mSQLite Error Handling[2m > [22mshould handle database close errors[32m 3[2mms[22m[39m
 [32mâœ“[39m backend/src/__tests__/server.test.ts[2m > [22mServer Configuration - Integration Tests[2m > [22mServer Initialization and Shutdown Logic[2m > [22mshould handle graceful shutdown logic[32m 24[2mms[22m[39m
[90mstderr[2m | backend/src/routes/__tests__/reminders.test.ts[2m > [22m[2mReminders Routes[2m > [22m[2mGET /api/reminders[2m > [22m[2mshould get all reminders for authenticated user
[22m[39m[2026-01-15T18:50:46.138Z] ERROR   | DATABASE | Query execution failed: SELECT id, name, email, profile_picture_url, telegram_chat_id, notification_channels, locale, timezo [Error: SQLITE_ERROR: no such column: profile_picture_url] {
  errno: [33m1[39m,
  code: [32m'SQLITE_ERROR'[39m
}

[90mstderr[2m | backend/src/routes/__tests__/reminders.test.ts[2m > [22m[2mReminders Routes[2m > [22m[2mGET /api/reminders[2m > [22m[2mshould get all reminders for authenticated user
[22m[39m[2026-01-15T18:50:46.140Z] REMINDER | Error sending notifications for reminder ID 1: [Error: SQLITE_ERROR: no such column: profile_picture_url] {
  errno: [33m1[39m,
  code: [32m'SQLITE_ERROR'[39m
}

[90mstderr[2m | backend/src/routes/__tests__/users.test.ts[2m > [22m[2mUsers Routes[2m > [22m[2mGET /api/users[2m > [22m[2mshould handle errors when fetching users fails
[22m[39m[2026-01-15T18:50:46.221Z] USER_ROUTE | Error fetching users: Error: Database error
    at D:/Code/habitus/backend/src/routes/__tests__/users.test.ts:168:48
    at [90mfile:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
    at [90mfile:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:919:26
    at [90mfile:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1244:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1210:10[90m)[39m
    at [90mfile:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1654:37
    at Traces.$ [90m(file:///D:/Code/habitus/[39mnode_modules/[4mvitest[24m/dist/chunks/traces.U4xDYhzZ.js:115:27[90m)[39m
    at trace [90m(file:///D:/Code/habitus/[39mnode_modules/[4mvitest[24m/dist/chunks/test.DqQZzsWf.js:234:21[90m)[39m
    at runTest [90m(file:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1654:12[90m)[39m

 [32mâœ“[39m backend/src/routes/__tests__/trackings.test.ts[2m > [22mTrackings Routes[2m > [22mGET /api/trackings[2m > [22mshould return empty array when no trackings exist[32m 70[2mms[22m[39m
 [32mâœ“[39m backend/src/routes/__tests__/trackings.test.ts[2m > [22mTrackings Routes[2m > [22mGET /api/trackings[2m > [22mshould return all trackings for authenticated user[32m 24[2mms[22m[39m
 [32mâœ“[39m backend/src/__tests__/server.test.ts[2m > [22mServer Configuration - Integration Tests[2m > [22mServer.ts Integration - Actual Import Tests[2m > [22mshould import server.ts with all mocks in place[32m 200[2mms[22m[39m
 [32mâœ“[39m backend/src/routes/__tests__/users.test.ts[2m > [22mUsers Routes[2m > [22mGET /api/users[2m > [22mshould return empty array when no users exist[32m 49[2mms[22m[39m
 [32mâœ“[39m backend/src/routes/__tests__/users.test.ts[2m > [22mUsers Routes[2m > [22mGET /api/users[2m > [22mshould return all users[32m 18[2mms[22m[39m
 [32mâœ“[39m backend/src/routes/__tests__/users.test.ts[2m > [22mUsers Routes[2m > [22mGET /api/users[2m > [22mshould handle errors when fetching users fails[32m 23[2mms[22m[39m
[90mstderr[2m | backend/src/routes/__tests__/trackings.test.ts[2m > [22m[2mTrackings Routes[2m > [22m[2mGET /api/trackings[2m > [22m[2mshould return 500 when service throws error
[22m[39m[2026-01-15T18:50:46.236Z] TRACKING_ROUTE | Error fetching trackings: Error: Database error
    at D:/Code/habitus/backend/src/routes/__tests__/trackings.test.ts:235:51
    at [90mfile:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
    at [90mfile:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:919:26
    at [90mfile:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1244:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1210:10[90m)[39m
    at [90mfile:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1654:37
    at Traces.$ [90m(file:///D:/Code/habitus/[39mnode_modules/[4mvitest[24m/dist/chunks/traces.U4xDYhzZ.js:115:27[90m)[39m
    at trace [90m(file:///D:/Code/habitus/[39mnode_modules/[4mvitest[24m/dist/chunks/test.DqQZzsWf.js:234:21[90m)[39m
    at runTest [90m(file:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1654:12[90m)[39m

[90mstderr[2m | backend/src/routes/__tests__/reminders.test.ts[2m > [22m[2mReminders Routes[2m > [22m[2mGET /api/reminders/:id[2m > [22m[2mshould get a reminder by ID
[22m[39m[2026-01-15T18:50:46.283Z] ERROR   | DATABASE | Query execution failed: SELECT id, name, email, profile_picture_url, telegram_chat_id, notification_channels, locale, timezo [Error: SQLITE_ERROR: no such column: profile_picture_url] {
  errno: [33m1[39m,
  code: [32m'SQLITE_ERROR'[39m
}

[90mstderr[2m | backend/src/routes/__tests__/reminders.test.ts[2m > [22m[2mReminders Routes[2m > [22m[2mGET /api/reminders/:id[2m > [22m[2mshould get a reminder by ID
[22m[39m[2026-01-15T18:50:46.283Z] REMINDER | Error sending notifications for reminder ID 1: [Error: SQLITE_ERROR: no such column: profile_picture_url] {
  errno: [33m1[39m,
  code: [32m'SQLITE_ERROR'[39m
}

[90mstderr[2m | backend/src/routes/__tests__/users.test.ts[2m > [22m[2mUsers Routes[2m > [22m[2mGET /api/users/:id[2m > [22m[2mshould handle errors when fetching user fails
[22m[39m[2026-01-15T18:50:46.288Z] USER_ROUTE | Error fetching user: Error: Database error
    at D:/Code/habitus/backend/src/routes/__tests__/users.test.ts:213:48
    at [90mfile:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
    at [90mfile:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:919:26
    at [90mfile:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1244:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1210:10[90m)[39m
    at [90mfile:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1654:37
    at Traces.$ [90m(file:///D:/Code/habitus/[39mnode_modules/[4mvitest[24m/dist/chunks/traces.U4xDYhzZ.js:115:27[90m)[39m
    at trace [90m(file:///D:/Code/habitus/[39mnode_modules/[4mvitest[24m/dist/chunks/test.DqQZzsWf.js:234:21[90m)[39m
    at runTest [90m(file:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1654:12[90m)[39m

[90mstderr[2m | backend/src/routes/__tests__/trackings.test.ts[2m > [22m[2mTrackings Routes[2m > [22m[2mGET /api/trackings/:id[2m > [22m[2mshould return 500 when service throws error
[22m[39m[2026-01-15T18:50:46.298Z] TRACKING_ROUTE | Error fetching tracking: Error: Database error
    at D:/Code/habitus/backend/src/routes/__tests__/trackings.test.ts:288:44
    at [90mfile:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
    at [90mfile:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:919:26
    at [90mfile:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1244:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1210:10[90m)[39m
    at [90mfile:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1654:37
    at Traces.$ [90m(file:///D:/Code/habitus/[39mnode_modules/[4mvitest[24m/dist/chunks/traces.U4xDYhzZ.js:115:27[90m)[39m
    at trace [90m(file:///D:/Code/habitus/[39mnode_modules/[4mvitest[24m/dist/chunks/test.DqQZzsWf.js:234:21[90m)[39m
    at runTest [90m(file:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1654:12[90m)[39m

 [32mâœ“[39m backend/src/routes/__tests__/reminders.test.ts[2m > [22mReminders Routes[2m > [22mGET /api/reminders[2m > [22mshould get all reminders for authenticated user[32m 103[2mms[22m[39m
 [32mâœ“[39m backend/src/routes/__tests__/reminders.test.ts[2m > [22mReminders Routes[2m > [22mGET /api/reminders/:id[2m > [22mshould get a reminder by ID[32m 68[2mms[22m[39m
 [32mâœ“[39m backend/src/routes/__tests__/reminders.test.ts[2m > [22mReminders Routes[2m > [22mGET /api/reminders/:id[2m > [22mshould return 404 if reminder not found[32m 11[2mms[22m[39m
 [32mâœ“[39m backend/src/routes/__tests__/auth.test.ts[2m > [22mAuth Routes[2m > [22mPOST /api/auth/register[2m > [22mshould request registration magic link[32m 66[2mms[22m[39m
 [32mâœ“[39m backend/src/routes/__tests__/auth.test.ts[2m > [22mAuth Routes[2m > [22mPOST /api/auth/register[2m > [22mshould return 400 for missing name[32m 10[2mms[22m[39m
 [32mâœ“[39m backend/src/routes/__tests__/auth.test.ts[2m > [22mAuth Routes[2m > [22mPOST /api/auth/register[2m > [22mshould return 400 for missing email[32m 13[2mms[22m[39m
[90mstderr[2m | backend/src/routes/__tests__/users.test.ts[2m > [22m[2mUsers Routes[2m > [22m[2mPUT /api/users/profile[2m > [22m[2mshould handle errors when update fails
[22m[39m[2026-01-15T18:50:46.339Z] USER_ROUTE | Error updating profile: Error: Database error
    at D:/Code/habitus/backend/src/routes/__tests__/users.test.ts:275:50
    at [90mfile:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
    at [90mfile:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:919:26
    at [90mfile:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1244:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1210:10[90m)[39m
    at [90mfile:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1654:37
    at Traces.$ [90m(file:///D:/Code/habitus/[39mnode_modules/[4mvitest[24m/dist/chunks/traces.U4xDYhzZ.js:115:27[90m)[39m
    at trace [90m(file:///D:/Code/habitus/[39mnode_modules/[4mvitest[24m/dist/chunks/test.DqQZzsWf.js:234:21[90m)[39m
    at runTest [90m(file:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1654:12[90m)[39m

 [32mâœ“[39m backend/src/routes/__tests__/users.test.ts[2m > [22mUsers Routes[2m > [22mGET /api/users/:id[2m > [22mshould return 400 for invalid user ID[32m 12[2mms[22m[39m
 [32mâœ“[39m backend/src/routes/__tests__/users.test.ts[2m > [22mUsers Routes[2m > [22mGET /api/users/:id[2m > [22mshould return 404 for non-existent user[32m 23[2mms[22m[39m
 [32mâœ“[39m backend/src/routes/__tests__/users.test.ts[2m > [22mUsers Routes[2m > [22mGET /api/users/:id[2m > [22mshould return user for existing id[32m 12[2mms[22m[39m
 [32mâœ“[39m backend/src/routes/__tests__/users.test.ts[2m > [22mUsers Routes[2m > [22mGET /api/users/:id[2m > [22mshould handle errors when fetching user fails[32m 11[2mms[22m[39m
 [32mâœ“[39m backend/src/routes/__tests__/users.test.ts[2m > [22mUsers Routes[2m > [22mPUT /api/users/profile[2m > [22mshould update user profile successfully[32m 30[2mms[22m[39m
 [32mâœ“[39m backend/src/routes/__tests__/users.test.ts[2m > [22mUsers Routes[2m > [22mPUT /api/users/profile[2m > [22mshould return 400 for validation errors[32m 11[2mms[22m[39m
 [32mâœ“[39m backend/src/routes/__tests__/trackings.test.ts[2m > [22mTrackings Routes[2m > [22mGET /api/trackings[2m > [22mshould return 500 when service throws error[32m 24[2mms[22m[39m
 [32mâœ“[39m backend/src/routes/__tests__/trackings.test.ts[2m > [22mTrackings Routes[2m > [22mGET /api/trackings/:id[2m > [22mshould return 404 for non-existent tracking[32m 17[2mms[22m[39m
 [32mâœ“[39m backend/src/routes/__tests__/trackings.test.ts[2m > [22mTrackings Routes[2m > [22mGET /api/trackings/:id[2m > [22mshould return tracking for existing id[32m 14[2mms[22m[39m
 [32mâœ“[39m backend/src/routes/__tests__/trackings.test.ts[2m > [22mTrackings Routes[2m > [22mGET /api/trackings/:id[2m > [22mshould return 400 for invalid tracking ID[32m 10[2mms[22m[39m
 [32mâœ“[39m backend/src/routes/__tests__/trackings.test.ts[2m > [22mTrackings Routes[2m > [22mGET /api/trackings/:id[2m > [22mshould return 500 when service throws error[32m 10[2mms[22m[39m
[90mstderr[2m | backend/src/routes/__tests__/reminders.test.ts[2m > [22m[2mReminders Routes[2m > [22m[2mPOST /api/reminders[2m > [22m[2mshould create a new reminder
[22m[39m[2026-01-15T18:50:46.357Z] ERROR   | DATABASE | Query execution failed: SELECT id, name, email, profile_picture_url, telegram_chat_id, notification_channels, locale, timezo [Error: SQLITE_ERROR: no such column: profile_picture_url] {
  errno: [33m1[39m,
  code: [32m'SQLITE_ERROR'[39m
}

[90mstderr[2m | backend/src/routes/__tests__/reminders.test.ts[2m > [22m[2mReminders Routes[2m > [22m[2mPOST /api/reminders[2m > [22m[2mshould create a new reminder
[22m[39m[2026-01-15T18:50:46.358Z] REMINDER | Error sending notifications for reminder ID 1: [Error: SQLITE_ERROR: no such column: profile_picture_url] {
  errno: [33m1[39m,
  code: [32m'SQLITE_ERROR'[39m
}

[90mstderr[2m | backend/src/routes/__tests__/users.test.ts[2m > [22m[2mUsers Routes[2m > [22m[2mPUT /api/users/profile[2m > [22m[2mshould handle file upload with cleanup on error
[22m[39m[2026-01-15T18:50:46.377Z] USER_ROUTE | Error updating profile: Error: Database error
    at D:/Code/habitus/backend/src/routes/__tests__/users.test.ts:364:50
    at [90mfile:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
    at [90mfile:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:919:26
    at [90mfile:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1244:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1210:10[90m)[39m
    at [90mfile:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1654:37
    at Traces.$ [90m(file:///D:/Code/habitus/[39mnode_modules/[4mvitest[24m/dist/chunks/traces.U4xDYhzZ.js:115:27[90m)[39m
    at trace [90m(file:///D:/Code/habitus/[39mnode_modules/[4mvitest[24m/dist/chunks/test.DqQZzsWf.js:234:21[90m)[39m
    at runTest [90m(file:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1654:12[90m)[39m

[90mstderr[2m | backend/src/routes/__tests__/reminders.test.ts[2m > [22m[2mReminders Routes[2m > [22m[2mPUT /api/reminders/:id[2m > [22m[2mshould update a reminder
[22m[39m[2026-01-15T18:50:46.389Z] ERROR   | DATABASE | Query execution failed: SELECT id, name, email, profile_picture_url, telegram_chat_id, notification_channels, locale, timezo [Error: SQLITE_ERROR: no such column: profile_picture_url] {
  errno: [33m1[39m,
  code: [32m'SQLITE_ERROR'[39m
}

[90mstderr[2m | backend/src/routes/__tests__/reminders.test.ts[2m > [22m[2mReminders Routes[2m > [22m[2mPUT /api/reminders/:id[2m > [22m[2mshould update a reminder
[22m[39m[2026-01-15T18:50:46.389Z] REMINDER | Error sending notifications for reminder ID 1: [Error: SQLITE_ERROR: no such column: profile_picture_url] {
  errno: [33m1[39m,
  code: [32m'SQLITE_ERROR'[39m
}

[90mstderr[2m | backend/src/routes/__tests__/reminders.test.ts[2m > [22m[2mReminders Routes[2m > [22m[2mPATCH /api/reminders/:id/snooze[2m > [22m[2mshould snooze a reminder
[22m[39m[2026-01-15T18:50:46.411Z] ERROR   | DATABASE | Query execution failed: SELECT id, name, email, profile_picture_url, telegram_chat_id, notification_channels, locale, timezo [Error: SQLITE_ERROR: no such column: profile_picture_url] {
  errno: [33m1[39m,
  code: [32m'SQLITE_ERROR'[39m
}

[90mstderr[2m | backend/src/routes/__tests__/reminders.test.ts[2m > [22m[2mReminders Routes[2m > [22m[2mPATCH /api/reminders/:id/snooze[2m > [22m[2mshould snooze a reminder
[22m[39m[2026-01-15T18:50:46.412Z] REMINDER | Error sending notifications for reminder ID 1: [Error: SQLITE_ERROR: no such column: profile_picture_url] {
  errno: [33m1[39m,
  code: [32m'SQLITE_ERROR'[39m
}

[90mstderr[2m | backend/src/routes/__tests__/auth.test.ts[2m > [22m[2mAuth Routes[2m > [22m[2mPOST /api/auth/register[2m > [22m[2mshould return 500 for generic error
[22m[39m[2026-01-15T18:50:46.412Z] AUTH_ROUTE | Error requesting registration magic link: Error: Database connection failed
    at D:/Code/habitus/backend/src/routes/__tests__/auth.test.ts:389:30
    at [90mfile:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
    at [90mfile:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:919:26
    at [90mfile:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1244:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1210:10[90m)[39m
    at [90mfile:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1654:37
    at Traces.$ [90m(file:///D:/Code/habitus/[39mnode_modules/[4mvitest[24m/dist/chunks/traces.U4xDYhzZ.js:115:27[90m)[39m
    at trace [90m(file:///D:/Code/habitus/[39mnode_modules/[4mvitest[24m/dist/chunks/test.DqQZzsWf.js:234:21[90m)[39m
    at runTest [90m(file:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1654:12[90m)[39m

 [32mâœ“[39m backend/src/__tests__/server.test.ts[2m > [22mServer Configuration - Integration Tests[2m > [22mServer.ts Integration - Actual Import Tests[2m > [22mshould import server.ts in development mode with Vite[32m 6[2mms[22m[39m
 [32mâœ“[39m backend/src/__tests__/server.test.ts[2m > [22mServer Configuration - Integration Tests[2m > [22mServer.ts Integration - Actual Import Tests[2m > [22mshould handle Vite initialization error[32m 6[2mms[22m[39m
 [32mâœ“[39m backend/src/__tests__/server.test.ts[2m > [22mServer Configuration - Integration Tests[2m > [22mServer.ts Integration - Actual Import Tests[2m > [22mshould handle server.ts import with TRUST_PROXY enabled[32m 37[2mms[22m[39m
 [32mâœ“[39m backend/src/__tests__/server.test.ts[2m > [22mServer Configuration - Integration Tests[2m > [22mServer.ts Integration - Actual Import Tests[2m > [22mshould handle server.ts import with development mode and Vite server[32m 13[2mms[22m[39m
[90mstderr[2m | backend/src/routes/__tests__/trackings.test.ts[2m > [22m[2mTrackings Routes[2m > [22m[2mPOST /api/trackings[2m > [22m[2mshould return 500 when service throws non-TypeError
[22m[39m[2026-01-15T18:50:46.421Z] TRACKING_ROUTE | Error creating tracking: Error: Database error
    at D:/Code/habitus/backend/src/routes/__tests__/trackings.test.ts:412:51
    at [90mfile:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
    at [90mfile:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:919:26
    at [90mfile:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1244:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1210:10[90m)[39m
    at [90mfile:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1654:37
    at Traces.$ [90m(file:///D:/Code/habitus/[39mnode_modules/[4mvitest[24m/dist/chunks/traces.U4xDYhzZ.js:115:27[90m)[39m
    at trace [90m(file:///D:/Code/habitus/[39mnode_modules/[4mvitest[24m/dist/chunks/test.DqQZzsWf.js:234:21[90m)[39m
    at runTest [90m(file:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1654:12[90m)[39m

 [32mâœ“[39m backend/src/routes/__tests__/reminders.test.ts[2m > [22mReminders Routes[2m > [22mGET /api/reminders/:id[2m > [22mshould return 400 for invalid reminder ID[32m 17[2mms[22m[39m
 [32mâœ“[39m backend/src/routes/__tests__/reminders.test.ts[2m > [22mReminders Routes[2m > [22mPOST /api/reminders[2m > [22mshould create a new reminder[32m 31[2mms[22m[39m
 [32mâœ“[39m backend/src/routes/__tests__/reminders.test.ts[2m > [22mReminders Routes[2m > [22mPOST /api/reminders[2m > [22mshould return 400 if tracking_id is missing[32m 24[2mms[22m[39m
 [32mâœ“[39m backend/src/routes/__tests__/reminders.test.ts[2m > [22mReminders Routes[2m > [22mPUT /api/reminders/:id[2m > [22mshould update a reminder[32m 12[2mms[22m[39m
 [32mâœ“[39m backend/src/routes/__tests__/reminders.test.ts[2m > [22mReminders Routes[2m > [22mPUT /api/reminders/:id[2m > [22mshould return 404 if reminder not found[32m 9[2mms[22m[39m
 [32mâœ“[39m backend/src/routes/__tests__/admin.test.ts[2m > [22mAdmin Routes[2m > [22mGET /api/admin[2m > [22mshould return admin log with empty data when no data exists[32m 46[2mms[22m[39m
 [32mâœ“[39m backend/src/routes/__tests__/auth.test.ts[2m > [22mAuth Routes[2m > [22mPOST /api/auth/register[2m > [22mshould return 400 for invalid email format[32m 14[2mms[22m[39m
 [32mâœ“[39m backend/src/routes/__tests__/auth.test.ts[2m > [22mAuth Routes[2m > [22mPOST /api/auth/register[2m > [22mshould return 409 for duplicate email[32m 25[2mms[22m[39m
 [32mâœ“[39m backend/src/routes/__tests__/auth.test.ts[2m > [22mAuth Routes[2m > [22mPOST /api/auth/register[2m > [22mshould enforce cooldown period for registration magic link requests[32m 15[2mms[22m[39m
 [32mâœ“[39m backend/src/routes/__tests__/auth.test.ts[2m > [22mAuth Routes[2m > [22mPOST /api/auth/register[2m > [22mshould handle profile picture upload[32m 9[2mms[22m[39m
 [32mâœ“[39m backend/src/routes/__tests__/auth.test.ts[2m > [22mAuth Routes[2m > [22mPOST /api/auth/register[2m > [22mshould return 400 for 'Only image files' error[32m 9[2mms[22m[39m
 [32mâœ“[39m backend/src/routes/__tests__/auth.test.ts[2m > [22mAuth Routes[2m > [22mPOST /api/auth/register[2m > [22mshould return 400 for TypeError[32m 8[2mms[22m[39m
 [32mâœ“[39m backend/src/routes/__tests__/auth.test.ts[2m > [22mAuth Routes[2m > [22mPOST /api/auth/register[2m > [22mshould return 500 for generic error[32m 11[2mms[22m[39m
 [32mâœ“[39m backend/src/routes/__tests__/auth.test.ts[2m > [22mAuth Routes[2m > [22mPOST /api/auth/register[2m > [22mshould return 400 for non-string name[32m 10[2mms[22m[39m
 [32mâœ“[39m backend/src/routes/__tests__/auth.test.ts[2m > [22mAuth Routes[2m > [22mPOST /api/auth/register[2m > [22mshould return 400 for non-string email[32m 9[2mms[22m[39m
[90mstderr[2m | backend/src/routes/__tests__/reminders.test.ts[2m > [22m[2mReminders Routes[2m > [22m[2mPATCH /api/reminders/:id/snooze[2m > [22m[2mshould return 400 for invalid minutes
[22m[39m[2026-01-15T18:50:46.441Z] ERROR   | DATABASE | Query execution failed: SELECT id, name, email, profile_picture_url, telegram_chat_id, notification_channels, locale, timezo [Error: SQLITE_ERROR: no such column: profile_picture_url] {
  errno: [33m1[39m,
  code: [32m'SQLITE_ERROR'[39m
}

[90mstderr[2m | backend/src/routes/__tests__/reminders.test.ts[2m > [22m[2mReminders Routes[2m > [22m[2mPATCH /api/reminders/:id/snooze[2m > [22m[2mshould return 400 for invalid minutes
[22m[39m[2026-01-15T18:50:46.441Z] REMINDER | Error sending notifications for reminder ID 1: [Error: SQLITE_ERROR: no such column: profile_picture_url] {
  errno: [33m1[39m,
  code: [32m'SQLITE_ERROR'[39m
}

 [32mâœ“[39m backend/src/routes/__tests__/users.test.ts[2m > [22mUsers Routes[2m > [22mPUT /api/users/profile[2m > [22mshould handle errors when update fails[32m 11[2mms[22m[39m
 [32mâœ“[39m backend/src/routes/__tests__/users.test.ts[2m > [22mUsers Routes[2m > [22mPUT /api/users/profile[2m > [22mshould handle TypeError errors with 400 status[32m 8[2mms[22m[39m
 [32mâœ“[39m backend/src/routes/__tests__/users.test.ts[2m > [22mUsers Routes[2m > [22mPUT /api/users/profile[2m > [22mshould handle Email already registered error with 409 status[32m 9[2mms[22m[39m
 [32mâœ“[39m backend/src/routes/__tests__/users.test.ts[2m > [22mUsers Routes[2m > [22mPUT /api/users/profile[2m > [22mshould handle Only image files error with 400 status[32m 8[2mms[22m[39m
 [32mâœ“[39m backend/src/routes/__tests__/users.test.ts[2m > [22mUsers Routes[2m > [22mPUT /api/users/profile[2m > [22mshould handle file upload with cleanup on error[32m 12[2mms[22m[39m
 [32mâœ“[39m backend/src/routes/__tests__/users.test.ts[2m > [22mUsers Routes[2m > [22mPUT /api/users/profile[2m > [22mshould handle removeProfilePicture set to true[32m 9[2mms[22m[39m
 [32mâœ“[39m backend/src/routes/__tests__/users.test.ts[2m > [22mUsers Routes[2m > [22mPUT /api/users/profile[2m > [22mshould handle removeProfilePicture set to string true[32m 9[2mms[22m[39m
 [32mâœ“[39m backend/src/routes/__tests__/users.test.ts[2m > [22mUsers Routes[2m > [22mPUT /api/users/notifications[2m > [22mshould update notification preferences successfully[32m 12[2mms[22m[39m
 [32mâœ“[39m backend/src/routes/__tests__/users.test.ts[2m > [22mUsers Routes[2m > [22mPUT /api/users/notifications[2m > [22mshould update notification preferences with Telegram[32m 24[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/reminderService.test.ts[2m > [22mReminderService[2m > [22mcreateReminder[2m > [22mshould create a new reminder[32m 26[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/reminderService.test.ts[2m > [22mReminderService[2m > [22mgetAllByUserId[2m > [22mshould delete orphaned reminders (reminders whose tracking no longer exists)[32m 19[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/reminderService.test.ts[2m > [22mReminderService[2m > [22mgetAllByUserId[2m > [22mshould get all reminders for a user[32m 14[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/reminderService.test.ts[2m > [22mReminderService[2m > [22mgetAllByUserId[2m > [22mshould exclude Answered reminders from results[32m 12[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/reminderService.test.ts[2m > [22mReminderService[2m > [22mgetAllByUserId[2m > [22mshould update expired upcoming reminders to Pending and create new Upcoming reminder[32m 14[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/reminderService.test.ts[2m > [22mReminderService[2m > [22mgetAllByUserId[2m > [22mshould not update non-expired upcoming reminders[32m 4[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/reminderService.test.ts[2m > [22mReminderService[2m > [22mgetById[2m > [22mshould get a reminder by ID[32m 5[2mms[22m[39m
 [32mâœ“[39m backend/src/routes/__tests__/trackings.test.ts[2m > [22mTrackings Routes[2m > [22mPOST /api/trackings[2m > [22mshould create a new tracking[32m 48[2mms[22m[39m
 [32mâœ“[39m backend/src/routes/__tests__/trackings.test.ts[2m > [22mTrackings Routes[2m > [22mPOST /api/trackings[2m > [22mshould create tracking with notes[32m 19[2mms[22m[39m
 [32mâœ“[39m backend/src/routes/__tests__/trackings.test.ts[2m > [22mTrackings Routes[2m > [22mPOST /api/trackings[2m > [22mshould return 400 when question is missing[32m 11[2mms[22m[39m
 [32mâœ“[39m backend/src/routes/__tests__/trackings.test.ts[2m > [22mTrackings Routes[2m > [22mPOST /api/trackings[2m > [22mshould return 400 when schedules are missing[32m 8[2mms[22m[39m
 [32mâœ“[39m backend/src/routes/__tests__/trackings.test.ts[2m > [22mTrackings Routes[2m > [22mPOST /api/trackings[2m > [22mshould return 400 when schedules are missing[32m 8[2mms[22m[39m
 [32mâœ“[39m backend/src/routes/__tests__/trackings.test.ts[2m > [22mTrackings Routes[2m > [22mPOST /api/trackings[2m > [22mshould return 400 for invalid question[32m 9[2mms[22m[39m
 [32mâœ“[39m backend/src/routes/__tests__/trackings.test.ts[2m > [22mTrackings Routes[2m > [22mPOST /api/trackings[2m > [22mshould return 400 when service throws TypeError[32m 9[2mms[22m[39m
 [32mâœ“[39m backend/src/routes/__tests__/trackings.test.ts[2m > [22mTrackings Routes[2m > [22mPOST /api/trackings[2m > [22mshould return 500 when service throws non-TypeError[32m 10[2mms[22m[39m
 [32mâœ“[39m backend/src/routes/__tests__/trackings.test.ts[2m > [22mTrackings Routes[2m > [22mPUT /api/trackings/:id[2m > [22mshould update tracking[32m 10[2mms[22m[39m
 [32mâœ“[39m backend/src/routes/__tests__/trackings.test.ts[2m > [22mTrackings Routes[2m > [22mPUT /api/trackings/:id[2m > [22mshould return 404 for non-existent tracking[32m 9[2mms[22m[39m
[90mstderr[2m | backend/src/routes/__tests__/reminders.test.ts[2m > [22m[2mReminders Routes[2m > [22m[2mPATCH /api/reminders/:id/complete[2m > [22m[2mshould complete a reminder
[22m[39m[2026-01-15T18:50:46.451Z] ERROR   | DATABASE | Query execution failed: SELECT id, name, email, profile_picture_url, telegram_chat_id, notification_channels, locale, timezo [Error: SQLITE_ERROR: no such column: profile_picture_url] {
  errno: [33m1[39m,
  code: [32m'SQLITE_ERROR'[39m
}

[90mstderr[2m | backend/src/routes/__tests__/reminders.test.ts[2m > [22m[2mReminders Routes[2m > [22m[2mPATCH /api/reminders/:id/complete[2m > [22m[2mshould complete a reminder
[22m[39m[2026-01-15T18:50:46.451Z] REMINDER | Error sending notifications for reminder ID 1: [Error: SQLITE_ERROR: no such column: profile_picture_url] {
  errno: [33m1[39m,
  code: [32m'SQLITE_ERROR'[39m
}

 [32mâœ“[39m backend/src/services/__tests__/index.test.ts[2m > [22mServices Index[2m > [22minitializeServices[2m > [22mshould initialize all services with database[32m 6[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/index.test.ts[2m > [22mServices Index[2m > [22minitializeServices[2m > [22mshould create EmailService instance[32m 3[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/index.test.ts[2m > [22mServices Index[2m > [22minitializeServices[2m > [22mshould create AuthService with database and emailService[32m 3[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/index.test.ts[2m > [22mServices Index[2m > [22minitializeServices[2m > [22mshould create UserService with database[32m 3[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/index.test.ts[2m > [22mServices Index[2m > [22minitializeServices[2m > [22mshould create TrackingService with database[32m 3[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/index.test.ts[2m > [22mServices Index[2m > [22minitializeServices[2m > [22mshould create AiService instance[32m 4[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/index.test.ts[2m > [22mServices Index[2m > [22minitializeServices[2m > [22mshould create TelegramService instance[32m 3[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/index.test.ts[2m > [22mServices Index[2m > [22minitializeServices[2m > [22mshould create ReminderService with database[32m 3[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/index.test.ts[2m > [22mServices Index[2m > [22mgetAuthService[2m > [22mshould return AuthService instance after initialization[32m 3[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/index.test.ts[2m > [22mServices Index[2m > [22mgetAuthService[2m > [22mshould throw error if services not initialized[32m 15[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/index.test.ts[2m > [22mServices Index[2m > [22mgetUserService[2m > [22mshould return UserService instance after initialization[32m 5[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/index.test.ts[2m > [22mServices Index[2m > [22mgetUserService[2m > [22mshould throw error if services not initialized[32m 16[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/index.test.ts[2m > [22mServices Index[2m > [22mgetTrackingService[2m > [22mshould return TrackingService instance after initialization[32m 3[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/index.test.ts[2m > [22mServices Index[2m > [22mgetTrackingService[2m > [22mshould throw error if services not initialized[32m 9[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/index.test.ts[2m > [22mServices Index[2m > [22mgetEmailService[2m > [22mshould return EmailService instance after initialization[32m 3[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/index.test.ts[2m > [22mServices Index[2m > [22mgetEmailService[2m > [22mshould throw error if services not initialized[32m 9[2mms[22m[39m
[90mstderr[2m | backend/src/routes/__tests__/reminders.test.ts[2m > [22m[2mReminders Routes[2m > [22m[2mPATCH /api/reminders/:id/dismiss[2m > [22m[2mshould dismiss a reminder
[22m[39m[2026-01-15T18:50:46.477Z] ERROR   | DATABASE | Query execution failed: SELECT id, name, email, profile_picture_url, telegram_chat_id, notification_channels, locale, timezo [Error: SQLITE_ERROR: no such column: profile_picture_url] {
  errno: [33m1[39m,
  code: [32m'SQLITE_ERROR'[39m
}

[90mstderr[2m | backend/src/routes/__tests__/reminders.test.ts[2m > [22m[2mReminders Routes[2m > [22m[2mPATCH /api/reminders/:id/dismiss[2m > [22m[2mshould dismiss a reminder
[22m[39m[2026-01-15T18:50:46.477Z] REMINDER | Error sending notifications for reminder ID 1: [Error: SQLITE_ERROR: no such column: profile_picture_url] {
  errno: [33m1[39m,
  code: [32m'SQLITE_ERROR'[39m
}

[90mstderr[2m | backend/src/routes/__tests__/admin.test.ts[2m > [22m[2mAdmin Routes[2m > [22m[2mGET /api/admin[2m > [22m[2mshould return 500 when service throws error
[22m[39m[2026-01-15T18:50:46.479Z] ADMIN_CONTROLLER | Error generating admin log: Error: Service error
    at Object.<anonymous> (D:/Code/habitus/backend/src/routes/__tests__/admin.test.ts:262:15)
    at Object.Mock [as getUserService] [90m(file:///D:/Code/habitus/[39mnode_modules/[4m@vitest/spy[24m/dist/index.js:280:34[90m)[39m
    at AdminController.getUserService (D:/Code/habitus/backend/src/routes/admin/admin.ts:23:27)
    at AdminController.generateAdminLog (D:/Code/habitus/backend/src/routes/admin/admin.ts:217:30)
    at AdminController.getAdminLog (D:/Code/habitus/backend/src/routes/admin/admin.ts:435:30)
    at D:/Code/habitus/backend/src/routes/admin/admin.ts:531:25
    at Layer.handle [as handle_request] [90m(D:\Code\habitus\[39mnode_modules\[4mexpress[24m\lib\router\layer.js:95:5[90m)[39m
    at next [90m(D:\Code\habitus\[39mnode_modules\[4mexpress[24m\lib\router\route.js:149:13[90m)[39m
    at D:/Code/habitus/backend/src/routes/__tests__/admin.test.ts:151:9
    at Mock [90m(file:///D:/Code/habitus/[39mnode_modules/[4m@vitest/spy[24m/dist/index.js:280:34[90m)[39m

[90mstderr[2m | backend/src/routes/__tests__/users.test.ts[2m > [22m[2mUsers Routes[2m > [22m[2mPUT /api/users/notifications[2m > [22m[2mshould handle errors when update fails
[22m[39m[2026-01-15T18:50:46.489Z] USER_ROUTE | Error updating notification preferences: Error: Database error
    at D:/Code/habitus/backend/src/routes/__tests__/users.test.ts:491:30
    at [90mfile:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
    at [90mfile:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:919:26
    at [90mfile:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1244:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1210:10[90m)[39m
    at [90mfile:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1654:37
    at Traces.$ [90m(file:///D:/Code/habitus/[39mnode_modules/[4mvitest[24m/dist/chunks/traces.U4xDYhzZ.js:115:27[90m)[39m
    at trace [90m(file:///D:/Code/habitus/[39mnode_modules/[4mvitest[24m/dist/chunks/test.DqQZzsWf.js:234:21[90m)[39m
    at runTest [90m(file:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1654:12[90m)[39m

[90mstderr[2m | backend/src/routes/__tests__/trackings.test.ts[2m > [22m[2mTrackings Routes[2m > [22m[2mPUT /api/trackings/:id[2m > [22m[2mshould return 500 when service throws generic error
[22m[39m[2026-01-15T18:50:46.491Z] TRACKING_ROUTE | Error updating tracking: Error: Database error
    at D:/Code/habitus/backend/src/routes/__tests__/trackings.test.ts:540:51
    at [90mfile:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
    at [90mfile:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:919:26
    at [90mfile:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1244:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1210:10[90m)[39m
    at [90mfile:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1654:37
    at Traces.$ [90m(file:///D:/Code/habitus/[39mnode_modules/[4mvitest[24m/dist/chunks/traces.U4xDYhzZ.js:115:27[90m)[39m
    at trace [90m(file:///D:/Code/habitus/[39mnode_modules/[4mvitest[24m/dist/chunks/test.DqQZzsWf.js:234:21[90m)[39m
    at runTest [90m(file:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1654:12[90m)[39m

[90mstderr[2m | backend/src/routes/__tests__/reminders.test.ts[2m > [22m[2mReminders Routes[2m > [22m[2mDELETE /api/reminders/:id[2m > [22m[2mshould delete a reminder
[22m[39m[2026-01-15T18:50:46.500Z] ERROR   | DATABASE | Query execution failed: SELECT id, name, email, profile_picture_url, telegram_chat_id, notification_channels, locale, timezo [Error: SQLITE_ERROR: no such column: profile_picture_url] {
  errno: [33m1[39m,
  code: [32m'SQLITE_ERROR'[39m
}

[90mstderr[2m | backend/src/routes/__tests__/reminders.test.ts[2m > [22m[2mReminders Routes[2m > [22m[2mDELETE /api/reminders/:id[2m > [22m[2mshould delete a reminder
[22m[39m[2026-01-15T18:50:46.500Z] REMINDER | Error sending notifications for reminder ID 1: [Error: SQLITE_ERROR: no such column: profile_picture_url] {
  errno: [33m1[39m,
  code: [32m'SQLITE_ERROR'[39m
}

[90mstderr[2m | backend/src/routes/__tests__/auth.test.ts[2m > [22m[2mAuth Routes[2m > [22m[2mPOST /api/auth/login[2m > [22m[2mshould return 200 for generic error (to prevent email enumeration)
[22m[39m[2026-01-15T18:50:46.502Z] AUTH_ROUTE | Error requesting login magic link: Error: Database connection failed
    at D:/Code/habitus/backend/src/routes/__tests__/auth.test.ts:503:30
    at [90mfile:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
    at [90mfile:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:919:26
    at [90mfile:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1244:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1210:10[90m)[39m
    at [90mfile:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1654:37
    at Traces.$ [90m(file:///D:/Code/habitus/[39mnode_modules/[4mvitest[24m/dist/chunks/traces.U4xDYhzZ.js:115:27[90m)[39m
    at trace [90m(file:///D:/Code/habitus/[39mnode_modules/[4mvitest[24m/dist/chunks/test.DqQZzsWf.js:234:21[90m)[39m
    at runTest [90m(file:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1654:12[90m)[39m

 [32mâœ“[39m backend/src/services/__tests__/index.test.ts[2m > [22mServices Index[2m > [22mgetAiService[2m > [22mshould return AiService instance after initialization[32m 4[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/index.test.ts[2m > [22mServices Index[2m > [22mgetAiService[2m > [22mshould throw error if services not initialized[32m 11[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/index.test.ts[2m > [22mServices Index[2m > [22mgetTelegramService[2m > [22mshould return TelegramService instance after initialization[32m 4[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/index.test.ts[2m > [22mServices Index[2m > [22mgetTelegramService[2m > [22mshould throw error if services not initialized[32m 13[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/index.test.ts[2m > [22mServices Index[2m > [22mgetReminderService[2m > [22mshould return ReminderService instance after initialization[32m 3[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/index.test.ts[2m > [22mServices Index[2m > [22mgetReminderService[2m > [22mshould throw error if services not initialized[32m 11[2mms[22m[39m
 [32mâœ“[39m backend/src/routes/__tests__/reminders.test.ts[2m > [22mReminders Routes[2m > [22mPATCH /api/reminders/:id/snooze[2m > [22mshould snooze a reminder[32m 30[2mms[22m[39m
 [32mâœ“[39m backend/src/routes/__tests__/reminders.test.ts[2m > [22mReminders Routes[2m > [22mPATCH /api/reminders/:id/snooze[2m > [22mshould return 400 for invalid minutes[32m 11[2mms[22m[39m
 [32mâœ“[39m backend/src/routes/__tests__/reminders.test.ts[2m > [22mReminders Routes[2m > [22mPATCH /api/reminders/:id/complete[2m > [22mshould complete a reminder[32m 12[2mms[22m[39m
 [32mâœ“[39m backend/src/routes/__tests__/reminders.test.ts[2m > [22mReminders Routes[2m > [22mPATCH /api/reminders/:id/complete[2m > [22mshould return 404 if reminder not found[32m 12[2mms[22m[39m
 [32mâœ“[39m backend/src/routes/__tests__/reminders.test.ts[2m > [22mReminders Routes[2m > [22mPATCH /api/reminders/:id/dismiss[2m > [22mshould dismiss a reminder[32m 13[2mms[22m[39m
 [32mâœ“[39m backend/src/routes/__tests__/reminders.test.ts[2m > [22mReminders Routes[2m > [22mPATCH /api/reminders/:id/dismiss[2m > [22mshould return 404 if reminder not found[32m 9[2mms[22m[39m
 [32mâœ“[39m backend/src/routes/__tests__/reminders.test.ts[2m > [22mReminders Routes[2m > [22mDELETE /api/reminders/:id[2m > [22mshould delete a reminder[32m 12[2mms[22m[39m
 [32mâœ“[39m backend/src/routes/__tests__/reminders.test.ts[2m > [22mReminders Routes[2m > [22mDELETE /api/reminders/:id[2m > [22mshould return 404 if reminder not found[32m 15[2mms[22m[39m
[90mstderr[2m | backend/src/routes/__tests__/users.test.ts[2m > [22m[2mUsers Routes[2m > [22m[2mDELETE /api/users/telegram[2m > [22m[2mshould return 500 if service throws unexpected error
[22m[39m[2026-01-15T18:50:46.526Z] USER_ROUTE | Error disconnecting Telegram: Error: Database error
    at D:/Code/habitus/backend/src/routes/__tests__/users.test.ts:553:31
    at [90mfile:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
    at [90mfile:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:919:26
    at [90mfile:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1244:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1210:10[90m)[39m
    at [90mfile:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1654:37
    at Traces.$ [90m(file:///D:/Code/habitus/[39mnode_modules/[4mvitest[24m/dist/chunks/traces.U4xDYhzZ.js:115:27[90m)[39m
    at trace [90m(file:///D:/Code/habitus/[39mnode_modules/[4mvitest[24m/dist/chunks/test.DqQZzsWf.js:234:21[90m)[39m
    at runTest [90m(file:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1654:12[90m)[39m

[90mstderr[2m | backend/src/routes/__tests__/trackings.test.ts[2m > [22m[2mTrackings Routes[2m > [22m[2mDELETE /api/trackings/:id[2m > [22m[2mshould return 500 when service throws non-404 error
[22m[39m[2026-01-15T18:50:46.530Z] TRACKING_ROUTE | Error deleting tracking: Error: Database error
    at D:/Code/habitus/backend/src/routes/__tests__/trackings.test.ts:608:51
    at [90mfile:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
    at [90mfile:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:919:26
    at [90mfile:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1244:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1210:10[90m)[39m
    at [90mfile:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1654:37
    at Traces.$ [90m(file:///D:/Code/habitus/[39mnode_modules/[4mvitest[24m/dist/chunks/traces.U4xDYhzZ.js:115:27[90m)[39m
    at trace [90m(file:///D:/Code/habitus/[39mnode_modules/[4mvitest[24m/dist/chunks/test.DqQZzsWf.js:234:21[90m)[39m
    at runTest [90m(file:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1654:12[90m)[39m

 [32mâœ“[39m backend/src/services/__tests__/trackingService.test.ts[2m > [22mTrackingService[2m > [22mgetAllByUserId[2m > [22mshould return empty array when no trackings exist[32m 14[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/trackingService.test.ts[2m > [22mTrackingService[2m > [22mgetAllByUserId[2m > [22mshould return all trackings for a user[32m 27[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/trackingService.test.ts[2m > [22mTrackingService[2m > [22mgetAllByUserId[2m > [22mshould not return trackings for other users[32m 5[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/trackingService.test.ts[2m > [22mTrackingService[2m > [22mgetById[2m > [22mshould return null for non-existent tracking[32m 5[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/trackingService.test.ts[2m > [22mTrackingService[2m > [22mgetById[2m > [22mshould return tracking for existing id[32m 8[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/trackingService.test.ts[2m > [22mTrackingService[2m > [22mgetById[2m > [22mshould return null for tracking belonging to different user[32m 5[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/trackingService.test.ts[2m > [22mTrackingService[2m > [22mcreateTracking[2m > [22mshould create a new tracking[32m 21[2mms[22m[39m
 [32mâœ“[39m backend/src/routes/__tests__/auth.test.ts[2m > [22mAuth Routes[2m > [22mPOST /api/auth/login[2m > [22mshould request login magic link[32m 21[2mms[22m[39m
 [32mâœ“[39m backend/src/routes/__tests__/auth.test.ts[2m > [22mAuth Routes[2m > [22mPOST /api/auth/login[2m > [22mshould return 400 for missing email[32m 13[2mms[22m[39m
 [32mâœ“[39m backend/src/routes/__tests__/auth.test.ts[2m > [22mAuth Routes[2m > [22mPOST /api/auth/login[2m > [22mshould enforce cooldown period but still return success for login (to prevent email enumeration)[32m 17[2mms[22m[39m
 [32mâœ“[39m backend/src/routes/__tests__/auth.test.ts[2m > [22mAuth Routes[2m > [22mPOST /api/auth/login[2m > [22mshould return 200 for generic error (to prevent email enumeration)[32m 16[2mms[22m[39m
 [32mâœ“[39m backend/src/routes/__tests__/auth.test.ts[2m > [22mAuth Routes[2m > [22mGET /api/auth/verify-magic-link[2m > [22mshould verify magic link and return user data with JWT token[32m 17[2mms[22m[39m
 [32mâœ“[39m backend/src/routes/__tests__/auth.test.ts[2m > [22mAuth Routes[2m > [22mGET /api/auth/verify-magic-link[2m > [22mshould return 400 for missing token[32m 18[2mms[22m[39m
 [32mâœ“[39m backend/src/routes/__tests__/admin.test.ts[2m > [22mAdmin Routes[2m > [22mGET /api/admin[2m > [22mshould return admin log with users data[32m 60[2mms[22m[39m
 [32mâœ“[39m backend/src/routes/__tests__/admin.test.ts[2m > [22mAdmin Routes[2m > [22mGET /api/admin[2m > [22mshould return admin log with trackings and reminders[32m 28[2mms[22m[39m
 [32mâœ“[39m backend/src/routes/__tests__/admin.test.ts[2m > [22mAdmin Routes[2m > [22mGET /api/admin[2m > [22mshould return 500 when service throws error[32m 18[2mms[22m[39m
 [32mâœ“[39m backend/src/routes/__tests__/admin.test.ts[2m > [22mAdmin Routes[2m > [22mGET /api/admin[2m > [22mshould return admin log with users having optional fields[32m 16[2mms[22m[39m
 [32mâœ“[39m backend/src/routes/__tests__/admin.test.ts[2m > [22mAdmin Routes[2m > [22mGET /api/admin[2m > [22mshould return admin log with trackings in different states[32m 12[2mms[22m[39m
 [32mâœ“[39m backend/src/routes/__tests__/admin.test.ts[2m > [22mAdmin Routes[2m > [22mGET /api/admin[2m > [22mshould return admin log with trackings without schedules[32m 12[2mms[22m[39m
 [32mâœ“[39m backend/src/routes/__tests__/users.test.ts[2m > [22mUsers Routes[2m > [22mPUT /api/users/notifications[2m > [22mshould return 400 if notificationChannel is missing[32m 30[2mms[22m[39m
 [32mâœ“[39m backend/src/routes/__tests__/users.test.ts[2m > [22mUsers Routes[2m > [22mPUT /api/users/notifications[2m > [22mshould handle TypeError with 400 status[32m 9[2mms[22m[39m
 [32mâœ“[39m backend/src/routes/__tests__/users.test.ts[2m > [22mUsers Routes[2m > [22mPUT /api/users/notifications[2m > [22mshould handle User not found error with 404 status[32m 8[2mms[22m[39m
 [32mâœ“[39m backend/src/routes/__tests__/users.test.ts[2m > [22mUsers Routes[2m > [22mPUT /api/users/notifications[2m > [22mshould handle errors when update fails[32m 9[2mms[22m[39m
 [32mâœ“[39m backend/src/routes/__tests__/users.test.ts[2m > [22mUsers Routes[2m > [22mDELETE /api/users/telegram[2m > [22mshould disconnect Telegram successfully[32m 18[2mms[22m[39m
 [32mâœ“[39m backend/src/routes/__tests__/users.test.ts[2m > [22mUsers Routes[2m > [22mDELETE /api/users/telegram[2m > [22mshould return 404 if user not found[32m 8[2mms[22m[39m
 [32mâœ“[39m backend/src/routes/__tests__/users.test.ts[2m > [22mUsers Routes[2m > [22mDELETE /api/users/telegram[2m > [22mshould return 500 if service throws unexpected error[32m 12[2mms[22m[39m
 [32mâœ“[39m backend/src/routes/__tests__/users.test.ts[2m > [22mUsers Routes[2m > [22mDELETE /api/users/profile[2m > [22mshould delete user account successfully[32m 14[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/reminderService.test.ts[2m > [22mReminderService[2m > [22mgetById[2m > [22mshould return null if reminder not found[32m 7[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/reminderService.test.ts[2m > [22mReminderService[2m > [22mgetById[2m > [22mshould update expired upcoming reminder to Pending and create new Upcoming reminder[32m 9[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/reminderService.test.ts[2m > [22mReminderService[2m > [22mupdateReminder[2m > [22mshould update reminder[32m 6[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/reminderService.test.ts[2m > [22mReminderService[2m > [22mupdateReminder[2m > [22mshould create next Upcoming reminder when reminder is completed[32m 7[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/reminderService.test.ts[2m > [22mReminderService[2m > [22mupdateReminder[2m > [22mshould throw error if reminder not found[32m 6[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/reminderService.test.ts[2m > [22mReminderService[2m > [22msnoozeReminder[2m > [22mshould update existing Upcoming reminder time when snoozing a Pending reminder[32m 8[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/reminderService.test.ts[2m > [22mReminderService[2m > [22msnoozeReminder[2m > [22mshould create new Upcoming reminder when snoozing if no existing Upcoming[32m 8[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/reminderService.test.ts[2m > [22mReminderService[2m > [22msnoozeReminder[2m > [22mshould throw error if reminder not found[32m 3[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/reminderService.test.ts[2m > [22mReminderService[2m > [22mdeleteReminder[2m > [22mshould delete reminder and create next one[32m 6[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/reminderService.test.ts[2m > [22mReminderService[2m > [22mdeleteReminder[2m > [22mshould throw error if reminder not found[32m 3[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/reminderService.test.ts[2m > [22mReminderService[2m > [22mdeleteReminder[2m > [22mshould update existing upcoming reminder instead of deleting it[32m 8[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/reminderService.test.ts[2m > [22mReminderService[2m > [22mcreateNextReminderForTracking[2m > [22mshould create next reminder for tracking[32m 4[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/reminderService.test.ts[2m > [22mReminderService[2m > [22mcreateNextReminderForTracking[2m > [22mshould ensure unique future reminder by deleting old one and creating new one[32m 10[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/reminderService.test.ts[2m > [22mReminderService[2m > [22mcreateNextReminderForTracking[2m > [22mshould not create reminder for non-Running tracking[32m 3[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/reminderService.test.ts[2m > [22mReminderService[2m > [22mcreateNextReminderForTracking[2m > [22mshould return null if tracking not found[32m 3[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/reminderService.test.ts[2m > [22mReminderService[2m > [22mcreateNextReminderForTracking[2m > [22mshould return null if no valid time found[32m 3[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/reminderService.test.ts[2m > [22mReminderService[2m > [22mcreateNextReminderForTracking[2m > [22mshould exclude deleted time when creating next reminder[32m 6[2mms[22m[39m
 [32mâœ“[39m backend/src/routes/__tests__/trackings.test.ts[2m > [22mTrackings Routes[2m > [22mPUT /api/trackings/:id[2m > [22mshould return 400 when no fields to update[32m 10[2mms[22m[39m
 [32mâœ“[39m backend/src/routes/__tests__/trackings.test.ts[2m > [22mTrackings Routes[2m > [22mPUT /api/trackings/:id[2m > [22mshould return 400 for invalid tracking ID[32m 8[2mms[22m[39m
 [32mâœ“[39m backend/src/routes/__tests__/trackings.test.ts[2m > [22mTrackings Routes[2m > [22mPUT /api/trackings/:id[2m > [22mshould return 400 when schedules is empty array[32m 9[2mms[22m[39m
 [32mâœ“[39m backend/src/routes/__tests__/trackings.test.ts[2m > [22mTrackings Routes[2m > [22mPUT /api/trackings/:id[2m > [22mshould return 400 when service throws TypeError[32m 11[2mms[22m[39m
 [32mâœ“[39m backend/src/routes/__tests__/trackings.test.ts[2m > [22mTrackings Routes[2m > [22mPUT /api/trackings/:id[2m > [22mshould return 500 when service throws generic error[32m 12[2mms[22m[39m
 [32mâœ“[39m backend/src/routes/__tests__/trackings.test.ts[2m > [22mTrackings Routes[2m > [22mDELETE /api/trackings/:id[2m > [22mshould delete tracking[32m 10[2mms[22m[39m
 [32mâœ“[39m backend/src/routes/__tests__/trackings.test.ts[2m > [22mTrackings Routes[2m > [22mDELETE /api/trackings/:id[2m > [22mshould return 404 for non-existent tracking[32m 8[2mms[22m[39m
 [32mâœ“[39m backend/src/routes/__tests__/trackings.test.ts[2m > [22mTrackings Routes[2m > [22mDELETE /api/trackings/:id[2m > [22mshould return 400 for invalid tracking ID[32m 9[2mms[22m[39m
 [32mâœ“[39m backend/src/routes/__tests__/trackings.test.ts[2m > [22mTrackings Routes[2m > [22mDELETE /api/trackings/:id[2m > [22mshould return 500 when service throws non-404 error[32m 11[2mms[22m[39m
 [32mâœ“[39m backend/src/routes/__tests__/trackings.test.ts[2m > [22mTrackings Routes[2m > [22mPATCH /api/trackings/:id/state[2m > [22mshould update tracking state from Running to Paused[32m 11[2mms[22m[39m
[90mstderr[2m | backend/src/routes/__tests__/users.test.ts[2m > [22m[2mUsers Routes[2m > [22m[2mDELETE /api/users/profile[2m > [22m[2mshould handle errors when deletion fails
[22m[39m[2026-01-15T18:50:46.558Z] USER_ROUTE | Error deleting user: Error: Database error
    at D:/Code/habitus/backend/src/routes/__tests__/users.test.ts:610:47
    at [90mfile:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
    at [90mfile:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:919:26
    at [90mfile:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1244:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1210:10[90m)[39m
    at [90mfile:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1654:37
    at Traces.$ [90m(file:///D:/Code/habitus/[39mnode_modules/[4mvitest[24m/dist/chunks/traces.U4xDYhzZ.js:115:27[90m)[39m
    at trace [90m(file:///D:/Code/habitus/[39mnode_modules/[4mvitest[24m/dist/chunks/test.DqQZzsWf.js:234:21[90m)[39m
    at runTest [90m(file:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1654:12[90m)[39m

 [32mâœ“[39m backend/src/routes/__tests__/users.test.ts[2m > [22mUsers Routes[2m > [22mDELETE /api/users/profile[2m > [22mshould return 404 if user not found[32m 8[2mms[22m[39m
 [32mâœ“[39m backend/src/routes/__tests__/users.test.ts[2m > [22mUsers Routes[2m > [22mDELETE /api/users/profile[2m > [22mshould handle errors when deletion fails[32m 9[2mms[22m[39m
[90mstderr[2m | backend/src/routes/__tests__/auth.test.ts[2m > [22m[2mAuth Routes[2m > [22m[2mGET /api/auth/verify-magic-link[2m > [22m[2mshould return 500 for generic error
[22m[39m[2026-01-15T18:50:46.581Z] AUTH_ROUTE | Error verifying magic link: Error: Database connection failed
    at D:/Code/habitus/backend/src/routes/__tests__/auth.test.ts:599:30
    at [90mfile:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
    at [90mfile:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:919:26
    at [90mfile:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1244:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1210:10[90m)[39m
    at [90mfile:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1654:37
    at Traces.$ [90m(file:///D:/Code/habitus/[39mnode_modules/[4mvitest[24m/dist/chunks/traces.U4xDYhzZ.js:115:27[90m)[39m
    at trace [90m(file:///D:/Code/habitus/[39mnode_modules/[4mvitest[24m/dist/chunks/test.DqQZzsWf.js:234:21[90m)[39m
    at runTest [90m(file:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1654:12[90m)[39m

[90mstderr[2m | backend/src/routes/__tests__/admin.test.ts[2m > [22m[2mAdmin Routes[2m > [22m[2mGET /api/admin[2m > [22m[2mshould handle JSON parse errors in tracking frequency gracefully
[22m[39m[2026-01-15T18:50:46.613Z] ADMIN_CONTROLLER | Failed to parse frequency JSON for tracking 1: SyntaxError: Unexpected token 'i', "invalid json{" is not valid JSON
    at JSON.parse (<anonymous>)
    at D:/Code/habitus/backend/src/routes/admin/admin.ts:143:28
    at Array.map (<anonymous>)
    at AdminController.getAllTrackings (D:/Code/habitus/backend/src/routes/admin/admin.ts:140:12)
    at AdminController.generateAdminLog (D:/Code/habitus/backend/src/routes/admin/admin.ts:219:23)
    at AdminController.getAdminLog (D:/Code/habitus/backend/src/routes/admin/admin.ts:435:19)
    at D:/Code/habitus/backend/src/routes/admin/admin.ts:531:3

 [32mâœ“[39m backend/src/services/__tests__/trackingService.test.ts[2m > [22mTrackingService[2m > [22mcreateTracking[2m > [22mshould create tracking with notes[32m 6[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/trackingService.test.ts[2m > [22mTrackingService[2m > [22mcreateTracking[2m > [22mshould throw error for invalid question[32m 4[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/trackingService.test.ts[2m > [22mTrackingService[2m > [22mcreateTracking[2m > [22mshould throw error when no schedules provided[32m 3[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/trackingService.test.ts[2m > [22mTrackingService[2m > [22mcreateTracking[2m > [22mshould create initial Upcoming reminder when tracking is created with times and frequency[32m 6[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/trackingService.test.ts[2m > [22mTrackingService[2m > [22mcreateTracking[2m > [22mshould throw error when tracking is created without frequency (frequency is required)[32m 3[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/trackingService.test.ts[2m > [22mTrackingService[2m > [22mcreateTracking[2m > [22mshould store all frequency types correctly in database[2m > [22mshould store Daily frequency with schedules[32m 7[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/trackingService.test.ts[2m > [22mTrackingService[2m > [22mcreateTracking[2m > [22mshould store all frequency types correctly in database[2m > [22mshould store Weekly frequency with schedules[32m 6[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/trackingService.test.ts[2m > [22mTrackingService[2m > [22mcreateTracking[2m > [22mshould store all frequency types correctly in database[2m > [22mshould store Monthly frequency (day_number kind) with schedules[32m 19[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/trackingService.test.ts[2m > [22mTrackingService[2m > [22mcreateTracking[2m > [22mshould store all frequency types correctly in database[2m > [22mshould store Monthly frequency (last_day kind) with schedules[32m 8[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/trackingService.test.ts[2m > [22mTrackingService[2m > [22mcreateTracking[2m > [22mshould store all frequency types correctly in database[2m > [22mshould store Monthly frequency (weekday_ordinal kind) with schedules[32m 6[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/trackingService.test.ts[2m > [22mTrackingService[2m > [22mcreateTracking[2m > [22mshould store all frequency types correctly in database[2m > [22mshould store Yearly frequency (date kind) with schedules[32m 9[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/trackingService.test.ts[2m > [22mTrackingService[2m > [22mcreateTracking[2m > [22mshould store all frequency types correctly in database[2m > [22mshould store One-time tracking with schedules and create single reminder[32m 7[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/trackingService.test.ts[2m > [22mTrackingService[2m > [22mcreateTracking[2m > [22mshould store all frequency types correctly in database[2m > [22mshould store tracking with maximum 5 schedules for any frequency type[32m 7[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/trackingService.test.ts[2m > [22mTrackingService[2m > [22mupdateTracking[2m > [22mshould update tracking question[32m 4[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/trackingService.test.ts[2m > [22mTrackingService[2m > [22mupdateTracking[2m > [22mshould update tracking notes[32m 5[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/trackingService.test.ts[2m > [22mTrackingService[2m > [22mupdateTracking[2m > [22mshould throw error when tracking not found[32m 5[2mms[22m[39m
 [32mâœ“[39m backend/src/routes/__tests__/auth.test.ts[2m > [22mAuth Routes[2m > [22mGET /api/auth/verify-magic-link[2m > [22mshould return 400 for non-string token[32m 9[2mms[22m[39m
 [32mâœ“[39m backend/src/routes/__tests__/auth.test.ts[2m > [22mAuth Routes[2m > [22mGET /api/auth/verify-magic-link[2m > [22mshould return 400 for invalid token[32m 8[2mms[22m[39m
 [32mâœ“[39m backend/src/routes/__tests__/auth.test.ts[2m > [22mAuth Routes[2m > [22mGET /api/auth/verify-magic-link[2m > [22mshould return 400 for expired token[32m 15[2mms[22m[39m
 [32mâœ“[39m backend/src/routes/__tests__/auth.test.ts[2m > [22mAuth Routes[2m > [22mGET /api/auth/verify-magic-link[2m > [22mshould return 500 for generic error[32m 12[2mms[22m[39m
 [32mâœ“[39m backend/src/routes/__tests__/auth.test.ts[2m > [22mAuth Routes[2m > [22mGET /api/auth/me[2m > [22mshould return user data with valid token[32m 11[2mms[22m[39m
 [32mâœ“[39m backend/src/routes/__tests__/auth.test.ts[2m > [22mAuth Routes[2m > [22mGET /api/auth/me[2m > [22mshould return 401 for missing authorization header[32m 16[2mms[22m[39m
 [32mâœ“[39m backend/src/routes/__tests__/auth.test.ts[2m > [22mAuth Routes[2m > [22mGET /api/auth/me[2m > [22mshould return 401 for invalid token[32m 9[2mms[22m[39m
 [32mâœ“[39m backend/src/routes/__tests__/auth.test.ts[2m > [22mAuth Routes[2m > [22mGET /api/auth/me[2m > [22mshould return 401 for malformed authorization header[32m 8[2mms[22m[39m
 [32mâœ“[39m backend/src/routes/__tests__/auth.test.ts[2m > [22mAuth Routes[2m > [22mGET /api/auth/me[2m > [22mshould return 404 when user is not found[32m 9[2mms[22m[39m
[90mstderr[2m | backend/src/routes/__tests__/admin.test.ts[2m > [22m[2mAdmin Routes[2m > [22m[2mGET /api/admin[2m > [22m[2mshould return 500 when getAllTrackings throws error
[22m[39m[2026-01-15T18:50:46.640Z] ADMIN_CONTROLLER | Error generating admin log: Error: Database query error
    at Database.<anonymous> (D:/Code/habitus/backend/src/routes/__tests__/admin.test.ts:560:15)
    at Database.all [90m(file:///D:/Code/habitus/[39mnode_modules/[4m@vitest/spy[24m/dist/index.js:280:34[90m)[39m
    at UserService.getAllUsers (D:/Code/habitus/backend/src/services/userService.ts:33:32)
    at AdminController.generateAdminLog (D:/Code/habitus/backend/src/routes/admin/admin.ts:218:37)
    at AdminController.getAdminLog (D:/Code/habitus/backend/src/routes/admin/admin.ts:435:30)
    at D:/Code/habitus/backend/src/routes/admin/admin.ts:531:25
    at Layer.handle [as handle_request] [90m(D:\Code\habitus\[39mnode_modules\[4mexpress[24m\lib\router\layer.js:95:5[90m)[39m
    at next [90m(D:\Code\habitus\[39mnode_modules\[4mexpress[24m\lib\router\route.js:149:13[90m)[39m
    at D:/Code/habitus/backend/src/routes/__tests__/admin.test.ts:151:9
    at Mock [90m(file:///D:/Code/habitus/[39mnode_modules/[4m@vitest/spy[24m/dist/index.js:280:34[90m)[39m

 [32mâœ“[39m backend/src/routes/__tests__/admin.test.ts[2m > [22mAdmin Routes[2m > [22mGET /api/admin[2m > [22mshould return admin log with trackings without reminders[32m 18[2mms[22m[39m
 [32mâœ“[39m backend/src/routes/__tests__/admin.test.ts[2m > [22mAdmin Routes[2m > [22mGET /api/admin[2m > [22mshould return admin log with reminders in different statuses[32m 14[2mms[22m[39m
 [32mâœ“[39m backend/src/routes/__tests__/admin.test.ts[2m > [22mAdmin Routes[2m > [22mGET /api/admin[2m > [22mshould return admin log with reminders having notes[32m 14[2mms[22m[39m
 [32mâœ“[39m backend/src/routes/__tests__/admin.test.ts[2m > [22mAdmin Routes[2m > [22mGET /api/admin[2m > [22mshould return admin log with trackings having notes and icon[32m 30[2mms[22m[39m
 [32mâœ“[39m backend/src/routes/__tests__/admin.test.ts[2m > [22mAdmin Routes[2m > [22mGET /api/admin[2m > [22mshould handle JSON parse errors in tracking frequency gracefully[32m 12[2mms[22m[39m
 [32mâœ“[39m backend/src/routes/__tests__/admin.test.ts[2m > [22mAdmin Routes[2m > [22mGET /api/admin[2m > [22mshould return admin log with multiple schedules for a tracking[32m 14[2mms[22m[39m
 [32mâœ“[39m backend/src/routes/__tests__/admin.test.ts[2m > [22mAdmin Routes[2m > [22mGET /api/admin[2m > [22mshould return 500 when getAllTrackings throws error[32m 13[2mms[22m[39m
[90mstderr[2m | backend/src/routes/__tests__/auth.test.ts[2m > [22m[2mAuth Routes[2m > [22m[2mGET /api/auth/me[2m > [22m[2mshould return 500 for generic error
[22m[39m[2026-01-15T18:50:46.647Z] AUTH_ROUTE | Error fetching user: Error: Database connection failed
    at D:/Code/habitus/backend/src/routes/__tests__/auth.test.ts:696:30
    at [90mfile:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
    at [90mfile:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:919:26
    at [90mfile:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1244:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1210:10[90m)[39m
    at [90mfile:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1654:37
    at Traces.$ [90m(file:///D:/Code/habitus/[39mnode_modules/[4mvitest[24m/dist/chunks/traces.U4xDYhzZ.js:115:27[90m)[39m
    at trace [90m(file:///D:/Code/habitus/[39mnode_modules/[4mvitest[24m/dist/chunks/test.DqQZzsWf.js:234:21[90m)[39m
    at runTest [90m(file:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1654:12[90m)[39m

 [32mâœ“[39m backend/src/services/__tests__/reminderService.test.ts[2m > [22mReminderService[2m > [22mcreateNextReminderForTracking[2m > [22mshould delete upcoming reminder and create new one when tracking's scheduled time arrives[32m 6[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/reminderService.test.ts[2m > [22mReminderService[2m > [22mcreateNextReminderForTracking[2m > [22mshould delete existing future Upcoming reminder and create new unique one[32m 5[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/reminderService.test.ts[2m > [22mReminderService[2m > [22mcalculateNextReminderTime[2m > [22mshould calculate next reminder time for daily frequency[32m 4[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/reminderService.test.ts[2m > [22mReminderService[2m > [22mcalculateNextReminderTime[2m > [22mshould return null if tracking has no schedules[32m 3[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/reminderService.test.ts[2m > [22mReminderService[2m > [22mcalculateNextReminderTime[2m > [22mshould return null if tracking has no frequency[32m 5[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/reminderService.test.ts[2m > [22mReminderService[2m > [22mcalculateNextReminderTime[2m > [22mshould exclude specified time when calculating next reminder[32m 5[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/reminderService.test.ts[2m > [22mReminderService[2m > [22mcalculateNextReminderTime[2m > [22mshould calculate next reminder time for one-time tracking with multiple schedules[32m 22[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/reminderService.test.ts[2m > [22mReminderService[2m > [22mcalculateNextReminderTime[2m > [22mshould exclude time when calculating next one-time reminder[32m 8[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/reminderService.test.ts[2m > [22mReminderService[2m > [22mcalculateNextReminderTime[2m > [22mshould calculate next reminder time for DAY_OF_WEEK pattern[32m 7[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/reminderService.test.ts[2m > [22mReminderService[2m > [22mcalculateNextReminderTime[2m > [22mshould calculate next reminder time for DAY_OF_MONTH pattern with day_number[32m 3[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/reminderService.test.ts[2m > [22mReminderService[2m > [22mcalculateNextReminderTime[2m > [22mshould calculate next reminder time for DAY_OF_MONTH pattern with last_day[32m 4[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/reminderService.test.ts[2m > [22mReminderService[2m > [22mcalculateNextReminderTime[2m > [22mshould calculate next reminder time for DAY_OF_YEAR pattern[32m 5[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/reminderService.test.ts[2m > [22mReminderService[2m > [22msendReminderNotifications[2m > [22mshould send email notification when user has Email channel selected[32m 4[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/reminderService.test.ts[2m > [22mReminderService[2m > [22msendReminderNotifications[2m > [22mshould send Telegram notification when user has Telegram channel selected[32m 4[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/reminderService.test.ts[2m > [22mReminderService[2m > [22msendReminderNotifications[2m > [22mshould default to Email when notification channel is not set[32m 5[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/reminderService.test.ts[2m > [22mReminderService[2m > [22msendReminderNotifications[2m > [22mshould only send to selected channel (not both)[32m 9[2mms[22m[39m
[90mstderr[2m | backend/src/routes/__tests__/admin.test.ts[2m > [22m[2mAdmin Routes[2m > [22m[2mGET /api/admin[2m > [22m[2mshould return 500 when getAllReminders throws error
[22m[39m[2026-01-15T18:50:46.651Z] ADMIN_CONTROLLER | Error generating admin log: Error: Reminders query error
    at Database.<anonymous> (D:/Code/habitus/backend/src/routes/__tests__/admin.test.ts:587:17)
    at Database.all [90m(file:///D:/Code/habitus/[39mnode_modules/[4m@vitest/spy[24m/dist/index.js:280:34[90m)[39m
    at AdminController.getAllReminders (D:/Code/habitus/backend/src/routes/admin/admin.ts:183:27)
    at AdminController.generateAdminLog (D:/Code/habitus/backend/src/routes/admin/admin.ts:220:34)
    at AdminController.getAdminLog (D:/Code/habitus/backend/src/routes/admin/admin.ts:435:19)
    at D:/Code/habitus/backend/src/routes/admin/admin.ts:531:3

 [32mâœ“[39m backend/src/routes/__tests__/trackings.test.ts[2m > [22mTrackings Routes[2m > [22mPATCH /api/trackings/:id/state[2m > [22mshould update tracking state from Paused to Running[32m 10[2mms[22m[39m
 [32mâœ“[39m backend/src/routes/__tests__/trackings.test.ts[2m > [22mTrackings Routes[2m > [22mPATCH /api/trackings/:id/state[2m > [22mshould update tracking state from Paused to Archived[32m 10[2mms[22m[39m
 [32mâœ“[39m backend/src/routes/__tests__/trackings.test.ts[2m > [22mTrackings Routes[2m > [22mPATCH /api/trackings/:id/state[2m > [22mshould return 400 for same state transition[32m 11[2mms[22m[39m
 [32mâœ“[39m backend/src/routes/__tests__/trackings.test.ts[2m > [22mTrackings Routes[2m > [22mPATCH /api/trackings/:id/state[2m > [22mshould return 400 when state is missing[32m 9[2mms[22m[39m
 [32mâœ“[39m backend/src/routes/__tests__/trackings.test.ts[2m > [22mTrackings Routes[2m > [22mPATCH /api/trackings/:id/state[2m > [22mshould return 400 for invalid state value[32m 9[2mms[22m[39m
 [32mâœ“[39m backend/src/routes/__tests__/trackings.test.ts[2m > [22mTrackings Routes[2m > [22mPATCH /api/trackings/:id/state[2m > [22mshould return 404 for non-existent tracking[32m 10[2mms[22m[39m
 [32mâœ“[39m backend/src/routes/__tests__/trackings.test.ts[2m > [22mTrackings Routes[2m > [22mPATCH /api/trackings/:id/state[2m > [22mshould return 400 for invalid tracking ID[32m 11[2mms[22m[39m
 [32mâœ“[39m backend/src/routes/__tests__/trackings.test.ts[2m > [22mTrackings Routes[2m > [22mPOST /api/trackings/suggest-emoji[2m > [22mshould suggest emoji for valid question[32m 9[2mms[22m[39m
 [32mâœ“[39m backend/src/routes/__tests__/trackings.test.ts[2m > [22mTrackings Routes[2m > [22mPOST /api/trackings/suggest-emoji[2m > [22mshould return 400 when question is missing[32m 9[2mms[22m[39m
 [32mâœ“[39m backend/src/routes/__tests__/trackings.test.ts[2m > [22mTrackings Routes[2m > [22mPOST /api/trackings/suggest-emoji[2m > [22mshould return 400 when question is empty string[32m 8[2mms[22m[39m
 [32mâœ“[39m backend/src/routes/__tests__/trackings.test.ts[2m > [22mTrackings Routes[2m > [22mPOST /api/trackings/suggest-emoji[2m > [22mshould return 400 when question is only whitespace[32m 10[2mms[22m[39m
[90mstderr[2m | backend/src/routes/__tests__/admin.test.ts[2m > [22m[2mAdmin Routes[2m > [22m[2mPOST /api/admin/clear-db[2m > [22m[2mshould return 500 when database operation fails
[22m[39m[2026-01-15T18:50:46.674Z] ADMIN_CONTROLLER | Error clearing database: Error: Database error
    at D:/Code/habitus/backend/src/routes/__tests__/admin.test.ts:669:40
    at [90mfile:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
    at [90mfile:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:919:26
    at [90mfile:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1244:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1210:10[90m)[39m
    at [90mfile:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1654:37
    at Traces.$ [90m(file:///D:/Code/habitus/[39mnode_modules/[4mvitest[24m/dist/chunks/traces.U4xDYhzZ.js:115:27[90m)[39m
    at trace [90m(file:///D:/Code/habitus/[39mnode_modules/[4mvitest[24m/dist/chunks/test.DqQZzsWf.js:234:21[90m)[39m
    at runTest [90m(file:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1654:12[90m)[39m

[90mstderr[2m | backend/src/routes/__tests__/trackings.test.ts[2m > [22m[2mTrackings Routes[2m > [22m[2mPOST /api/trackings/suggest-emoji[2m > [22m[2mshould return 503 when API key is not configured
[22m[39m[2026-01-15T18:50:46.675Z] TRACKING_ROUTE | Error suggesting emoji: Error: Perplexity API key is not configured
    at AiService.suggestEmoji (D:/Code/habitus/backend/src/services/aiService.ts:49:13)
    at D:/Code/habitus/backend/src/routes/trackings.ts:296:37
    at Layer.handle [as handle_request] [90m(D:\Code\habitus\[39mnode_modules\[4mexpress[24m\lib\router\layer.js:95:5[90m)[39m
    at next [90m(D:\Code\habitus\[39mnode_modules\[4mexpress[24m\lib\router\route.js:149:13[90m)[39m
    at D:/Code/habitus/backend/src/routes/__tests__/trackings.test.ts:165:9
    at Mock [90m(file:///D:/Code/habitus/[39mnode_modules/[4m@vitest/spy[24m/dist/index.js:280:34[90m)[39m
    at Layer.handle [as handle_request] [90m(D:\Code\habitus\[39mnode_modules\[4mexpress[24m\lib\router\layer.js:95:5[90m)[39m
    at next [90m(D:\Code\habitus\[39mnode_modules\[4mexpress[24m\lib\router\route.js:149:13[90m)[39m
    at Route.dispatch [90m(D:\Code\habitus\[39mnode_modules\[4mexpress[24m\lib\router\route.js:119:3[90m)[39m
    at Layer.handle [as handle_request] [90m(D:\Code\habitus\[39mnode_modules\[4mexpress[24m\lib\router\layer.js:95:5[90m)[39m

[90mstderr[2m | backend/src/routes/__tests__/trackings.test.ts[2m > [22m[2mTrackings Routes[2m > [22m[2mPOST /api/trackings/suggest-emoji[2m > [22m[2mshould return 500 when AI service throws generic error
[22m[39m[2026-01-15T18:50:46.685Z] TRACKING_ROUTE | Error suggesting emoji: Error: API error
    at D:/Code/habitus/backend/src/routes/__tests__/trackings.test.ts:852:49
    at [90mfile:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
    at [90mfile:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:919:26
    at [90mfile:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1244:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1210:10[90m)[39m
    at [90mfile:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1654:37
    at Traces.$ [90m(file:///D:/Code/habitus/[39mnode_modules/[4mvitest[24m/dist/chunks/traces.U4xDYhzZ.js:115:27[90m)[39m
    at trace [90m(file:///D:/Code/habitus/[39mnode_modules/[4mvitest[24m/dist/chunks/test.DqQZzsWf.js:234:21[90m)[39m
    at runTest [90m(file:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1654:12[90m)[39m

[90mstderr[2m | backend/src/routes/__tests__/trackings.test.ts[2m > [22m[2mTrackings Routes[2m > [22m[2mPOST /api/trackings/suggest-emoji[2m > [22m[2mshould return 500 when AI service throws non-Error
[22m[39m[2026-01-15T18:50:46.694Z] TRACKING_ROUTE | Error suggesting emoji: String error

[90mstderr[2m | backend/src/routes/__tests__/admin.test.ts[2m > [22m[2mAdmin Routes[2m > [22m[2mPOST /api/admin/clear-db[2m > [22m[2mshould handle error when deleting reminders fails
[22m[39m[2026-01-15T18:50:46.695Z] ADMIN_CONTROLLER | Error clearing database: Error: Failed to delete reminders
    at Database.<anonymous> (D:/Code/habitus/backend/src/routes/__tests__/admin.test.ts:695:17)
    at Database.run [90m(file:///D:/Code/habitus/[39mnode_modules/[4m@vitest/spy[24m/dist/index.js:280:34[90m)[39m
    at AdminController.clearDatabase (D:/Code/habitus/backend/src/routes/admin/admin.ts:459:16)
    at D:/Code/habitus/backend/src/routes/admin/admin.ts:546:27
    at Layer.handle [as handle_request] [90m(D:\Code\habitus\[39mnode_modules\[4mexpress[24m\lib\router\layer.js:95:5[90m)[39m
    at next [90m(D:\Code\habitus\[39mnode_modules\[4mexpress[24m\lib\router\route.js:149:13[90m)[39m
    at D:/Code/habitus/backend/src/routes/__tests__/admin.test.ts:151:9
    at Mock [90m(file:///D:/Code/habitus/[39mnode_modules/[4m@vitest/spy[24m/dist/index.js:280:34[90m)[39m
    at Layer.handle [as handle_request] [90m(D:\Code\habitus\[39mnode_modules\[4mexpress[24m\lib\router\layer.js:95:5[90m)[39m
    at next [90m(D:\Code\habitus\[39mnode_modules\[4mexpress[24m\lib\router\route.js:149:13[90m)[39m

 [32mâœ“[39m backend/src/routes/__tests__/trackings.test.ts[2m > [22mTrackings Routes[2m > [22mPOST /api/trackings/suggest-emoji[2m > [22mshould return 400 when question is not a string[32m 17[2mms[22m[39m
 [32mâœ“[39m backend/src/routes/__tests__/trackings.test.ts[2m > [22mTrackings Routes[2m > [22mPOST /api/trackings/suggest-emoji[2m > [22mshould return 503 when API key is not configured[32m 10[2mms[22m[39m
 [32mâœ“[39m backend/src/routes/__tests__/trackings.test.ts[2m > [22mTrackings Routes[2m > [22mPOST /api/trackings/suggest-emoji[2m > [22mshould return 500 when AI service throws generic error[32m 10[2mms[22m[39m
 [32mâœ“[39m backend/src/routes/__tests__/trackings.test.ts[2m > [22mTrackings Routes[2m > [22mPOST /api/trackings/suggest-emoji[2m > [22mshould return 500 when AI service throws non-Error[32m 9[2mms[22m[39m
 [32mâœ“[39m backend/src/routes/__tests__/trackings.test.ts[2m > [22mTrackings Routes[2m > [22mPOST /api/trackings/suggest-emoji[2m > [22mshould trim question before sending to AI service[32m 11[2mms[22m[39m
[90mstderr[2m | backend/src/routes/__tests__/admin.test.ts[2m > [22m[2mAdmin Routes[2m > [22m[2mPOST /api/admin/clear-db[2m > [22m[2mshould handle error when deleting schedules fails
[22m[39m[2026-01-15T18:50:46.711Z] ADMIN_CONTROLLER | Error clearing database: Error: Failed to delete schedules
    at Database.<anonymous> (D:/Code/habitus/backend/src/routes/__tests__/admin.test.ts:716:17)
    at Database.run [90m(file:///D:/Code/habitus/[39mnode_modules/[4m@vitest/spy[24m/dist/index.js:280:34[90m)[39m
    at AdminController.clearDatabase (D:/Code/habitus/backend/src/routes/admin/admin.ts:460:16)
    at D:/Code/habitus/backend/src/routes/admin/admin.ts:546:5

 [32mâœ“[39m backend/src/services/__tests__/reminderService.test.ts[2m > [22mReminderService[2m > [22msendReminderNotifications[2m > [22mshould not send Telegram notification when Telegram channel is selected but chat ID is missing[32m 4[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/reminderService.test.ts[2m > [22mReminderService[2m > [22mprocessExpiredReminders[2m > [22mshould update expired upcoming reminders to Pending status[32m 8[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/reminderService.test.ts[2m > [22mReminderService[2m > [22mprocessExpiredReminders[2m > [22mshould not update non-expired upcoming reminders[32m 11[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/reminderService.test.ts[2m > [22mReminderService[2m > [22mprocessExpiredReminders[2m > [22mshould handle multiple expired reminders[32m 37[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/reminderService.test.ts[2m > [22mReminderService[2m > [22mprocessExpiredReminders[2m > [22mshould handle empty result when no expired reminders exist[32m 5[2mms[22m[39m
[90mstderr[2m | backend/src/routes/__tests__/admin.test.ts[2m > [22m[2mAdmin Routes[2m > [22m[2mPOST /api/admin/clear-db[2m > [22m[2mshould handle error when deleting trackings fails
[22m[39m[2026-01-15T18:50:46.722Z] ADMIN_CONTROLLER | Error clearing database: Error: Failed to delete trackings
    at Database.<anonymous> (D:/Code/habitus/backend/src/routes/__tests__/admin.test.ts:737:17)
    at Database.run [90m(file:///D:/Code/habitus/[39mnode_modules/[4m@vitest/spy[24m/dist/index.js:280:34[90m)[39m
    at AdminController.clearDatabase (D:/Code/habitus/backend/src/routes/admin/admin.ts:461:16)
    at D:/Code/habitus/backend/src/routes/admin/admin.ts:546:5

[90mstderr[2m | backend/src/routes/__tests__/admin.test.ts[2m > [22m[2mAdmin Routes[2m > [22m[2mPOST /api/admin/clear-db[2m > [22m[2mshould handle error when deleting users fails
[22m[39m[2026-01-15T18:50:46.734Z] ADMIN_CONTROLLER | Error clearing database: Error: Failed to delete users
    at Database.<anonymous> (D:/Code/habitus/backend/src/routes/__tests__/admin.test.ts:758:17)
    at Database.run [90m(file:///D:/Code/habitus/[39mnode_modules/[4m@vitest/spy[24m/dist/index.js:280:34[90m)[39m
    at AdminController.clearDatabase (D:/Code/habitus/backend/src/routes/admin/admin.ts:462:16)
    at D:/Code/habitus/backend/src/routes/admin/admin.ts:546:5

 [32mâœ“[39m backend/src/services/__tests__/trackingService.test.ts[2m > [22mTrackingService[2m > [22mupdateTracking[2m > [22mshould throw error when updating tracking belonging to different user[32m 6[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/trackingService.test.ts[2m > [22mTrackingService[2m > [22mupdateTracking[2m > [22mshould throw error when no fields to update[32m 8[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/trackingService.test.ts[2m > [22mTrackingService[2m > [22mupdateTracking[2m > [22mshould update or create Upcoming reminder when schedules change and tracking is Running[32m 11[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/trackingService.test.ts[2m > [22mTrackingService[2m > [22mupdateTracking[2m > [22mshould create Upcoming reminder when schedules change and no Upcoming exists[32m 6[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/trackingService.test.ts[2m > [22mTrackingService[2m > [22mupdateTracking[2m > [22mshould update Upcoming reminder when frequency pattern changes and tracking is Running[32m 6[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/trackingService.test.ts[2m > [22mTrackingService[2m > [22mupdateTracking[2m > [22mshould convert recurring tracking to one-time with frequency[32m 7[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/trackingService.test.ts[2m > [22mTrackingService[2m > [22mupdateTracking[2m > [22mshould convert one-time tracking to recurring[32m 22[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/trackingService.test.ts[2m > [22mTrackingService[2m > [22mdeleteTracking[2m > [22mshould delete tracking[32m 7[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/trackingService.test.ts[2m > [22mTrackingService[2m > [22mdeleteTracking[2m > [22mshould throw error when tracking not found[32m 3[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/trackingService.test.ts[2m > [22mTrackingService[2m > [22mdeleteTracking[2m > [22mshould throw error when deleting tracking belonging to different user[32m 5[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/trackingService.test.ts[2m > [22mTrackingService[2m > [22mupdateTrackingState[2m > [22mshould update tracking state from Running to Paused[32m 5[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/trackingService.test.ts[2m > [22mTrackingService[2m > [22mupdateTrackingState[2m > [22mshould update tracking state from Paused to Running[32m 8[2mms[22m[39m
 [32mâœ“[39m backend/src/routes/__tests__/admin.test.ts[2m > [22mAdmin Routes[2m > [22mGET /api/admin[2m > [22mshould return 500 when getAllReminders throws error[32m 10[2mms[22m[39m
 [32mâœ“[39m backend/src/routes/__tests__/admin.test.ts[2m > [22mAdmin Routes[2m > [22mPOST /api/admin/clear-db[2m > [22mshould clear all data from database[32m 11[2mms[22m[39m
 [32mâœ“[39m backend/src/routes/__tests__/admin.test.ts[2m > [22mAdmin Routes[2m > [22mPOST /api/admin/clear-db[2m > [22mshould return 500 when database operation fails[32m 11[2mms[22m[39m
 [32mâœ“[39m backend/src/routes/__tests__/admin.test.ts[2m > [22mAdmin Routes[2m > [22mPOST /api/admin/clear-db[2m > [22mshould handle error when deleting reminders fails[32m 23[2mms[22m[39m
 [32mâœ“[39m backend/src/routes/__tests__/admin.test.ts[2m > [22mAdmin Routes[2m > [22mPOST /api/admin/clear-db[2m > [22mshould handle error when deleting schedules fails[32m 14[2mms[22m[39m
 [32mâœ“[39m backend/src/routes/__tests__/admin.test.ts[2m > [22mAdmin Routes[2m > [22mPOST /api/admin/clear-db[2m > [22mshould handle error when deleting trackings fails[32m 11[2mms[22m[39m
 [32mâœ“[39m backend/src/routes/__tests__/admin.test.ts[2m > [22mAdmin Routes[2m > [22mPOST /api/admin/clear-db[2m > [22mshould handle error when deleting users fails[32m 11[2mms[22m[39m
 [32mâœ“[39m backend/src/routes/__tests__/auth.test.ts[2m > [22mAuth Routes[2m > [22mGET /api/auth/me[2m > [22mshould return 500 for generic error[32m 12[2mms[22m[39m
 [32mâœ“[39m backend/src/routes/__tests__/auth.test.ts[2m > [22mAuth Routes[2m > [22mPOST /api/auth/change-email[2m > [22mshould request email change successfully[32m 31[2mms[22m[39m
 [32mâœ“[39m backend/src/routes/__tests__/auth.test.ts[2m > [22mAuth Routes[2m > [22mPOST /api/auth/change-email[2m > [22mshould return 400 for missing email[32m 10[2mms[22m[39m
 [32mâœ“[39m backend/src/routes/__tests__/auth.test.ts[2m > [22mAuth Routes[2m > [22mPOST /api/auth/change-email[2m > [22mshould return 400 for invalid email format[32m 14[2mms[22m[39m
 [32mâœ“[39m backend/src/routes/__tests__/auth.test.ts[2m > [22mAuth Routes[2m > [22mPOST /api/auth/change-email[2m > [22mshould return 400 if new email is same as current email[32m 9[2mms[22m[39m
 [32mâœ“[39m backend/src/routes/__tests__/auth.test.ts[2m > [22mAuth Routes[2m > [22mPOST /api/auth/change-email[2m > [22mshould return 400 if email is already registered[32m 10[2mms[22m[39m
 [32mâœ“[39m backend/src/routes/__tests__/auth.test.ts[2m > [22mAuth Routes[2m > [22mPOST /api/auth/change-email[2m > [22mshould return 401 for missing authorization[32m 9[2mms[22m[39m
 [32mâœ“[39m backend/src/routes/__tests__/admin.test.ts[2m > [22mAdmin Routes[2m > [22mPOST /api/admin/clear-db[2m > [22mshould clear empty database successfully[32m 15[2mms[22m[39m
[90mstderr[2m | backend/src/routes/__tests__/auth.test.ts[2m > [22m[2mAuth Routes[2m > [22m[2mPOST /api/auth/change-email[2m > [22m[2mshould return 500 for generic error
[22m[39m[2026-01-15T18:50:46.765Z] AUTH_ROUTE | Error requesting email change: Error: Database connection failed
    at D:/Code/habitus/backend/src/routes/__tests__/auth.test.ts:848:30
    at [90mfile:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
    at [90mfile:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:919:26
    at [90mfile:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1244:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1210:10[90m)[39m
    at [90mfile:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1654:37
    at Traces.$ [90m(file:///D:/Code/habitus/[39mnode_modules/[4mvitest[24m/dist/chunks/traces.U4xDYhzZ.js:115:27[90m)[39m
    at trace [90m(file:///D:/Code/habitus/[39mnode_modules/[4mvitest[24m/dist/chunks/test.DqQZzsWf.js:234:21[90m)[39m
    at runTest [90m(file:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1654:12[90m)[39m

 [32mâœ“[39m backend/src/services/__tests__/trackingService.test.ts[2m > [22mTrackingService[2m > [22mupdateTrackingState[2m > [22mshould update tracking state from Paused to Archived[32m 9[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/trackingService.test.ts[2m > [22mTrackingService[2m > [22mupdateTrackingState[2m > [22mshould throw error for same state transition[32m 7[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/trackingService.test.ts[2m > [22mTrackingService[2m > [22mupdateTrackingState[2m > [22mshould throw error when tracking not found[32m 8[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/trackingService.test.ts[2m > [22mTrackingService[2m > [22mupdateTrackingState[2m > [22mshould throw error for tracking belonging to different user[32m 5[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/trackingService.test.ts[2m > [22mTrackingService[2m > [22mupdateTrackingState[2m > [22mshould throw error for invalid state value[32m 3[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/trackingService.test.ts[2m > [22mTrackingService[2m > [22mupdateTrackingState[2m > [22mshould delete Pending and Upcoming reminders when archiving[32m 12[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/trackingService.test.ts[2m > [22mTrackingService[2m > [22mupdateTrackingState[2m > [22mshould delete Upcoming reminders when pausing[32m 8[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/trackingService.test.ts[2m > [22mTrackingService[2m > [22mupdateTrackingState[2m > [22mshould create next reminder when resuming from Paused[32m 7[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/trackingService.test.ts[2m > [22mTrackingService[2m > [22mupdateTrackingState[2m > [22mshould create next reminder when unarchiving from Archived[32m 8[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/trackingService.test.ts[2m > [22mTrackingService[2m > [22mupdateTrackingState[2m > [22mshould delete Pending and Upcoming reminders when transitioning from Running to Archived[32m 5[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/trackingService.test.ts[2m > [22mTrackingService[2m > [22mupdateTrackingState[2m > [22mshould delete Pending and Upcoming reminders when transitioning from Paused to Archived[32m 5[2mms[22m[39m
[90mstderr[2m | backend/src/routes/__tests__/auth.test.ts[2m > [22m[2mAuth Routes[2m > [22m[2mGET /api/auth/verify-email-change[2m > [22m[2mshould redirect with error for generic 500 error
[22m[39m[2026-01-15T18:50:46.844Z] AUTH_ROUTE | Error verifying email change: Error: Database connection failed
    at D:/Code/habitus/backend/src/routes/__tests__/auth.test.ts:996:30
    at [90mfile:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
    at [90mfile:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:919:26
    at [90mfile:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1244:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1210:10[90m)[39m
    at [90mfile:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1654:37
    at Traces.$ [90m(file:///D:/Code/habitus/[39mnode_modules/[4mvitest[24m/dist/chunks/traces.U4xDYhzZ.js:115:27[90m)[39m
    at trace [90m(file:///D:/Code/habitus/[39mnode_modules/[4mvitest[24m/dist/chunks/test.DqQZzsWf.js:234:21[90m)[39m
    at runTest [90m(file:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1654:12[90m)[39m

 [32mâœ“[39m backend/src/routes/__tests__/auth.test.ts[2m > [22mAuth Routes[2m > [22mPOST /api/auth/change-email[2m > [22mshould return 400 for TypeError[32m 15[2mms[22m[39m
 [32mâœ“[39m backend/src/routes/__tests__/auth.test.ts[2m > [22mAuth Routes[2m > [22mPOST /api/auth/change-email[2m > [22mshould return 400 for cooldown error[32m 9[2mms[22m[39m
 [32mâœ“[39m backend/src/routes/__tests__/auth.test.ts[2m > [22mAuth Routes[2m > [22mPOST /api/auth/change-email[2m > [22mshould return 500 for generic error[32m 15[2mms[22m[39m
 [32mâœ“[39m backend/src/routes/__tests__/auth.test.ts[2m > [22mAuth Routes[2m > [22mGET /api/auth/verify-email-change[2m > [22mshould verify email change and redirect with success[32m 14[2mms[22m[39m
 [32mâœ“[39m backend/src/routes/__tests__/auth.test.ts[2m > [22mAuth Routes[2m > [22mGET /api/auth/verify-email-change[2m > [22mshould handle URL-encoded error messages correctly[32m 8[2mms[22m[39m
 [32mâœ“[39m backend/src/routes/__tests__/auth.test.ts[2m > [22mAuth Routes[2m > [22mGET /api/auth/verify-email-change[2m > [22mshould redirect with error for missing token[32m 7[2mms[22m[39m
 [32mâœ“[39m backend/src/routes/__tests__/auth.test.ts[2m > [22mAuth Routes[2m > [22mGET /api/auth/verify-email-change[2m > [22mshould redirect with error for invalid token[32m 7[2mms[22m[39m
 [32mâœ“[39m backend/src/routes/__tests__/auth.test.ts[2m > [22mAuth Routes[2m > [22mGET /api/auth/verify-email-change[2m > [22mshould redirect with error for expired token[32m 8[2mms[22m[39m
 [32mâœ“[39m backend/src/routes/__tests__/auth.test.ts[2m > [22mAuth Routes[2m > [22mGET /api/auth/verify-email-change[2m > [22mshould redirect with error if email is already taken[32m 12[2mms[22m[39m
 [32mâœ“[39m backend/src/routes/__tests__/auth.test.ts[2m > [22mAuth Routes[2m > [22mGET /api/auth/verify-email-change[2m > [22mshould redirect with error for 'Failed to retrieve' error[32m 10[2mms[22m[39m
 [32mâœ“[39m backend/src/routes/__tests__/auth.test.ts[2m > [22mAuth Routes[2m > [22mGET /api/auth/verify-email-change[2m > [22mshould redirect with error for generic 500 error[32m 8[2mms[22m[39m
 [32mâœ“[39m backend/src/models/__tests__/TrackingSchedule.test.ts[2m > [22mTrackingSchedule Model[2m > [22mconstructor[2m > [22mshould create TrackingSchedule instance with provided data[32m 6[2mms[22m[39m
 [32mâœ“[39m backend/src/models/__tests__/TrackingSchedule.test.ts[2m > [22mTrackingSchedule Model[2m > [22mconstructor[2m > [22mshould create TrackingSchedule instance with minimal data[32m 2[2mms[22m[39m
 [32mâœ“[39m backend/src/models/__tests__/TrackingSchedule.test.ts[2m > [22mTrackingSchedule Model[2m > [22mvalidate[2m > [22mshould validate valid schedule[32m 3[2mms[22m[39m
 [32mâœ“[39m backend/src/models/__tests__/TrackingSchedule.test.ts[2m > [22mTrackingSchedule Model[2m > [22mvalidate[2m > [22mshould throw error for invalid hour (too low)[32m 5[2mms[22m[39m
 [32mâœ“[39m backend/src/models/__tests__/TrackingSchedule.test.ts[2m > [22mTrackingSchedule Model[2m > [22mvalidate[2m > [22mshould throw error for invalid hour (too high)[32m 4[2mms[22m[39m
 [32mâœ“[39m backend/src/models/__tests__/TrackingSchedule.test.ts[2m > [22mTrackingSchedule Model[2m > [22mvalidate[2m > [22mshould throw error for invalid minutes (too low)[32m 7[2mms[22m[39m
 [32mâœ“[39m backend/src/models/__tests__/TrackingSchedule.test.ts[2m > [22mTrackingSchedule Model[2m > [22mvalidate[2m > [22mshould throw error for invalid minutes (too high)[32m 3[2mms[22m[39m
 [32mâœ“[39m backend/src/models/__tests__/TrackingSchedule.test.ts[2m > [22mTrackingSchedule Model[2m > [22msave[2m > [22mshould create new schedule when id is not set[32m 3[2mms[22m[39m
 [32mâœ“[39m backend/src/models/__tests__/TrackingSchedule.test.ts[2m > [22mTrackingSchedule Model[2m > [22msave[2m > [22mshould update existing schedule when id is set[32m 3[2mms[22m[39m
 [32mâœ“[39m backend/src/models/__tests__/TrackingSchedule.test.ts[2m > [22mTrackingSchedule Model[2m > [22msave[2m > [22mshould throw error if validation fails[32m 4[2mms[22m[39m
 [32mâœ“[39m backend/src/models/__tests__/TrackingSchedule.test.ts[2m > [22mTrackingSchedule Model[2m > [22mdelete[2m > [22mshould delete schedule from database[32m 2[2mms[22m[39m
 [32mâœ“[39m backend/src/models/__tests__/TrackingSchedule.test.ts[2m > [22mTrackingSchedule Model[2m > [22mdelete[2m > [22mshould throw error if schedule has no id[32m 2[2mms[22m[39m
 [32mâœ“[39m backend/src/models/__tests__/TrackingSchedule.test.ts[2m > [22mTrackingSchedule Model[2m > [22mdelete[2m > [22mshould throw error if schedule not found[32m 2[2mms[22m[39m
 [32mâœ“[39m backend/src/models/__tests__/TrackingSchedule.test.ts[2m > [22mTrackingSchedule Model[2m > [22mloadByTrackingId[2m > [22mshould load all schedules for a tracking[32m 3[2mms[22m[39m
 [32mâœ“[39m backend/src/models/__tests__/TrackingSchedule.test.ts[2m > [22mTrackingSchedule Model[2m > [22mloadByTrackingId[2m > [22mshould return empty array when no schedules exist[32m 3[2mms[22m[39m
 [32mâœ“[39m backend/src/models/__tests__/TrackingSchedule.test.ts[2m > [22mTrackingSchedule Model[2m > [22mloadByTrackingId[2m > [22mshould load schedules with timestamps[32m 3[2mms[22m[39m
 [32mâœ“[39m backend/src/models/__tests__/TrackingSchedule.test.ts[2m > [22mTrackingSchedule Model[2m > [22mloadByTrackingId[2m > [22mshould only load schedules for the specified tracking[32m 3[2mms[22m[39m
 [32mâœ“[39m backend/src/models/__tests__/TrackingSchedule.test.ts[2m > [22mTrackingSchedule Model[2m > [22mtoData[2m > [22mshould convert schedule instance to data object[32m 2[2mms[22m[39m
 [32mâœ“[39m backend/src/models/__tests__/TrackingSchedule.test.ts[2m > [22mTrackingSchedule Model[2m > [22mtoData[2m > [22mshould convert schedule without timestamps to data object[32m 2[2mms[22m[39m
 [32mâœ“[39m backend/src/routes/__tests__/telegram.test.ts[2m > [22mTelegram Webhook Routes[2m > [22mPOST /api/telegram/webhook[2m > [22mshould handle /start command with valid token and update user telegram_chat_id[32m 206[2mms[22m[39m
[90mstderr[2m | backend/src/middleware/__tests__/authMiddleware.test.ts[2m > [22m[2mauthMiddleware[2m > [22m[2mauthenticateToken[2m > [22m[2mshould return 500 for non-token errors
[22m[39m[2026-01-15T18:50:46.905Z] AUTH_MIDDLEWARE | Authentication error on /test: Error: Database error
    at D:/Code/habitus/backend/src/middleware/__tests__/authMiddleware.test.ts:188:9
    at [90mfile:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
    at [90mfile:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:919:26
    at [90mfile:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1244:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1210:10[90m)[39m
    at [90mfile:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1654:37
    at Traces.$ [90m(file:///D:/Code/habitus/[39mnode_modules/[4mvitest[24m/dist/chunks/traces.U4xDYhzZ.js:115:27[90m)[39m
    at trace [90m(file:///D:/Code/habitus/[39mnode_modules/[4mvitest[24m/dist/chunks/test.DqQZzsWf.js:234:21[90m)[39m
    at runTest [90m(file:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1654:12[90m)[39m

 [32mâœ“[39m backend/src/models/__tests__/Reminder.test.ts[2m > [22mReminder Model[2m > [22mconstructor[2m > [22mshould create Reminder instance with provided data[32m 5[2mms[22m[39m
 [32mâœ“[39m backend/src/models/__tests__/Reminder.test.ts[2m > [22mReminder Model[2m > [22mconstructor[2m > [22mshould create Reminder instance with minimal data[32m 3[2mms[22m[39m
 [32mâœ“[39m backend/src/models/__tests__/Reminder.test.ts[2m > [22mReminder Model[2m > [22mvalidate[2m > [22mshould validate and normalize reminder fields[32m 2[2mms[22m[39m
 [32mâœ“[39m backend/src/models/__tests__/Reminder.test.ts[2m > [22mReminder Model[2m > [22mvalidate[2m > [22mshould throw error for invalid scheduled_time[32m 2[2mms[22m[39m
 [32mâœ“[39m backend/src/models/__tests__/Reminder.test.ts[2m > [22mReminder Model[2m > [22mvalidate[2m > [22mshould throw error for invalid status[32m 3[2mms[22m[39m
 [32mâœ“[39m backend/src/models/__tests__/Reminder.test.ts[2m > [22mReminder Model[2m > [22mvalidate - value and status relationship[2m > [22mshould set value to null for PENDING status[32m 3[2mms[22m[39m
 [32mâœ“[39m backend/src/models/__tests__/Reminder.test.ts[2m > [22mReminder Model[2m > [22mvalidate - value and status relationship[2m > [22mshould set value to null for UPCOMING status[32m 2[2mms[22m[39m
 [32mâœ“[39m backend/src/models/__tests__/Reminder.test.ts[2m > [22mReminder Model[2m > [22mvalidate - value and status relationship[2m > [22mshould require value for ANSWERED status[32m 3[2mms[22m[39m
 [32mâœ“[39m backend/src/models/__tests__/Reminder.test.ts[2m > [22mReminder Model[2m > [22mvalidate - value and status relationship[2m > [22mshould throw error if value is null when status is ANSWERED[32m 3[2mms[22m[39m
 [32mâœ“[39m backend/src/models/__tests__/Reminder.test.ts[2m > [22mReminder Model[2m > [22mvalidate - value and status relationship[2m > [22mshould throw error if value is set when status is PENDING[32m 3[2mms[22m[39m
 [32mâœ“[39m backend/src/models/__tests__/Reminder.test.ts[2m > [22mReminder Model[2m > [22mvalidate - value and status relationship[2m > [22mshould throw error if value is set when status is UPCOMING[32m 3[2mms[22m[39m
 [32mâœ“[39m backend/src/models/__tests__/Reminder.test.ts[2m > [22mReminder Model[2m > [22mconstructor - default value[2m > [22mshould set value to null by default for new reminders[32m 2[2mms[22m[39m
 [32mâœ“[39m backend/src/models/__tests__/Reminder.test.ts[2m > [22mReminder Model[2m > [22msave[2m > [22mshould create new reminder when id is not set[32m 3[2mms[22m[39m
 [32mâœ“[39m backend/src/models/__tests__/Reminder.test.ts[2m > [22mReminder Model[2m > [22msave[2m > [22mshould update existing reminder when id is set[32m 3[2mms[22m[39m
 [32mâœ“[39m backend/src/models/__tests__/Reminder.test.ts[2m > [22mReminder Model[2m > [22mloadById[2m > [22mshould load reminder by ID[32m 3[2mms[22m[39m
 [32mâœ“[39m backend/src/models/__tests__/Reminder.test.ts[2m > [22mReminder Model[2m > [22mloadById[2m > [22mshould return null if reminder not found[32m 2[2mms[22m[39m
 [32mâœ“[39m backend/src/models/__tests__/Reminder.test.ts[2m > [22mReminder Model[2m > [22mloadByUserId[2m > [22mshould load all reminders for a user[32m 4[2mms[22m[39m
 [32mâœ“[39m backend/src/models/__tests__/Reminder.test.ts[2m > [22mReminder Model[2m > [22mloadActiveByUserId[2m > [22mshould load only active reminders (excludes Answered)[32m 4[2mms[22m[39m
 [32mâœ“[39m backend/src/models/__tests__/Reminder.test.ts[2m > [22mReminder Model[2m > [22mloadByTrackingId[2m > [22mshould load reminder by tracking ID[32m 2[2mms[22m[39m
 [32mâœ“[39m backend/src/models/__tests__/Reminder.test.ts[2m > [22mReminder Model[2m > [22mloadByTrackingId[2m > [22mshould return null if no reminder found for tracking[32m 2[2mms[22m[39m
 [32mâœ“[39m backend/src/models/__tests__/Reminder.test.ts[2m > [22mReminder Model[2m > [22mloadByTrackingId[2m > [22mshould throw error for invalid value[32m 2[2mms[22m[39m
 [32mâœ“[39m backend/src/models/__tests__/Reminder.test.ts[2m > [22mReminder Model[2m > [22mloadByTrackingId[2m > [22mshould validate valid value[32m 2[2mms[22m[39m
 [32mâœ“[39m backend/src/models/__tests__/Reminder.test.ts[2m > [22mReminder Model[2m > [22mdelete[2m > [22mshould delete reminder[32m 3[2mms[22m[39m
 [32mâœ“[39m backend/src/models/__tests__/Reminder.test.ts[2m > [22mReminder Model[2m > [22mdelete[2m > [22mshould throw error if reminder not found[32m 4[2mms[22m[39m
[90mstderr[2m | backend/src/middleware/__tests__/authMiddleware.test.ts[2m > [22m[2mauthMiddleware[2m > [22m[2mauthenticateToken[2m > [22m[2mshould not fail request if updateLastAccess fails
[22m[39m[2026-01-15T18:50:46.915Z] AUTH_MIDDLEWARE | Error updating last access for userId 1: Error: Update failed
    at D:/Code/habitus/backend/src/middleware/__tests__/authMiddleware.test.ts:210:9
    at [90mfile:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
    at [90mfile:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:919:26
    at [90mfile:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1244:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1210:10[90m)[39m
    at [90mfile:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1654:37
    at Traces.$ [90m(file:///D:/Code/habitus/[39mnode_modules/[4mvitest[24m/dist/chunks/traces.U4xDYhzZ.js:115:27[90m)[39m
    at trace [90m(file:///D:/Code/habitus/[39mnode_modules/[4mvitest[24m/dist/chunks/test.DqQZzsWf.js:234:21[90m)[39m
    at runTest [90m(file:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1654:12[90m)[39m

[90mstderr[2m | backend/src/middleware/__tests__/authMiddleware.test.ts[2m > [22m[2mauthMiddleware[2m > [22m[2mauthenticateToken[2m > [22m[2mshould handle non-Error objects thrown
[22m[39m[2026-01-15T18:50:46.927Z] AUTH_MIDDLEWARE | Authentication error on /test: String error

[90mstderr[2m | backend/src/middleware/__tests__/authMiddleware.test.ts[2m > [22m[2mauthMiddleware[2m > [22m[2mauthenticateTokenOptional[2m > [22m[2mdevelopment mode[2m > [22m[2mshould not fail request if updateLastAccess fails in development
[22m[39m[2026-01-15T18:50:46.937Z] AUTH_MIDDLEWARE | Error updating last access for userId 1: Error: Update failed
    at D:/Code/habitus/backend/src/middleware/__tests__/authMiddleware.test.ts:404:11
    at [90mfile:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
    at [90mfile:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:919:26
    at [90mfile:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1244:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1210:10[90m)[39m
    at [90mfile:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1654:37
    at Traces.$ [90m(file:///D:/Code/habitus/[39mnode_modules/[4mvitest[24m/dist/chunks/traces.U4xDYhzZ.js:115:27[90m)[39m
    at trace [90m(file:///D:/Code/habitus/[39mnode_modules/[4mvitest[24m/dist/chunks/test.DqQZzsWf.js:234:21[90m)[39m
    at runTest [90m(file:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1654:12[90m)[39m

 [32mâœ“[39m backend/src/middleware/__tests__/authMiddleware.test.ts[2m > [22mauthMiddleware[2m > [22mauthenticateToken[2m > [22mshould authenticate valid token and call next[32m 8[2mms[22m[39m
 [32mâœ“[39m backend/src/middleware/__tests__/authMiddleware.test.ts[2m > [22mauthMiddleware[2m > [22mauthenticateToken[2m > [22mshould return 401 if no authorization header[32m 6[2mms[22m[39m
 [32mâœ“[39m backend/src/middleware/__tests__/authMiddleware.test.ts[2m > [22mauthMiddleware[2m > [22mauthenticateToken[2m > [22mshould return 401 if authorization header does not start with Bearer[32m 3[2mms[22m[39m
 [32mâœ“[39m backend/src/middleware/__tests__/authMiddleware.test.ts[2m > [22mauthMiddleware[2m > [22mauthenticateToken[2m > [22mshould return 401 if token is invalid[32m 2[2mms[22m[39m
 [32mâœ“[39m backend/src/middleware/__tests__/authMiddleware.test.ts[2m > [22mauthMiddleware[2m > [22mauthenticateToken[2m > [22mshould return 500 for non-token errors[32m 8[2mms[22m[39m
 [32mâœ“[39m backend/src/middleware/__tests__/authMiddleware.test.ts[2m > [22mauthMiddleware[2m > [22mauthenticateToken[2m > [22mshould not fail request if updateLastAccess fails[32m 4[2mms[22m[39m
 [32mâœ“[39m backend/src/middleware/__tests__/authMiddleware.test.ts[2m > [22mauthMiddleware[2m > [22mauthenticateToken[2m > [22mshould extract token correctly from Bearer header[32m 2[2mms[22m[39m
 [32mâœ“[39m backend/src/middleware/__tests__/authMiddleware.test.ts[2m > [22mauthMiddleware[2m > [22mauthenticateToken[2m > [22mshould return 401 if Bearer token is empty[32m 4[2mms[22m[39m
 [32mâœ“[39m backend/src/middleware/__tests__/authMiddleware.test.ts[2m > [22mauthMiddleware[2m > [22mauthenticateToken[2m > [22mshould handle token with special characters[32m 2[2mms[22m[39m
 [32mâœ“[39m backend/src/middleware/__tests__/authMiddleware.test.ts[2m > [22mauthMiddleware[2m > [22mauthenticateToken[2m > [22mshould handle error message that includes 'token' substring[32m 2[2mms[22m[39m
 [32mâœ“[39m backend/src/middleware/__tests__/authMiddleware.test.ts[2m > [22mauthMiddleware[2m > [22mauthenticateToken[2m > [22mshould handle non-Error objects thrown[32m 2[2mms[22m[39m
 [32mâœ“[39m backend/src/middleware/__tests__/authMiddleware.test.ts[2m > [22mauthMiddleware[2m > [22mauthenticateTokenOptional[2m > [22mdevelopment mode[2m > [22mshould allow request without token in development[32m 2[2mms[22m[39m
 [32mâœ“[39m backend/src/middleware/__tests__/authMiddleware.test.ts[2m > [22mauthMiddleware[2m > [22mauthenticateTokenOptional[2m > [22mdevelopment mode[2m > [22mshould authenticate valid token in development[32m 2[2mms[22m[39m
 [32mâœ“[39m backend/src/middleware/__tests__/authMiddleware.test.ts[2m > [22mauthMiddleware[2m > [22mauthenticateTokenOptional[2m > [22mdevelopment mode[2m > [22mshould allow request with invalid token in development[32m 2[2mms[22m[39m
 [32mâœ“[39m backend/src/middleware/__tests__/authMiddleware.test.ts[2m > [22mauthMiddleware[2m > [22mauthenticateTokenOptional[2m > [22mdevelopment mode[2m > [22mshould allow request when authorization header does not start with Bearer in development[32m 2[2mms[22m[39m
 [32mâœ“[39m backend/src/middleware/__tests__/authMiddleware.test.ts[2m > [22mauthMiddleware[2m > [22mauthenticateTokenOptional[2m > [22mdevelopment mode[2m > [22mshould not fail request if updateLastAccess fails in development[32m 3[2mms[22m[39m
 [32mâœ“[39m backend/src/middleware/__tests__/authMiddleware.test.ts[2m > [22mauthMiddleware[2m > [22mauthenticateTokenOptional[2m > [22mdevelopment mode[2m > [22mshould handle empty Bearer token in development[32m 3[2mms[22m[39m
 [32mâœ“[39m backend/src/middleware/__tests__/authMiddleware.test.ts[2m > [22mauthMiddleware[2m > [22mauthenticateTokenOptional[2m > [22mproduction mode[2m > [22mshould require authentication in production (delegates to authenticateToken)[32m 2[2mms[22m[39m
 [32mâœ“[39m backend/src/middleware/__tests__/authMiddleware.test.ts[2m > [22mauthMiddleware[2m > [22mauthenticateTokenOptional[2m > [22mproduction mode[2m > [22mshould return 401 if no token in production[32m 2[2mms[22m[39m
 [32mâœ“[39m backend/src/middleware/__tests__/authMiddleware.test.ts[2m > [22mauthMiddleware[2m > [22mauthenticateTokenOptional[2m > [22mproduction mode[2m > [22mshould return 401 if invalid token in production[32m 2[2mms[22m[39m
 [32mâœ“[39m backend/src/middleware/__tests__/authMiddleware.test.ts[2m > [22mauthMiddleware[2m > [22mauthenticateTokenOptional[2m > [22mtest mode[2m > [22mshould allow request without token in test mode[32m 3[2mms[22m[39m
 [32mâœ“[39m backend/src/__tests__/server.test.ts[2m > [22mServer Configuration - Integration Tests[2m > [22mServer.ts Complete Integration - Real Execution Tests[2m > [22mshould execute middleware with real HTTP requests[33m 591[2mms[22m[39m
 [32mâœ“[39m backend/src/routes/__tests__/telegram.test.ts[2m > [22mTelegram Webhook Routes[2m > [22mPOST /api/telegram/webhook[2m > [22mshould return 200 but not update user if user ID in command does not match token's user[32m 119[2mms[22m[39m
 [32mâœ“[39m backend/src/routes/__tests__/telegram.test.ts[2m > [22mTelegram Webhook Routes[2m > [22mPOST /api/telegram/webhook[2m > [22mshould return 200 but not update user if token is invalid[32m 10[2mms[22m[39m
 [32mâœ“[39m backend/src/models/__tests__/User.test.ts[2m > [22mUser Model[2m > [22mconstructor[2m > [22mshould create User instance with provided data[32m 5[2mms[22m[39m
 [32mâœ“[39m backend/src/models/__tests__/User.test.ts[2m > [22mUser Model[2m > [22mconstructor[2m > [22mshould create User instance with minimal data[32m 2[2mms[22m[39m
 [32mâœ“[39m backend/src/models/__tests__/User.test.ts[2m > [22mUser Model[2m > [22mvalidate[2m > [22mshould validate and normalize user fields[32m 4[2mms[22m[39m
 [32mâœ“[39m backend/src/models/__tests__/User.test.ts[2m > [22mUser Model[2m > [22mvalidate[2m > [22mshould throw error for invalid name[32m 2[2mms[22m[39m
 [32mâœ“[39m backend/src/models/__tests__/User.test.ts[2m > [22mUser Model[2m > [22mvalidate[2m > [22mshould throw error for invalid email[32m 5[2mms[22m[39m
 [32mâœ“[39m backend/src/models/__tests__/User.test.ts[2m > [22mUser Model[2m > [22msave[2m > [22mshould create new user when id is not set[32m 9[2mms[22m[39m
 [32mâœ“[39m backend/src/models/__tests__/User.test.ts[2m > [22mUser Model[2m > [22msave[2m > [22mshould update existing user when id is set[32m 2[2mms[22m[39m
 [32mâœ“[39m backend/src/models/__tests__/User.test.ts[2m > [22mUser Model[2m > [22msave[2m > [22mshould throw error if creation fails[32m 4[2mms[22m[39m
 [32mâœ“[39m backend/src/models/__tests__/User.test.ts[2m > [22mUser Model[2m > [22mupdate[2m > [22mshould update user fields[32m 3[2mms[22m[39m
 [32mâœ“[39m backend/src/models/__tests__/User.test.ts[2m > [22mUser Model[2m > [22mupdate[2m > [22mshould throw error if user has no id[32m 2[2mms[22m[39m
 [32mâœ“[39m backend/src/models/__tests__/User.test.ts[2m > [22mUser Model[2m > [22mdelete[2m > [22mshould delete user from database[32m 2[2mms[22m[39m
 [32mâœ“[39m backend/src/models/__tests__/User.test.ts[2m > [22mUser Model[2m > [22mdelete[2m > [22mshould throw error if user has no id[32m 2[2mms[22m[39m
 [32mâœ“[39m backend/src/models/__tests__/User.test.ts[2m > [22mUser Model[2m > [22mdelete[2m > [22mshould throw error if user not found[32m 1[2mms[22m[39m
 [32mâœ“[39m backend/src/models/__tests__/User.test.ts[2m > [22mUser Model[2m > [22mtoData[2m > [22mshould convert user instance to UserData[32m 3[2mms[22m[39m
 [32mâœ“[39m backend/src/models/__tests__/User.test.ts[2m > [22mUser Model[2m > [22mloadById[2m > [22mshould load user by id[32m 5[2mms[22m[39m
 [32mâœ“[39m backend/src/models/__tests__/User.test.ts[2m > [22mUser Model[2m > [22mloadById[2m > [22mshould return null for non-existent user[32m 2[2mms[22m[39m
 [32mâœ“[39m backend/src/models/__tests__/User.test.ts[2m > [22mUser Model[2m > [22mloadByEmail[2m > [22mshould load user by email[32m 2[2mms[22m[39m
 [32mâœ“[39m backend/src/models/__tests__/User.test.ts[2m > [22mUser Model[2m > [22mloadByEmail[2m > [22mshould normalize email when loading[32m 2[2mms[22m[39m
 [32mâœ“[39m backend/src/models/__tests__/User.test.ts[2m > [22mUser Model[2m > [22mloadByEmail[2m > [22mshould return null for non-existent email[32m 2[2mms[22m[39m
 [32mâœ“[39m backend/src/models/__tests__/User.test.ts[2m > [22mUser Model[2m > [22mvalidateName[2m > [22mshould accept valid names[32m 1[2mms[22m[39m
 [32mâœ“[39m backend/src/models/__tests__/User.test.ts[2m > [22mUser Model[2m > [22mvalidateName[2m > [22mshould trim whitespace[32m 1[2mms[22m[39m
 [32mâœ“[39m backend/src/models/__tests__/User.test.ts[2m > [22mUser Model[2m > [22mvalidateName[2m > [22mshould throw TypeError for invalid name format[32m 1[2mms[22m[39m
 [32mâœ“[39m backend/src/models/__tests__/User.test.ts[2m > [22mUser Model[2m > [22mvalidateName[2m > [22mshould throw TypeError for non-string name[32m 1[2mms[22m[39m
 [32mâœ“[39m backend/src/models/__tests__/User.test.ts[2m > [22mUser Model[2m > [22mvalidateName[2m > [22mshould throw TypeError for name exceeding max length[32m 2[2mms[22m[39m
 [32mâœ“[39m backend/src/models/__tests__/User.test.ts[2m > [22mUser Model[2m > [22mvalidateName[2m > [22mshould accept name with exactly MAX_NAME_LENGTH characters[32m 1[2mms[22m[39m
 [32mâœ“[39m backend/src/models/__tests__/User.test.ts[2m > [22mUser Model[2m > [22mvalidateEmail[2m > [22mshould accept valid email addresses[32m 2[2mms[22m[39m
 [32mâœ“[39m backend/src/models/__tests__/User.test.ts[2m > [22mUser Model[2m > [22mvalidateEmail[2m > [22mshould normalize email to lowercase[32m 2[2mms[22m[39m
 [32mâœ“[39m backend/src/models/__tests__/User.test.ts[2m > [22mUser Model[2m > [22mvalidateEmail[2m > [22mshould trim whitespace[32m 2[2mms[22m[39m
 [32mâœ“[39m backend/src/models/__tests__/User.test.ts[2m > [22mUser Model[2m > [22mvalidateEmail[2m > [22mshould throw TypeError for invalid email format[32m 2[2mms[22m[39m
 [32mâœ“[39m backend/src/models/__tests__/User.test.ts[2m > [22mUser Model[2m > [22mvalidateEmail[2m > [22mshould throw TypeError for empty email[32m 1[2mms[22m[39m
 [32mâœ“[39m backend/src/models/__tests__/User.test.ts[2m > [22mUser Model[2m > [22mvalidateEmail[2m > [22mshould throw TypeError for non-string email[32m 2[2mms[22m[39m
 [32mâœ“[39m backend/src/models/__tests__/User.test.ts[2m > [22mUser Model[2m > [22mvalidateEmail[2m > [22mshould throw TypeError for email exceeding max length[32m 1[2mms[22m[39m
 [32mâœ“[39m backend/src/routes/__tests__/telegram.test.ts[2m > [22mTelegram Webhook Routes[2m > [22mPOST /api/telegram/webhook[2m > [22mshould return 200 but not update user if token is expired[32m 119[2mms[22m[39m
 [32mâœ“[39m backend/src/routes/__tests__/telegram.test.ts[2m > [22mTelegram Webhook Routes[2m > [22mPOST /api/telegram/webhook[2m > [22mshould return 200 for non-/start messages[32m 14[2mms[22m[39m
 [32mâœ“[39m backend/src/routes/__tests__/telegram.test.ts[2m > [22mTelegram Webhook Routes[2m > [22mPOST /api/telegram/webhook[2m > [22mshould return 200 for updates without message[32m 9[2mms[22m[39m
[90mstderr[2m | backend/src/services/__tests__/telegramService.test.ts[2m > [22m[2mTelegramService[2m > [22m[2msendWelcomeMessage[2m > [22m[2mshould throw error when Telegram API returns error
[22m[39m[2026-01-15T18:50:47.164Z] ERROR   | TELEGRAM | Error sending welcome message to 123456789: Error: Telegram API error: Chat not found
    at TelegramService.sendWelcomeMessage (D:/Code/habitus/backend/src/services/telegramService.ts:267:15)
    at D:/Code/habitus/backend/src/services/__tests__/telegramService.test.ts:176:7
    at [90mfile:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:919:20

[90mstderr[2m | backend/src/services/__tests__/telegramService.test.ts[2m > [22m[2mTelegramService[2m > [22m[2msendWelcomeMessage[2m > [22m[2mshould throw error when Telegram API response is not ok
[22m[39m[2026-01-15T18:50:47.172Z] ERROR   | TELEGRAM | Error sending welcome message to 123456789: Error: Telegram API error: Unauthorized
    at TelegramService.sendWelcomeMessage (D:/Code/habitus/backend/src/services/telegramService.ts:272:15)
    at D:/Code/habitus/backend/src/services/__tests__/telegramService.test.ts:192:7
    at [90mfile:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:919:20

[90mstderr[2m | backend/src/services/__tests__/telegramService.test.ts[2m > [22m[2mTelegramService[2m > [22m[2msendWelcomeMessage[2m > [22m[2mshould handle chat not found error specifically
[22m[39m[2026-01-15T18:50:47.174Z] ERROR   | TELEGRAM | Error sending welcome message to 123456789: Error: Telegram API error: chat not found
    at TelegramService.sendWelcomeMessage (D:/Code/habitus/backend/src/services/telegramService.ts:267:15)
    at D:/Code/habitus/backend/src/services/__tests__/telegramService.test.ts:210:7
    at [90mfile:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:919:20

[90mstderr[2m | backend/src/services/__tests__/telegramService.test.ts[2m > [22m[2mTelegramService[2m > [22m[2msendWelcomeMessage[2m > [22m[2mshould handle invalid bot token error specifically
[22m[39m[2026-01-15T18:50:47.175Z] ERROR   | TELEGRAM | Error sending welcome message to 123456789: Error: Telegram API error: bot token is invalid
    at TelegramService.sendWelcomeMessage (D:/Code/habitus/backend/src/services/telegramService.ts:267:15)
    at D:/Code/habitus/backend/src/services/__tests__/telegramService.test.ts:228:7
    at [90mfile:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:919:20

[90mstderr[2m | backend/src/services/__tests__/telegramService.test.ts[2m > [22m[2mTelegramService[2m > [22m[2msendWelcomeMessage[2m > [22m[2mshould handle network errors gracefully
[22m[39m[2026-01-15T18:50:47.176Z] ERROR   | TELEGRAM | Error sending welcome message to 123456789: Error: Network error
    at D:/Code/habitus/backend/src/services/__tests__/telegramService.test.ts:234:35
    at [90mfile:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
    at [90mfile:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:919:26
    at [90mfile:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1244:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1210:10[90m)[39m
    at [90mfile:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1654:37
    at Traces.$ [90m(file:///D:/Code/habitus/[39mnode_modules/[4mvitest[24m/dist/chunks/traces.U4xDYhzZ.js:115:27[90m)[39m
    at trace [90m(file:///D:/Code/habitus/[39mnode_modules/[4mvitest[24m/dist/chunks/test.DqQZzsWf.js:234:21[90m)[39m
    at runTest [90m(file:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1654:12[90m)[39m

[90mstderr[2m | backend/src/services/__tests__/telegramService.test.ts[2m > [22m[2mTelegramService[2m > [22m[2msendWelcomeMessage[2m > [22m[2mshould handle HTTP errors when response.json() fails
[22m[39m[2026-01-15T18:50:47.178Z] ERROR   | TELEGRAM | Error sending welcome message to 123456789: Error: Telegram API error: HTTP 500: Internal Server Error
    at TelegramService.sendWelcomeMessage (D:/Code/habitus/backend/src/services/telegramService.ts:267:15)
    at D:/Code/habitus/backend/src/services/__tests__/telegramService.test.ts:251:7
    at [90mfile:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:919:20

[90mstderr[2m | backend/src/services/__tests__/telegramService.test.ts[2m > [22m[2mTelegramService[2m > [22m[2msendWelcomeMessage[2m > [22m[2mshould handle HTTP errors without description
[22m[39m[2026-01-15T18:50:47.180Z] ERROR   | TELEGRAM | Error sending welcome message to 123456789: Error: Telegram API error: HTTP 500: Internal Server Error
    at TelegramService.sendWelcomeMessage (D:/Code/habitus/backend/src/services/telegramService.ts:267:15)
    at D:/Code/habitus/backend/src/services/__tests__/telegramService.test.ts:266:7
    at [90mfile:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:919:20

[90mstderr[2m | backend/src/services/__tests__/telegramService.test.ts[2m > [22m[2mTelegramService[2m > [22m[2msendReminderMessage[2m > [22m[2mshould throw error when Telegram API returns error
[22m[39m[2026-01-15T18:50:47.195Z] ERROR   | TELEGRAM | Error sending reminder message to 123456789: Error: Telegram API error: Chat not found
    at TelegramService.sendReminderMessage (D:/Code/habitus/backend/src/services/telegramService.ts:181:15)
    at D:/Code/habitus/backend/src/services/__tests__/telegramService.test.ts:585:7
    at [90mfile:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:919:20

[90mstderr[2m | backend/src/services/__tests__/telegramService.test.ts[2m > [22m[2mTelegramService[2m > [22m[2msendReminderMessage[2m > [22m[2mshould throw error when Telegram API response is not ok
[22m[39m[2026-01-15T18:50:47.197Z] ERROR   | TELEGRAM | Error sending reminder message to 123456789: Error: Telegram API error: Unauthorized
    at TelegramService.sendReminderMessage (D:/Code/habitus/backend/src/services/telegramService.ts:186:15)
    at D:/Code/habitus/backend/src/services/__tests__/telegramService.test.ts:606:7
    at [90mfile:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:919:20

[90mstderr[2m | backend/src/services/__tests__/telegramService.test.ts[2m > [22m[2mTelegramService[2m > [22m[2msendReminderMessage[2m > [22m[2mshould handle chat not found error specifically
[22m[39m[2026-01-15T18:50:47.199Z] ERROR   | TELEGRAM | Error sending reminder message to 123456789: Error: Telegram API error: chat not found
    at TelegramService.sendReminderMessage (D:/Code/habitus/backend/src/services/telegramService.ts:181:15)
    at D:/Code/habitus/backend/src/services/__tests__/telegramService.test.ts:629:7
    at [90mfile:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:919:20

[90mstderr[2m | backend/src/services/__tests__/telegramService.test.ts[2m > [22m[2mTelegramService[2m > [22m[2msendReminderMessage[2m > [22m[2mshould handle invalid bot token error specifically
[22m[39m[2026-01-15T18:50:47.203Z] ERROR   | TELEGRAM | Error sending reminder message to 123456789: Error: Telegram API error: bot token is invalid
    at TelegramService.sendReminderMessage (D:/Code/habitus/backend/src/services/telegramService.ts:181:15)
    at D:/Code/habitus/backend/src/services/__tests__/telegramService.test.ts:652:7
    at [90mfile:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:919:20

[90mstderr[2m | backend/src/services/__tests__/telegramService.test.ts[2m > [22m[2mTelegramService[2m > [22m[2msendReminderMessage[2m > [22m[2mshould handle network errors gracefully
[22m[39m[2026-01-15T18:50:47.207Z] ERROR   | TELEGRAM | Error sending reminder message to 123456789: Error: Network error
    at D:/Code/habitus/backend/src/services/__tests__/telegramService.test.ts:663:35
    at [90mfile:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
    at [90mfile:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:919:26
    at [90mfile:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1244:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1210:10[90m)[39m
    at [90mfile:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1654:37
    at Traces.$ [90m(file:///D:/Code/habitus/[39mnode_modules/[4mvitest[24m/dist/chunks/traces.U4xDYhzZ.js:115:27[90m)[39m
    at trace [90m(file:///D:/Code/habitus/[39mnode_modules/[4mvitest[24m/dist/chunks/test.DqQZzsWf.js:234:21[90m)[39m
    at runTest [90m(file:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1654:12[90m)[39m

[90mstderr[2m | backend/src/services/__tests__/telegramService.test.ts[2m > [22m[2mTelegramService[2m > [22m[2msendReminderMessage[2m > [22m[2mshould handle HTTP errors when response.json() fails
[22m[39m[2026-01-15T18:50:47.209Z] ERROR   | TELEGRAM | Error sending reminder message to 123456789: Error: Telegram API error: HTTP 500: Internal Server Error
    at TelegramService.sendReminderMessage (D:/Code/habitus/backend/src/services/telegramService.ts:181:15)
    at D:/Code/habitus/backend/src/services/__tests__/telegramService.test.ts:685:7
    at [90mfile:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:919:20

[90mstderr[2m | backend/src/services/__tests__/telegramService.test.ts[2m > [22m[2mTelegramService[2m > [22m[2msendReminderMessage[2m > [22m[2mshould handle HTTP errors without description
[22m[39m[2026-01-15T18:50:47.211Z] ERROR   | TELEGRAM | Error sending reminder message to 123456789: Error: Telegram API error: HTTP 500: Internal Server Error
    at TelegramService.sendReminderMessage (D:/Code/habitus/backend/src/services/telegramService.ts:181:15)
    at D:/Code/habitus/backend/src/services/__tests__/telegramService.test.ts:705:7
    at [90mfile:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:919:20

[90mstderr[2m | backend/src/services/__tests__/telegramService.test.ts[2m > [22m[2mTelegramService[2m > [22m[2mgetChatInfo[2m > [22m[2mshould throw error when Telegram API returns error
[22m[39m[2026-01-15T18:50:47.216Z] ERROR   | TELEGRAM | Error getting chat info for 123456789: Error: Telegram API error: Chat not found
    at TelegramService.getChatInfo (D:/Code/habitus/backend/src/services/telegramService.ts:344:15)
    at D:/Code/habitus/backend/src/services/__tests__/telegramService.test.ts:840:7
    at [90mfile:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:919:20

[90mstderr[2m | backend/src/services/__tests__/telegramService.test.ts[2m > [22m[2mTelegramService[2m > [22m[2mgetChatInfo[2m > [22m[2mshould throw error when Telegram API response is not ok
[22m[39m[2026-01-15T18:50:47.217Z] ERROR   | TELEGRAM | Error getting chat info for 123456789: Error: Telegram API error: Unauthorized
    at TelegramService.getChatInfo (D:/Code/habitus/backend/src/services/telegramService.ts:358:15)
    at D:/Code/habitus/backend/src/services/__tests__/telegramService.test.ts:856:7
    at [90mfile:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:919:20

[90mstderr[2m | backend/src/services/__tests__/telegramService.test.ts[2m > [22m[2mTelegramService[2m > [22m[2mgetChatInfo[2m > [22m[2mshould handle chat not found error specifically
[22m[39m[2026-01-15T18:50:47.217Z] ERROR   | TELEGRAM | Error getting chat info for 123456789: Error: Telegram API error: chat not found
    at TelegramService.getChatInfo (D:/Code/habitus/backend/src/services/telegramService.ts:344:15)
    at D:/Code/habitus/backend/src/services/__tests__/telegramService.test.ts:874:7
    at [90mfile:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:919:20

[90mstderr[2m | backend/src/services/__tests__/telegramService.test.ts[2m > [22m[2mTelegramService[2m > [22m[2mgetChatInfo[2m > [22m[2mshould handle invalid bot token error specifically
[22m[39m[2026-01-15T18:50:47.218Z] ERROR   | TELEGRAM | Error getting chat info for 123456789: Error: Telegram API error: bot token is invalid
    at TelegramService.getChatInfo (D:/Code/habitus/backend/src/services/telegramService.ts:344:15)
    at D:/Code/habitus/backend/src/services/__tests__/telegramService.test.ts:892:7
    at [90mfile:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:919:20

[90mstderr[2m | backend/src/services/__tests__/telegramService.test.ts[2m > [22m[2mTelegramService[2m > [22m[2mgetChatInfo[2m > [22m[2mshould handle network errors gracefully
[22m[39m[2026-01-15T18:50:47.219Z] ERROR   | TELEGRAM | Error getting chat info for 123456789: Error: Network error
    at D:/Code/habitus/backend/src/services/__tests__/telegramService.test.ts:898:35
    at [90mfile:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
    at [90mfile:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:919:26
    at [90mfile:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1244:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1210:10[90m)[39m
    at [90mfile:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1654:37
    at Traces.$ [90m(file:///D:/Code/habitus/[39mnode_modules/[4mvitest[24m/dist/chunks/traces.U4xDYhzZ.js:115:27[90m)[39m
    at trace [90m(file:///D:/Code/habitus/[39mnode_modules/[4mvitest[24m/dist/chunks/test.DqQZzsWf.js:234:21[90m)[39m
    at runTest [90m(file:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1654:12[90m)[39m

[90mstderr[2m | backend/src/services/__tests__/telegramService.test.ts[2m > [22m[2mTelegramService[2m > [22m[2mgetChatInfo[2m > [22m[2mshould handle HTTP errors when response.json() fails
[22m[39m[2026-01-15T18:50:47.220Z] ERROR   | TELEGRAM | Error getting chat info for 123456789: Error: Telegram API error: HTTP 500: Internal Server Error
    at TelegramService.getChatInfo (D:/Code/habitus/backend/src/services/telegramService.ts:344:15)
    at D:/Code/habitus/backend/src/services/__tests__/telegramService.test.ts:915:7
    at [90mfile:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:919:20

[90mstderr[2m | backend/src/services/__tests__/telegramService.test.ts[2m > [22m[2mTelegramService[2m > [22m[2mgetChatInfo[2m > [22m[2mshould handle HTTP errors without description
[22m[39m[2026-01-15T18:50:47.221Z] ERROR   | TELEGRAM | Error getting chat info for 123456789: Error: Telegram API error: HTTP 500: Internal Server Error
    at TelegramService.getChatInfo (D:/Code/habitus/backend/src/services/telegramService.ts:344:15)
    at D:/Code/habitus/backend/src/services/__tests__/telegramService.test.ts:930:7
    at [90mfile:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:919:20

 [32mâœ“[39m backend/src/services/__tests__/telegramService.test.ts[2m > [22mTelegramService[2m > [22mconstructor[2m > [22mshould use environment variables when no config provided[32m 3[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/telegramService.test.ts[2m > [22mTelegramService[2m > [22mconstructor[2m > [22mshould use provided config over environment variables[32m 0[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/telegramService.test.ts[2m > [22mTelegramService[2m > [22msendWelcomeMessage[2m > [22mshould send welcome message successfully[32m 3[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/telegramService.test.ts[2m > [22mTelegramService[2m > [22msendWelcomeMessage[2m > [22mshould include app link in welcome message[32m 1[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/telegramService.test.ts[2m > [22mTelegramService[2m > [22msendWelcomeMessage[2m > [22mshould format welcome message correctly[32m 1[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/telegramService.test.ts[2m > [22mTelegramService[2m > [22msendWelcomeMessage[2m > [22mshould throw error when bot token is not configured[32m 2[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/telegramService.test.ts[2m > [22mTelegramService[2m > [22msendWelcomeMessage[2m > [22mshould throw error when chat ID is missing[32m 1[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/telegramService.test.ts[2m > [22mTelegramService[2m > [22msendWelcomeMessage[2m > [22mshould throw error when Telegram API returns error[32m 7[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/telegramService.test.ts[2m > [22mTelegramService[2m > [22msendWelcomeMessage[2m > [22mshould throw error when Telegram API response is not ok[32m 2[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/telegramService.test.ts[2m > [22mTelegramService[2m > [22msendWelcomeMessage[2m > [22mshould handle chat not found error specifically[32m 1[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/telegramService.test.ts[2m > [22mTelegramService[2m > [22msendWelcomeMessage[2m > [22mshould handle invalid bot token error specifically[32m 1[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/telegramService.test.ts[2m > [22mTelegramService[2m > [22msendWelcomeMessage[2m > [22mshould handle network errors gracefully[32m 2[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/telegramService.test.ts[2m > [22mTelegramService[2m > [22msendWelcomeMessage[2m > [22mshould handle HTTP errors when response.json() fails[32m 2[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/telegramService.test.ts[2m > [22mTelegramService[2m > [22msendWelcomeMessage[2m > [22mshould handle HTTP errors without description[32m 1[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/telegramService.test.ts[2m > [22mTelegramService[2m > [22msendReminderMessage[2m > [22mshould send reminder message successfully[32m 2[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/telegramService.test.ts[2m > [22mTelegramService[2m > [22msendReminderMessage[2m > [22mshould include tracking icon in message[32m 1[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/telegramService.test.ts[2m > [22mTelegramService[2m > [22msendReminderMessage[2m > [22mshould include tracking notes in message[32m 1[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/telegramService.test.ts[2m > [22mTelegramService[2m > [22msendReminderMessage[2m > [22mshould include reminder notes in message[32m 1[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/telegramService.test.ts[2m > [22mTelegramService[2m > [22msendReminderMessage[2m > [22mshould include all optional fields in message[32m 1[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/telegramService.test.ts[2m > [22mTelegramService[2m > [22msendReminderMessage[2m > [22mshould include inline keyboard with action buttons[32m 2[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/telegramService.test.ts[2m > [22mTelegramService[2m > [22msendReminderMessage[2m > [22mshould escape markdown special characters[32m 1[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/telegramService.test.ts[2m > [22mTelegramService[2m > [22msendReminderMessage[2m > [22mshould use custom locale and timezone[32m 2[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/telegramService.test.ts[2m > [22mTelegramService[2m > [22msendReminderMessage[2m > [22mshould throw error when bot token is not configured[32m 1[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/telegramService.test.ts[2m > [22mTelegramService[2m > [22msendReminderMessage[2m > [22mshould throw error when chat ID is missing[32m 1[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/telegramService.test.ts[2m > [22mTelegramService[2m > [22msendReminderMessage[2m > [22mshould throw error when Telegram API returns error[32m 2[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/telegramService.test.ts[2m > [22mTelegramService[2m > [22msendReminderMessage[2m > [22mshould throw error when Telegram API response is not ok[32m 3[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/telegramService.test.ts[2m > [22mTelegramService[2m > [22msendReminderMessage[2m > [22mshould handle chat not found error specifically[32m 2[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/telegramService.test.ts[2m > [22mTelegramService[2m > [22msendReminderMessage[2m > [22mshould handle invalid bot token error specifically[32m 4[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/telegramService.test.ts[2m > [22mTelegramService[2m > [22msendReminderMessage[2m > [22mshould handle network errors gracefully[32m 3[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/telegramService.test.ts[2m > [22mTelegramService[2m > [22msendReminderMessage[2m > [22mshould handle HTTP errors when response.json() fails[32m 2[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/telegramService.test.ts[2m > [22mTelegramService[2m > [22msendReminderMessage[2m > [22mshould handle HTTP errors without description[32m 2[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/telegramService.test.ts[2m > [22mTelegramService[2m > [22msendReminderMessage[2m > [22mshould use default icon when trackingIcon is not provided[32m 1[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/telegramService.test.ts[2m > [22mTelegramService[2m > [22mgetChatInfo[2m > [22mshould get chat info successfully[32m 1[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/telegramService.test.ts[2m > [22mTelegramService[2m > [22mgetChatInfo[2m > [22mshould handle missing username and first_name[32m 0[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/telegramService.test.ts[2m > [22mTelegramService[2m > [22mgetChatInfo[2m > [22mshould throw error when bot token is not configured[32m 1[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/telegramService.test.ts[2m > [22mTelegramService[2m > [22mgetChatInfo[2m > [22mshould throw error when chat ID is missing[32m 0[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/telegramService.test.ts[2m > [22mTelegramService[2m > [22mgetChatInfo[2m > [22mshould throw error when Telegram API returns error[32m 1[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/telegramService.test.ts[2m > [22mTelegramService[2m > [22mgetChatInfo[2m > [22mshould throw error when Telegram API response is not ok[32m 1[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/telegramService.test.ts[2m > [22mTelegramService[2m > [22mgetChatInfo[2m > [22mshould handle chat not found error specifically[32m 1[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/telegramService.test.ts[2m > [22mTelegramService[2m > [22mgetChatInfo[2m > [22mshould handle invalid bot token error specifically[32m 1[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/telegramService.test.ts[2m > [22mTelegramService[2m > [22mgetChatInfo[2m > [22mshould handle network errors gracefully[32m 1[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/telegramService.test.ts[2m > [22mTelegramService[2m > [22mgetChatInfo[2m > [22mshould handle HTTP errors when response.json() fails[32m 1[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/telegramService.test.ts[2m > [22mTelegramService[2m > [22mgetChatInfo[2m > [22mshould handle HTTP errors without description[32m 1[2mms[22m[39m
 [32mâœ“[39m backend/src/routes/__tests__/telegram.test.ts[2m > [22mTelegram Webhook Routes[2m > [22mPOST /api/telegram/webhook[2m > [22mshould handle /start command with token but missing user ID[32m 116[2mms[22m[39m
 [32mâœ“[39m backend/src/routes/__tests__/telegram.test.ts[2m > [22mTelegram Webhook Routes[2m > [22mGET /api/telegram/start-link[2m > [22mshould generate start link with token for authenticated user[32m 23[2mms[22m[39m
 [32mâœ“[39m backend/src/routes/__tests__/telegram.test.ts[2m > [22mTelegram Webhook Routes[2m > [22mGET /api/telegram/start-link[2m > [22mshould return 401 for missing authorization header[32m 10[2mms[22m[39m
 [32mâœ“[39m backend/src/routes/__tests__/telegram.test.ts[2m > [22mTelegram Webhook Routes[2m > [22mGET /api/telegram/start-link[2m > [22mshould return 401 for invalid token[32m 12[2mms[22m[39m
 [32mâœ“[39m backend/src/routes/__tests__/telegram.test.ts[2m > [22mTelegram Webhook Routes[2m > [22mGET /api/telegram/status[2m > [22mshould return connected status when user has telegram_chat_id[32m 17[2mms[22m[39m
 [32mâœ“[39m backend/src/routes/__tests__/telegram.test.ts[2m > [22mTelegram Webhook Routes[2m > [22mGET /api/telegram/status[2m > [22mshould return not connected status when user has no telegram_chat_id[32m 10[2mms[22m[39m
 [32mâœ“[39m backend/src/routes/__tests__/telegram.test.ts[2m > [22mTelegram Webhook Routes[2m > [22mGET /api/telegram/status[2m > [22mshould return 401 for missing authorization header[32m 13[2mms[22m[39m
 [32mâœ“[39m backend/src/routes/__tests__/telegram.test.ts[2m > [22mTelegram Webhook Routes[2m > [22mGET /api/telegram/status[2m > [22mshould return 401 for invalid token[32m 12[2mms[22m[39m
[90mstderr[2m | backend/src/services/__tests__/aiService.test.ts[2m > [22m[2mAiService[2m > [22m[2msuggestEmoji[2m > [22m[2mshould handle API error response with JSON
[22m[39m[2026-01-15T18:50:47.286Z] ERROR   | AI_SERVICE | Perplexity API error: 401 Unauthorized {
  "error": "Invalid API key"
}
[2026-01-15T18:50:47.287Z] ERROR   | AI_SERVICE | Error suggesting emoji: Error: Perplexity API error: 401 Unauthorized. {
  "error": "Invalid API key"
}
    at AiService.suggestEmoji (D:/Code/habitus/backend/src/services/aiService.ts:92:15)
    at D:/Code/habitus/backend/src/services/__tests__/aiService.test.ts:249:7
    at [90mfile:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:919:20

[90mstderr[2m | backend/src/services/__tests__/aiService.test.ts[2m > [22m[2mAiService[2m > [22m[2msuggestEmoji[2m > [22m[2mshould handle API error response with text
[22m[39m[2026-01-15T18:50:47.294Z] ERROR   | AI_SERVICE | Perplexity API error: 500 Internal Server Error Server error occurred
[2026-01-15T18:50:47.294Z] ERROR   | AI_SERVICE | Error suggesting emoji: Error: Perplexity API error: 500 Internal Server Error. Server error occurred
    at AiService.suggestEmoji (D:/Code/habitus/backend/src/services/aiService.ts:92:15)
    at D:/Code/habitus/backend/src/services/__tests__/aiService.test.ts:262:7
    at [90mfile:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:919:20

[90mstderr[2m | backend/src/services/__tests__/aiService.test.ts[2m > [22m[2mAiService[2m > [22m[2msuggestEmoji[2m > [22m[2mshould handle network errors
[22m[39m[2026-01-15T18:50:47.296Z] ERROR   | AI_SERVICE | Error suggesting emoji: Error: Network request failed
    at D:/Code/habitus/backend/src/services/__tests__/aiService.test.ts:269:9
    at [90mfile:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
    at [90mfile:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:919:26
    at [90mfile:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1244:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1210:10[90m)[39m
    at [90mfile:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1654:37
    at Traces.$ [90m(file:///D:/Code/habitus/[39mnode_modules/[4mvitest[24m/dist/chunks/traces.U4xDYhzZ.js:115:27[90m)[39m
    at trace [90m(file:///D:/Code/habitus/[39mnode_modules/[4mvitest[24m/dist/chunks/test.DqQZzsWf.js:234:21[90m)[39m
    at runTest [90m(file:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1654:12[90m)[39m

 [32mâœ“[39m backend/src/services/__tests__/aiService.test.ts[2m > [22mAiService[2m > [22mconstructor[2m > [22mshould use default model from constants when PERPLEXITY_MODEL is not set[32m 3[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/aiService.test.ts[2m > [22mAiService[2m > [22mconstructor[2m > [22mshould use PERPLEXITY_MODEL environment variable when set[32m 1[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/aiService.test.ts[2m > [22mAiService[2m > [22mconstructor[2m > [22mshould read PERPLEXITY_API_KEY from environment[32m 1[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/aiService.test.ts[2m > [22mAiService[2m > [22msuggestEmoji[2m > [22mshould throw error when API key is not configured[32m 3[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/aiService.test.ts[2m > [22mAiService[2m > [22msuggestEmoji[2m > [22mshould throw error when question is empty[32m 1[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/aiService.test.ts[2m > [22mAiService[2m > [22msuggestEmoji[2m > [22mshould throw error when question is only whitespace[32m 1[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/aiService.test.ts[2m > [22mAiService[2m > [22msuggestEmoji[2m > [22mshould use constants API URL and default model in fetch request[32m 7[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/aiService.test.ts[2m > [22mAiService[2m > [22msuggestEmoji[2m > [22mshould use custom model from environment variable when set[32m 1[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/aiService.test.ts[2m > [22mAiService[2m > [22msuggestEmoji[2m > [22mshould return emoji from API response[32m 2[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/aiService.test.ts[2m > [22mAiService[2m > [22msuggestEmoji[2m > [22mshould extract emoji from response containing text and emoji[32m 1[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/aiService.test.ts[2m > [22mAiService[2m > [22msuggestEmoji[2m > [22mshould return first character when API returns no emoji[32m 1[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/aiService.test.ts[2m > [22mAiService[2m > [22msuggestEmoji[2m > [22mshould return default emoji from constants when API returns empty content[32m 1[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/aiService.test.ts[2m > [22mAiService[2m > [22msuggestEmoji[2m > [22mshould return default emoji from constants when choices array is empty[32m 1[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/aiService.test.ts[2m > [22mAiService[2m > [22msuggestEmoji[2m > [22mshould handle API error response with JSON[32m 8[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/aiService.test.ts[2m > [22mAiService[2m > [22msuggestEmoji[2m > [22mshould handle API error response with text[32m 2[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/aiService.test.ts[2m > [22mAiService[2m > [22msuggestEmoji[2m > [22mshould handle network errors[32m 2[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/aiService.test.ts[2m > [22mAiService[2m > [22msuggestEmoji[2m > [22mshould trim question before sending to API[32m 1[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/aiService.test.ts[2m > [22mAiService[2m > [22msuggestEmoji[2m > [22mshould send correct prompt format in request[32m 2[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/aiService.test.ts[2m > [22mAiService[2m > [22msuggestEmoji[2m > [22mshould return first character when emoji regex doesn't match[32m 1[2mms[22m[39m
 [32mâœ“[39m backend/src/middleware/__tests__/rateLimiter.test.ts[2m > [22mRate Limiter[2m > [22mauthRateLimiter[2m > [22mshould be defined[32m 2[2mms[22m[39m
 [32mâœ“[39m backend/src/middleware/__tests__/rateLimiter.test.ts[2m > [22mRate Limiter[2m > [22mauthRateLimiter[2m > [22mshould be a middleware function[32m 0[2mms[22m[39m
 [32mâœ“[39m backend/src/middleware/__tests__/rateLimiter.test.ts[2m > [22mRate Limiter[2m > [22mauthRateLimiter[2m > [22mshould have skip function that returns true in test environment[32m 0[2mms[22m[39m
 [32mâœ“[39m backend/src/middleware/__tests__/rateLimiter.test.ts[2m > [22mRate Limiter[2m > [22mauthRateLimiter[2m > [22mshould have skip function that returns false in production environment[32m 0[2mms[22m[39m
 [32mâœ“[39m backend/src/middleware/__tests__/rateLimiter.test.ts[2m > [22mRate Limiter[2m > [22mauthRateLimiter[2m > [22mshould have handler function for rate limit exceeded[32m 6[2mms[22m[39m
 [32mâœ“[39m backend/src/middleware/__tests__/rateLimiter.test.ts[2m > [22mRate Limiter[2m > [22mauthRateLimiter[2m > [22mshould use req.socket.remoteAddress when req.ip is not available[32m 1[2mms[22m[39m
 [32mâœ“[39m backend/src/middleware/__tests__/rateLimiter.test.ts[2m > [22mRate Limiter[2m > [22mauthRateLimiter[2m > [22mshould use 'unknown' when both req.ip and req.socket.remoteAddress are not available[32m 2[2mms[22m[39m
 [32mâœ“[39m backend/src/middleware/__tests__/rateLimiter.test.ts[2m > [22mRate Limiter[2m > [22mauthRateLimiter[2m > [22mshould log the correct path in the warning message[32m 0[2mms[22m[39m
 [32mâœ“[39m backend/src/middleware/__tests__/rateLimiter.test.ts[2m > [22mRate Limiter[2m > [22mkeyGenerator[2m > [22mshould use req.ip when available[32m 7[2mms[22m[39m
 [32mâœ“[39m backend/src/middleware/__tests__/rateLimiter.test.ts[2m > [22mRate Limiter[2m > [22mkeyGenerator[2m > [22mshould use req.socket.remoteAddress when req.ip is not available[32m 0[2mms[22m[39m
 [32mâœ“[39m backend/src/middleware/__tests__/rateLimiter.test.ts[2m > [22mRate Limiter[2m > [22mkeyGenerator[2m > [22mshould use 'unknown' when both req.ip and req.socket.remoteAddress are not available[32m 0[2mms[22m[39m
 [32mâœ“[39m backend/src/middleware/__tests__/rateLimiter.test.ts[2m > [22mRate Limiter[2m > [22mkeyGenerator[2m > [22mshould handle IPv6 addresses correctly[32m 1[2mms[22m[39m
 [32mâœ“[39m backend/src/middleware/__tests__/rateLimiter.test.ts[2m > [22mRate Limiter[2m > [22mkeyGenerator[2m > [22mshould handle IPv6 compressed format[32m 0[2mms[22m[39m
 [32mâœ“[39m backend/src/middleware/__tests__/rateLimiter.test.ts[2m > [22mRate Limiter[2m > [22mkeyGenerator[2m > [22mshould handle null socket gracefully[32m 0[2mms[22m[39m
 [32mâœ“[39m backend/src/middleware/__tests__/rateLimiter.test.ts[2m > [22mRate Limiter[2m > [22mkeyGenerator[2m > [22mshould handle empty string IP[32m 0[2mms[22m[39m
 [32mâœ“[39m backend/src/middleware/__tests__/rateLimiter.test.ts[2m > [22mRate Limiter[2m > [22mrate limiter configuration[2m > [22mshould have correct windowMs configuration (15 minutes)[32m 0[2mms[22m[39m
 [32mâœ“[39m backend/src/middleware/__tests__/rateLimiter.test.ts[2m > [22mRate Limiter[2m > [22mrate limiter configuration[2m > [22mshould have correct max requests configuration (5)[32m 0[2mms[22m[39m
 [32mâœ“[39m backend/src/middleware/__tests__/rateLimiter.test.ts[2m > [22mRate Limiter[2m > [22mrate limiter configuration[2m > [22mshould have correct message format[32m 0[2mms[22m[39m
 [32mâœ“[39m backend/src/middleware/__tests__/rateLimiter.test.ts[2m > [22mRate Limiter[2m > [22mrate limiter configuration[2m > [22mshould have standardHeaders enabled[32m 0[2mms[22m[39m
 [32mâœ“[39m backend/src/middleware/__tests__/rateLimiter.test.ts[2m > [22mRate Limiter[2m > [22mrate limiter configuration[2m > [22mshould have legacyHeaders disabled[32m 0[2mms[22m[39m
 [32mâœ“[39m backend/src/middleware/__tests__/rateLimiter.test.ts[2m > [22mRate Limiter[2m > [22mrate limiter configuration[2m > [22mshould use handleRateLimitExceeded as handler[32m 0[2mms[22m[39m
 [32mâœ“[39m backend/src/middleware/__tests__/rateLimiter.test.ts[2m > [22mRate Limiter[2m > [22mrate limiter configuration[2m > [22mshould have handler that returns correct error message format[32m 0[2mms[22m[39m
 [32mâœ“[39m backend/src/middleware/__tests__/rateLimiter.test.ts[2m > [22mRate Limiter[2m > [22mrate limiter configuration[2m > [22mshould be configured as middleware function[32m 0[2mms[22m[39m
 [32mâœ“[39m backend/src/middleware/__tests__/rateLimiter.test.ts[2m > [22mRate Limiter[2m > [22mmiddleware behavior[2m > [22mshould be callable as middleware with req, res, next[32m 1[2mms[22m[39m
 [32mâœ“[39m backend/src/middleware/__tests__/rateLimiter.test.ts[2m > [22mRate Limiter[2m > [22mmiddleware behavior[2m > [22mshould skip rate limiting in test environment[32m 0[2mms[22m[39m
 [32mâœ“[39m backend/src/middleware/__tests__/rateLimiter.test.ts[2m > [22mRate Limiter[2m > [22mmiddleware behavior[2m > [22mshould not skip rate limiting in production environment[32m 0[2mms[22m[39m
 [32mâœ“[39m backend/src/middleware/__tests__/rateLimiter.test.ts[2m > [22mRate Limiter[2m > [22mmiddleware behavior[2m > [22mshould not skip rate limiting in development environment[32m 0[2mms[22m[39m
 [32mâœ“[39m backend/src/middleware/__tests__/rateLimiter.test.ts[2m > [22mRate Limiter[2m > [22mhandleRateLimitExceeded edge cases[2m > [22mshould handle missing path in request[32m 1[2mms[22m[39m
 [32mâœ“[39m backend/src/middleware/__tests__/rateLimiter.test.ts[2m > [22mRate Limiter[2m > [22mhandleRateLimitExceeded edge cases[2m > [22mshould include timestamp in log message[32m 0[2mms[22m[39m
 [32mâœ“[39m backend/src/middleware/__tests__/rateLimiter.test.ts[2m > [22mRate Limiter[2m > [22mhandleRateLimitExceeded edge cases[2m > [22mshould handle empty string IP[32m 0[2mms[22m[39m
 [32mâœ“[39m backend/src/middleware/__tests__/rateLimiter.test.ts[2m > [22mRate Limiter[2m > [22mhandleRateLimitExceeded edge cases[2m > [22mshould handle empty string socket.remoteAddress[32m 0[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/telegramConnectionService.test.ts[2m > [22mTelegramConnectionService[2m > [22mgenerateConnectionToken[2m > [22mshould generate a connection token for a user[32m 10[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/telegramConnectionService.test.ts[2m > [22mTelegramConnectionService[2m > [22mgenerateConnectionToken[2m > [22mshould generate unique tokens for different calls[32m 3[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/telegramConnectionService.test.ts[2m > [22mTelegramConnectionService[2m > [22mgenerateConnectionToken[2m > [22mshould throw error if user does not exist[32m 4[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/telegramConnectionService.test.ts[2m > [22mTelegramConnectionService[2m > [22mvalidateToken[2m > [22mshould validate a valid token and return user ID[32m 3[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/telegramConnectionService.test.ts[2m > [22mTelegramConnectionService[2m > [22mvalidateToken[2m > [22mshould return null for invalid token[32m 2[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/telegramConnectionService.test.ts[2m > [22mTelegramConnectionService[2m > [22mvalidateToken[2m > [22mshould return null for expired token[32m 2[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/telegramConnectionService.test.ts[2m > [22mTelegramConnectionService[2m > [22mvalidateToken[2m > [22mshould delete token after validation[32m 3[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/telegramConnectionService.test.ts[2m > [22mTelegramConnectionService[2m > [22mcleanupExpiredTokens[2m > [22mshould remove expired tokens from database[32m 3[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/telegramConnectionService.test.ts[2m > [22mTelegramConnectionService[2m > [22mcleanupExpiredTokens[2m > [22mshould not remove valid tokens[32m 2[2mms[22m[39m
 [32mâœ“[39m backend/src/config/__tests__/paths.test.ts[2m > [22mPathConfig[2m > [22mgetWorkspaceRoot[2m > [22mshould return workspace root from PROJECT_ROOT environment variable[32m 5[2mms[22m[39m
 [32mâœ“[39m backend/src/config/__tests__/paths.test.ts[2m > [22mPathConfig[2m > [22mgetWorkspaceRoot[2m > [22mshould throw error when PROJECT_ROOT is not set[32m 2[2mms[22m[39m
 [32mâœ“[39m backend/src/config/__tests__/paths.test.ts[2m > [22mPathConfig[2m > [22mgetWorkspaceRoot[2m > [22mshould throw error when PROJECT_ROOT points to non-existent path[32m 1[2mms[22m[39m
 [32mâœ“[39m backend/src/config/__tests__/paths.test.ts[2m > [22mPathConfig[2m > [22mgetWorkspaceRoot[2m > [22mshould cache workspace root after first call[32m 1[2mms[22m[39m
 [32mâœ“[39m backend/src/config/__tests__/paths.test.ts[2m > [22mPathConfig[2m > [22mgetWorkspaceRoot[2m > [22mshould resolve relative PROJECT_ROOT to absolute path[32m 1[2mms[22m[39m
 [32mâœ“[39m backend/src/config/__tests__/paths.test.ts[2m > [22mPathConfig[2m > [22mgetBackendRoot[2m > [22mshould return backend root directory[32m 1[2mms[22m[39m
 [32mâœ“[39m backend/src/config/__tests__/paths.test.ts[2m > [22mPathConfig[2m > [22mgetBackendRoot[2m > [22mshould cache backend root after first call[32m 1[2mms[22m[39m
 [32mâœ“[39m backend/src/config/__tests__/paths.test.ts[2m > [22mPathConfig[2m > [22mgetBackendRoot[2m > [22mshould use cached workspace root when available[32m 1[2mms[22m[39m
 [32mâœ“[39m backend/src/config/__tests__/paths.test.ts[2m > [22mPathConfig[2m > [22mgetPaths[2m > [22mshould return all paths object[32m 2[2mms[22m[39m
 [32mâœ“[39m backend/src/config/__tests__/paths.test.ts[2m > [22mPathConfig[2m > [22mgetPaths[2m > [22mshould return correct path values[32m 3[2mms[22m[39m
 [32mâœ“[39m backend/src/config/__tests__/paths.test.ts[2m > [22mPathConfig[2m > [22mgetPaths[2m > [22mshould cache paths after first call[32m 1[2mms[22m[39m
 [32mâœ“[39m backend/src/config/__tests__/paths.test.ts[2m > [22mPathConfig[2m > [22mgetPaths[2m > [22mshould return readonly paths object[32m 1[2mms[22m[39m
 [32mâœ“[39m backend/src/config/__tests__/paths.test.ts[2m > [22mPathConfig[2m > [22mgetPaths[2m > [22mshould use cached workspace and backend root when available[32m 1[2mms[22m[39m
 [32mâœ“[39m backend/src/config/__tests__/paths.test.ts[2m > [22mPathConfig[2m > [22mintegration[2m > [22mshould work correctly when all methods are called in sequence[32m 1[2mms[22m[39m
 [32mâœ“[39m backend/src/config/__tests__/paths.test.ts[2m > [22mPathConfig[2m > [22mintegration[2m > [22mshould handle empty string PROJECT_ROOT[32m 1[2mms[22m[39m
 [32mâœ“[39m backend/src/config/__tests__/paths.test.ts[2m > [22mPathConfig[2m > [22mintegration[2m > [22mshould throw error when getPaths is called without PROJECT_ROOT[32m 1[2mms[22m[39m
 [32mâœ“[39m backend/src/services/base/__tests__/BaseEntityService.test.ts[2m > [22mBaseEntityService[2m > [22mgetById[2m > [22mshould return null when entity does not exist[32m 6[2mms[22m[39m
 [32mâœ“[39m backend/src/services/base/__tests__/BaseEntityService.test.ts[2m > [22mBaseEntityService[2m > [22mgetById[2m > [22mshould return entity when it exists[32m 3[2mms[22m[39m
 [32mâœ“[39m backend/src/services/base/__tests__/BaseEntityService.test.ts[2m > [22mBaseEntityService[2m > [22mgetAllByUserId[2m > [22mshould return empty array when no entities exist[32m 3[2mms[22m[39m
 [32mâœ“[39m backend/src/services/base/__tests__/BaseEntityService.test.ts[2m > [22mBaseEntityService[2m > [22mgetAllByUserId[2m > [22mshould return all entities for a user[32m 3[2mms[22m[39m
 [32mâœ“[39m backend/src/setup/__tests__/constants.test.ts[2m > [22mConstants[2m > [22mAI Service Constants[2m > [22mshould export PERPLEXITY_DEFAULT_MODEL with correct value[32m 3[2mms[22m[39m
 [32mâœ“[39m backend/src/setup/__tests__/constants.test.ts[2m > [22mConstants[2m > [22mAI Service Constants[2m > [22mshould export PERPLEXITY_API_URL with correct value[32m 1[2mms[22m[39m
 [32mâœ“[39m backend/src/setup/__tests__/constants.test.ts[2m > [22mConstants[2m > [22mAI Service Constants[2m > [22mshould export AI_DEFAULT_EMOJI with correct value[32m 1[2mms[22m[39m
 [32mâœ“[39m backend/src/setup/__tests__/constants.test.ts[2m > [22mConstants[2m > [22mAI Service Constants[2m > [22mshould have PERPLEXITY_DEFAULT_MODEL as a string[32m 1[2mms[22m[39m
 [32mâœ“[39m backend/src/setup/__tests__/constants.test.ts[2m > [22mConstants[2m > [22mAI Service Constants[2m > [22mshould have PERPLEXITY_API_URL as a valid URL string[32m 1[2mms[22m[39m
 [32mâœ“[39m backend/src/setup/__tests__/constants.test.ts[2m > [22mConstants[2m > [22mAI Service Constants[2m > [22mshould have AI_DEFAULT_EMOJI as a non-empty string[32m 1[2mms[22m[39m
 [32mâœ“[39m backend/src/setup/__tests__/constants.test.ts[2m > [22mConstants[2m > [22mgetPort[2m > [22mshould return port number from PORT environment variable (Railway/production)[32m 1[2mms[22m[39m
 [32mâœ“[39m backend/src/setup/__tests__/constants.test.ts[2m > [22mConstants[2m > [22mgetPort[2m > [22mshould return port number from VITE_PORT environment variable (development)[32m 1[2mms[22m[39m
 [32mâœ“[39m backend/src/setup/__tests__/constants.test.ts[2m > [22mConstants[2m > [22mgetPort[2m > [22mshould prioritize PORT over VITE_PORT when both are set[32m 1[2mms[22m[39m
 [32mâœ“[39m backend/src/setup/__tests__/constants.test.ts[2m > [22mConstants[2m > [22mgetPort[2m > [22mshould throw error when PORT and VITE_PORT are not set[32m 2[2mms[22m[39m
 [32mâœ“[39m backend/src/setup/__tests__/constants.test.ts[2m > [22mConstants[2m > [22mgetPort[2m > [22mshould throw error when VITE_PORT is invalid (not a number)[32m 1[2mms[22m[39m
 [32mâœ“[39m backend/src/setup/__tests__/constants.test.ts[2m > [22mConstants[2m > [22mgetPort[2m > [22mshould throw error when VITE_PORT is zero[32m 1[2mms[22m[39m
 [32mâœ“[39m backend/src/setup/__tests__/constants.test.ts[2m > [22mConstants[2m > [22mgetPort[2m > [22mshould throw error when VITE_PORT is negative[32m 1[2mms[22m[39m
 [32mâœ“[39m backend/src/setup/__tests__/constants.test.ts[2m > [22mConstants[2m > [22mgetServerUrl[2m > [22mshould return server URL from VITE_SERVER_URL environment variable[32m 1[2mms[22m[39m
 [32mâœ“[39m backend/src/setup/__tests__/constants.test.ts[2m > [22mConstants[2m > [22mgetServerUrl[2m > [22mshould throw error when VITE_SERVER_URL is not set[32m 1[2mms[22m[39m
 [32mâœ“[39m backend/src/setup/__tests__/constants.test.ts[2m > [22mConstants[2m > [22mgetServerUrl[2m > [22mshould return any valid string as server URL[32m 1[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/authService.test.ts[2m > [22mAuthService[2m > [22mverifyToken[2m > [22mshould verify valid token and return user ID[32m 10[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/authService.test.ts[2m > [22mAuthService[2m > [22mverifyToken[2m > [22mshould throw error for invalid token[32m 4[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/authService.test.ts[2m > [22mAuthService[2m > [22mverifyToken[2m > [22mshould throw error for expired token[32m 2[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/authService.test.ts[2m > [22mAuthService[2m > [22mgetUserById[2m > [22mshould return user for existing ID[32m 4[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/authService.test.ts[2m > [22mAuthService[2m > [22mgetUserById[2m > [22mshould return null for non-existent ID[32m 2[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/authService.test.ts[2m > [22mAuthService[2m > [22mrequestEmailChange[2m > [22mshould request email change successfully[32m 5[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/authService.test.ts[2m > [22mAuthService[2m > [22mrequestEmailChange[2m > [22mshould throw error if user not found[32m 2[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/authService.test.ts[2m > [22mAuthService[2m > [22mrequestEmailChange[2m > [22mshould throw error if new email is same as current email[32m 2[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/authService.test.ts[2m > [22mAuthService[2m > [22mrequestEmailChange[2m > [22mshould throw error if new email is already registered[32m 2[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/authService.test.ts[2m > [22mAuthService[2m > [22mrequestEmailChange[2m > [22mshould throw error for invalid email format[32m 2[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/authService.test.ts[2m > [22mAuthService[2m > [22mrequestEmailChange[2m > [22mshould check for duplicate email before cooldown[32m 2[2mms[22m[39m
 [32mâœ“[39m backend/src/__tests__/server.test.ts[2m > [22mServer Configuration - Integration Tests[2m > [22mServer.ts Complete Integration - Real Execution Tests[2m > [22mshould execute middleware for error responses[33m 495[2mms[22m[39m
[90mstderr[2m | backend/src/middleware/__tests__/adminMiddleware.test.ts[2m > [22m[2mAdminMiddleware[2m > [22m[2mrequireAdmin[2m > [22m[2mshould return 500 if ADMIN_EMAIL is not configured
[22m[39m[2026-01-15T18:50:47.480Z] ADMIN_MIDDLEWARE | ADMIN_EMAIL not configured

[90mstderr[2m | backend/src/middleware/__tests__/adminMiddleware.test.ts[2m > [22m[2mAdminMiddleware[2m > [22m[2mrequireAdmin[2m > [22m[2mshould return 500 if getUserById throws an error
[22m[39m[2026-01-15T18:50:47.486Z] ADMIN_MIDDLEWARE | Error: Error: Database error
    at D:/Code/habitus/backend/src/middleware/__tests__/adminMiddleware.test.ts:198:9
    at [90mfile:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
    at [90mfile:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:919:26
    at [90mfile:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1244:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1210:10[90m)[39m
    at [90mfile:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1654:37
    at Traces.$ [90m(file:///D:/Code/habitus/[39mnode_modules/[4mvitest[24m/dist/chunks/traces.U4xDYhzZ.js:115:27[90m)[39m
    at trace [90m(file:///D:/Code/habitus/[39mnode_modules/[4mvitest[24m/dist/chunks/test.DqQZzsWf.js:234:21[90m)[39m
    at runTest [90m(file:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1654:12[90m)[39m

 [32mâœ“[39m backend/src/middleware/__tests__/adminMiddleware.test.ts[2m > [22mAdminMiddleware[2m > [22mconstructor[2m > [22mshould create AdminMiddleware instance[32m 2[2mms[22m[39m
 [32mâœ“[39m backend/src/middleware/__tests__/adminMiddleware.test.ts[2m > [22mAdminMiddleware[2m > [22mrequireAdmin[2m > [22mshould return 500 if ADMIN_EMAIL is not configured[32m 3[2mms[22m[39m
 [32mâœ“[39m backend/src/middleware/__tests__/adminMiddleware.test.ts[2m > [22mAdminMiddleware[2m > [22mrequireAdmin[2m > [22mshould return 401 if user is not authenticated[32m 1[2mms[22m[39m
 [32mâœ“[39m backend/src/middleware/__tests__/adminMiddleware.test.ts[2m > [22mAdminMiddleware[2m > [22mrequireAdmin[2m > [22mshould return 404 if user is not found[32m 1[2mms[22m[39m
 [32mâœ“[39m backend/src/middleware/__tests__/adminMiddleware.test.ts[2m > [22mAdminMiddleware[2m > [22mrequireAdmin[2m > [22mshould return 403 if user email does not match ADMIN_EMAIL[32m 0[2mms[22m[39m
 [32mâœ“[39m backend/src/middleware/__tests__/adminMiddleware.test.ts[2m > [22mAdminMiddleware[2m > [22mrequireAdmin[2m > [22mshould allow access if user email matches ADMIN_EMAIL (case insensitive)[32m 0[2mms[22m[39m
 [32mâœ“[39m backend/src/middleware/__tests__/adminMiddleware.test.ts[2m > [22mAdminMiddleware[2m > [22mrequireAdmin[2m > [22mshould allow access if user email matches ADMIN_EMAIL[32m 0[2mms[22m[39m
 [32mâœ“[39m backend/src/middleware/__tests__/adminMiddleware.test.ts[2m > [22mAdminMiddleware[2m > [22mrequireAdmin[2m > [22mshould return 500 if getUserById throws an error[32m 4[2mms[22m[39m
 [32mâœ“[39m backend/src/middleware/__tests__/adminMiddleware.test.ts[2m > [22mAdminMiddleware[2m > [22mrequireAdmin function wrapper[2m > [22mshould call AdminMiddleware instance requireAdmin method[32m 0[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/DateUtils.test.ts[2m > [22mDateUtils.createDateTimeInTimezone[2m > [22mwithout timezone (UTC)[2m > [22mshould create a date in UTC when no timezone is provided[32m 1[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/DateUtils.test.ts[2m > [22mDateUtils.createDateTimeInTimezone[2m > [22mwithout timezone (UTC)[2m > [22mshould create a date in UTC at midnight when no timezone is provided[32m 0[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/DateUtils.test.ts[2m > [22mDateUtils.createDateTimeInTimezone[2m > [22mwith timezone - America/Buenos_Aires (UTC-3)[2m > [22mshould convert local time to UTC correctly - afternoon time[32m 1[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/DateUtils.test.ts[2m > [22mDateUtils.createDateTimeInTimezone[2m > [22mwith timezone - America/Buenos_Aires (UTC-3)[2m > [22mshould convert local time to UTC correctly - morning time[32m 0[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/DateUtils.test.ts[2m > [22mDateUtils.createDateTimeInTimezone[2m > [22mwith timezone - America/Buenos_Aires (UTC-3)[2m > [22mshould create a future UTC time when creating a future local time[32m 1[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/DateUtils.test.ts[2m > [22mDateUtils.createDateTimeInTimezone[2m > [22mwith timezone - America/Buenos_Aires (UTC-3)[2m > [22mshould handle minutes correctly[32m 0[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/DateUtils.test.ts[2m > [22mDateUtils.createDateTimeInTimezone[2m > [22mwith timezone - America/New_York (UTC-5 or UTC-4 with DST)[2m > [22mshould convert local time to UTC correctly[32m 0[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/DateUtils.test.ts[2m > [22mDateUtils.createDateTimeInTimezone[2m > [22mwith timezone - America/New_York (UTC-5 or UTC-4 with DST)[2m > [22mshould create a future UTC time when creating a future local time[32m 0[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/DateUtils.test.ts[2m > [22mDateUtils.createDateTimeInTimezone[2m > [22medge cases[2m > [22mshould handle midnight (00:00) correctly[32m 0[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/DateUtils.test.ts[2m > [22mDateUtils.createDateTimeInTimezone[2m > [22medge cases[2m > [22mshould handle end of day (23:59) correctly[32m 0[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/DateUtils.test.ts[2m > [22mDateUtils.createDateTimeInTimezone[2m > [22medge cases[2m > [22mshould handle date boundaries correctly (crossing UTC date)[32m 0[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/DateUtils.test.ts[2m > [22mDateUtils.createDateTimeInTimezone[2m > [22mintegration test - simulates one-time tracking creation[2m > [22mshould create a reminder that will be UPCOMING, not PENDING, for a future date[32m 0[2mms[22m[39m
 [32mâœ“[39m backend/src/services/lifecycle/__tests__/ReminderLifecycleManager.test.ts[2m > [22mReminderLifecycleManager[2m > [22mstatus transitions[2m > [22mshould validate valid transition from PENDING to ANSWERED[32m 5[2mms[22m[39m
 [32mâœ“[39m backend/src/services/lifecycle/__tests__/ReminderLifecycleManager.test.ts[2m > [22mReminderLifecycleManager[2m > [22mstatus transitions[2m > [22mshould reject transition from ANSWERED[32m 2[2mms[22m[39m
 [32mâœ“[39m backend/src/services/lifecycle/__tests__/ReminderLifecycleManager.test.ts[2m > [22mReminderLifecycleManager[2m > [22mstatus transitions[2m > [22mshould reject transition to same status[32m 2[2mms[22m[39m
 [32mâœ“[39m backend/src/services/lifecycle/__tests__/ReminderLifecycleManager.test.ts[2m > [22mReminderLifecycleManager[2m > [22mone-time tracking archiving[2m > [22mshould archive one-time tracking when last scheduled time becomes Pending[32m 8[2mms[22m[39m
 [32mâœ“[39m backend/src/services/lifecycle/__tests__/ReminderLifecycleManager.test.ts[2m > [22mReminderLifecycleManager[2m > [22mone-time tracking archiving[2m > [22mshould create next reminder for one-time tracking when not last[32m 4[2mms[22m[39m
 [32mâœ“[39m backend/src/services/lifecycle/__tests__/ReminderLifecycleManager.test.ts[2m > [22mReminderLifecycleManager[2m > [22mone-time tracking archiving[2m > [22mshould allow answering Pending reminder after one-time tracking is archived[32m 7[2mms[22m[39m
 [32mâœ“[39m backend/src/services/lifecycle/__tests__/TrackingLifecycleManager.test.ts[2m > [22mTrackingLifecycleManager[2m > [22mstate transitions[2m > [22mshould validate valid transition[32m 5[2mms[22m[39m
 [32mâœ“[39m backend/src/services/lifecycle/__tests__/TrackingLifecycleManager.test.ts[2m > [22mTrackingLifecycleManager[2m > [22mstate transitions[2m > [22mshould handle paused state transition and delete upcoming reminders[32m 3[2mms[22m[39m
 [32mâœ“[39m backend/src/services/lifecycle/__tests__/TrackingLifecycleManager.test.ts[2m > [22mTrackingLifecycleManager[2m > [22marchived state reminder handling[2m > [22mshould preserve Pending reminders for one-time trackings when archived[32m 4[2mms[22m[39m
 [32mâœ“[39m backend/src/services/lifecycle/__tests__/TrackingLifecycleManager.test.ts[2m > [22mTrackingLifecycleManager[2m > [22marchived state reminder handling[2m > [22mshould delete Pending reminders for recurring trackings when archived[32m 3[2mms[22m[39m
 [32mâœ“[39m backend/src/__tests__/server.test.ts[2m > [22mServer Configuration - Integration Tests[2m > [22mServer.ts Complete Integration - Real Execution Tests[2m > [22mshould execute shutdown handler for SIGTERM[33m 416[2mms[22m[39m
[90mstderr[2m | backend/src/services/lifecycle/__tests__/LifecycleManager.test.ts[2m > [22m[2mLifecycleManager[2m > [22m[2monCreate[2m > [22m[2mshould execute onCreate handlers
[22m[39m[2026-01-15T18:50:47.933Z] ERROR   | DATABASE | Query execution failed: SELECT id, user_id, question, notes, icon, frequency, state, created_at, updated_at FROM trackings W [Error: SQLITE_ERROR: no such column: frequency] {
  errno: [33m1[39m,
  code: [32m'SQLITE_ERROR'[39m
}

[90mstderr[2m | backend/src/services/lifecycle/__tests__/LifecycleManager.test.ts[2m > [22m[2mLifecycleManager[2m > [22m[2monCreate[2m > [22m[2mshould execute onCreate handlers
[22m[39m[2026-01-15T18:50:47.934Z] TRACKING_LIFECYCLE | Failed to create initial reminder for tracking 1: [Error: SQLITE_ERROR: no such column: frequency] {
  errno: [33m1[39m,
  code: [32m'SQLITE_ERROR'[39m
}

 [32mâœ“[39m backend/src/services/lifecycle/__tests__/LifecycleManager.test.ts[2m > [22mLifecycleManager[2m > [22mtransition[2m > [22mshould validate transition and call hooks[32m 4[2mms[22m[39m
 [32mâœ“[39m backend/src/services/lifecycle/__tests__/LifecycleManager.test.ts[2m > [22mLifecycleManager[2m > [22mtransition[2m > [22mshould throw error for same state transition[32m 2[2mms[22m[39m
 [32mâœ“[39m backend/src/services/lifecycle/__tests__/LifecycleManager.test.ts[2m > [22mLifecycleManager[2m > [22monCreate[2m > [22mshould execute onCreate handlers[32m 3[2mms[22m[39m
 [32mâœ“[39m backend/src/__tests__/server.test.ts[2m > [22mServer Configuration - Integration Tests[2m > [22mServer.ts Complete Integration - Real Execution Tests[2m > [22mshould execute shutdown handler for SIGINT[33m 415[2mms[22m[39m
 [32mâœ“[39m backend/src/__tests__/server.test.ts[2m > [22mServer Configuration - Integration Tests[2m > [22mServer.ts Complete Integration - Real Execution Tests[2m > [22mshould handle shutdown with Vite server[33m 521[2mms[22m[39m
 [32mâœ“[39m backend/src/__tests__/server.test.ts[2m > [22mServer Configuration - Integration Tests[2m > [22mServer.ts Complete Integration - Real Execution Tests[2m > [22mshould handle shutdown when server.close fails[33m 410[2mms[22m[39m
 [32mâœ“[39m backend/src/__tests__/server.test.ts[2m > [22mServer Configuration - Integration Tests[2m > [22mServer.ts Complete Integration - Real Execution Tests[2m > [22mshould handle database close error during shutdown[33m 512[2mms[22m[39m
 [32mâœ“[39m backend/src/__tests__/server.test.ts[2m > [22mServer Configuration - Integration Tests[2m > [22mServer.ts Complete Integration - Real Execution Tests[2m > [22mshould handle Vite close error during shutdown[33m 518[2mms[22m[39m
 [32mâœ“[39m backend/src/__tests__/server.test.ts[2m > [22mServer Configuration - Integration Tests[2m > [22mServer.ts Complete Integration - Real Execution Tests[2m > [22mshould handle database initialization failure[33m 713[2mms[22m[39m
 [32mâœ“[39m backend/src/__tests__/server.test.ts[2m > [22mServer Configuration - Integration Tests[2m > [22mServer.ts Complete Integration - Real Execution Tests[2m > [22mshould execute production static file serving branch[33m 408[2mms[22m[39m
[90mstderr[2m | backend/src/services/__tests__/emailService.test.ts[2m > [22m[2mEmailService[2m > [22m[2msendMagicLink[2m > [22m[2mshould throw error when SMTP credentials are missing
[22m[39m[2026-01-15T18:50:51.687Z] ERROR   | EMAIL | All 3 attempts failed for registration magic link email to user@example.com: Error: SMTP credentials not configured. Please set SMTP_USER and SMTP_PASS environment variables.
    at EmailService.getTransporter (D:/Code/habitus/backend/src/services/emailService.ts:104:13)
    at EmailService.sendMagicLink (D:/Code/habitus/backend/src/services/emailService.ts:296:38)
    at D:/Code/habitus/backend/src/services/__tests__/emailService.test.ts:139:7
    at [90mfile:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:919:20

 [32mâœ“[39m backend/src/services/__tests__/emailService.test.ts[2m > [22mEmailService[2m > [22msendMagicLink[2m > [22mshould throw error when SMTP credentials are missing[33m 6019[2mms[22m[39m
 [32mâœ“[39m backend/src/__tests__/server.test.ts[2m > [22mServer Configuration - Integration Tests[2m > [22mServer.ts Complete Integration - Real Execution Tests[2m > [22mshould execute development Vite route handling[33m 427[2mms[22m[39m
 [32mâœ“[39m backend/src/__tests__/server.test.ts[2m > [22mServer Configuration - Integration Tests[2m > [22mServer.ts Complete Integration - Real Execution Tests[2m > [22mshould skip Vite routes in logging middleware[33m 475[2mms[22m[39m
 [32mâœ“[39m backend/src/__tests__/server.test.ts[2m > [22mServer Configuration - Integration Tests[2m > [22mServer.ts Complete Integration - Real Execution Tests[2m > [22mshould handle error in Vite transformIndexHtml[33m 416[2mms[22m[39m
 [32mâœ“[39m backend/src/__tests__/server.test.ts[2m > [22mServer Configuration - Integration Tests[2m > [22mServer.ts Complete Integration - Real Execution Tests[2m > [22mshould prevent multiple shutdown calls[33m 410[2mms[22m[39m
 [32mâœ“[39m backend/src/__tests__/server.test.ts[2m > [22mServer Configuration - Integration Tests[2m > [22mServer.ts Complete Integration - Real Execution Tests[2m > [22mshould execute verbose logging in development mode[33m 467[2mms[22m[39m
 [32mâœ“[39m backend/src/__tests__/server.test.ts[2m > [22mServer Configuration - Integration Tests[2m > [22mServer.ts Complete Integration - Real Execution Tests[2m > [22mshould handle TRUST_PROXY configuration[33m 416[2mms[22m[39m
 [31mÃ—[39m backend/src/__tests__/server.test.ts[2m > [22mServer Configuration - Integration Tests[2m > [22mServer.ts Complete Integration - Real Execution Tests[2m > [22mshould handle port conflict error with helpful message[33m 714[2mms[22m[39m
[31m   â†’ expected false to be true // Object.is equality[39m
 [32mâœ“[39m backend/src/__tests__/server.test.ts[2m > [22mServer Configuration - Integration Tests[2m > [22mServer.ts Complete Integration - Real Execution Tests[2m > [22mshould handle URL parsing failure and use localhost[33m 409[2mms[22m[39m
 [32mâœ“[39m backend/src/__tests__/server.test.ts[2m > [22mServer Configuration - Integration Tests[2m > [22mServer.ts Complete Integration - Real Execution Tests[2m > [22mshould parse VITE_HMR_PORT environment variable[33m 422[2mms[22m[39m
 [32mâœ“[39m backend/src/__tests__/server.test.ts[2m > [22mServer Configuration - Integration Tests[2m > [22mServer.ts Complete Integration - Real Execution Tests[2m > [22mshould return 404 when index.html does not exist in production[33m 418[2mms[22m[39m
 [32mâœ“[39m backend/src/__tests__/server.test.ts[2m > [22mServer Configuration - Integration Tests[2m > [22mServer.ts Complete Integration - Real Execution Tests[2m > [22mshould handle readFileSync error in production[33m 415[2mms[22m[39m
 [32mâœ“[39m backend/src/__tests__/server.test.ts[2m > [22mServer Configuration - Integration Tests[2m > [22mServer.ts Complete Integration - Real Execution Tests[2m > [22mshould skip error handling when headers already sent[33m 420[2mms[22m[39m
 [32mâœ“[39m backend/src/__tests__/server.test.ts[2m > [22mServer Configuration - Integration Tests[2m > [22mServer.ts Complete Integration - Real Execution Tests[2m > [22mshould handle URL without http prefix[33m 411[2mms[22m[39m
 [32mâœ“[39m backend/src/__tests__/server.test.ts[2m > [22mServer Configuration - Integration Tests[2m > [22mServer.ts Complete Integration - Real Execution Tests[2m > [22mshould handle URL with http prefix[33m 416[2mms[22m[39m
[90mstderr[2m | backend/src/services/__tests__/emailService.test.ts[2m > [22m[2mEmailService[2m > [22m[2msendMagicLink[2m > [22m[2mshould throw error for Gmail app-specific password requirement
[22m[39m[2026-01-15T18:50:57.710Z] ERROR   | EMAIL | All 3 attempts failed for registration magic link email to user@example.com: Error: Authentication failed
    at D:/Code/habitus/backend/src/services/__tests__/emailService.test.ts:149:26
    at [90mfile:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
    at [90mfile:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:919:26
    at [90mfile:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1244:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1210:10[90m)[39m
    at [90mfile:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1654:37
    at Traces.$ [90m(file:///D:/Code/habitus/[39mnode_modules/[4mvitest[24m/dist/chunks/traces.U4xDYhzZ.js:115:27[90m)[39m
    at trace [90m(file:///D:/Code/habitus/[39mnode_modules/[4mvitest[24m/dist/chunks/test.DqQZzsWf.js:234:21[90m)[39m
    at runTest [90m(file:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1654:12[90m)[39m {
  code: [32m'EAUTH'[39m,
  responseCode: [33m534[39m
}

 [32mâœ“[39m backend/src/services/__tests__/emailService.test.ts[2m > [22mEmailService[2m > [22msendMagicLink[2m > [22mshould throw error for Gmail app-specific password requirement[33m 6019[2mms[22m[39m
[90mstderr[2m | backend/src/services/__tests__/emailService.test.ts[2m > [22m[2mEmailService[2m > [22m[2msendMagicLink[2m > [22m[2mshould throw error for other EAUTH errors
[22m[39m[2026-01-15T18:51:03.727Z] ERROR   | EMAIL | All 3 attempts failed for registration magic link email to user@example.com: Error: Invalid credentials
    at D:/Code/habitus/backend/src/services/__tests__/emailService.test.ts:164:26
    at [90mfile:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
    at [90mfile:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:919:26
    at [90mfile:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1244:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1210:10[90m)[39m
    at [90mfile:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1654:37
    at Traces.$ [90m(file:///D:/Code/habitus/[39mnode_modules/[4mvitest[24m/dist/chunks/traces.U4xDYhzZ.js:115:27[90m)[39m
    at trace [90m(file:///D:/Code/habitus/[39mnode_modules/[4mvitest[24m/dist/chunks/test.DqQZzsWf.js:234:21[90m)[39m
    at runTest [90m(file:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1654:12[90m)[39m {
  code: [32m'EAUTH'[39m,
  response: [32m'Invalid login'[39m
}

 [32mâœ“[39m backend/src/services/__tests__/emailService.test.ts[2m > [22mEmailService[2m > [22msendMagicLink[2m > [22mshould throw error for other EAUTH errors[33m 6017[2mms[22m[39m
[90mstderr[2m | backend/src/services/__tests__/emailService.test.ts[2m > [22m[2mEmailService[2m > [22m[2msendMagicLink[2m > [22m[2mshould throw error for generic email sending failures
[22m[39m[2026-01-15T18:51:09.746Z] ERROR   | EMAIL | All 3 attempts failed for registration magic link email to user@example.com: Error: Network error
    at D:/Code/habitus/backend/src/services/__tests__/emailService.test.ts:179:21
    at [90mfile:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
    at [90mfile:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:919:26
    at [90mfile:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1244:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1210:10[90m)[39m
    at [90mfile:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1654:37
    at Traces.$ [90m(file:///D:/Code/habitus/[39mnode_modules/[4mvitest[24m/dist/chunks/traces.U4xDYhzZ.js:115:27[90m)[39m
    at trace [90m(file:///D:/Code/habitus/[39mnode_modules/[4mvitest[24m/dist/chunks/test.DqQZzsWf.js:234:21[90m)[39m
    at runTest [90m(file:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1654:12[90m)[39m

[90mstderr[2m | backend/src/services/__tests__/emailService.test.ts[2m > [22m[2mEmailService[2m > [22m[2msendEmail[2m > [22m[2mshould throw error when SMTP credentials are missing
[22m[39m[2026-01-15T18:51:09.750Z] ERROR   | EMAIL | Error sending email to user@example.com: Error: SMTP credentials not configured. Please set SMTP_USER and SMTP_PASS environment variables.
    at EmailService.getTransporter (D:/Code/habitus/backend/src/services/emailService.ts:104:13)
    at EmailService.sendEmail (D:/Code/habitus/backend/src/services/emailService.ts:537:36)
    at D:/Code/habitus/backend/src/services/__tests__/emailService.test.ts:331:31
    at [90mfile:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
    at [90mfile:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:919:26
    at [90mfile:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1244:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1210:10[90m)[39m
    at [90mfile:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1654:37
    at Traces.$ [90m(file:///D:/Code/habitus/[39mnode_modules/[4mvitest[24m/dist/chunks/traces.U4xDYhzZ.js:115:27[90m)[39m

[90mstderr[2m | backend/src/services/__tests__/emailService.test.ts[2m > [22m[2mEmailService[2m > [22m[2msendEmail[2m > [22m[2mshould throw error for Gmail app-specific password requirement
[22m[39m[2026-01-15T18:51:09.752Z] ERROR   | EMAIL | Error sending email to user@example.com: Error: Authentication failed
    at D:/Code/habitus/backend/src/services/__tests__/emailService.test.ts:336:26
    at [90mfile:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
    at [90mfile:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:919:26
    at [90mfile:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1244:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1210:10[90m)[39m
    at [90mfile:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1654:37
    at Traces.$ [90m(file:///D:/Code/habitus/[39mnode_modules/[4mvitest[24m/dist/chunks/traces.U4xDYhzZ.js:115:27[90m)[39m
    at trace [90m(file:///D:/Code/habitus/[39mnode_modules/[4mvitest[24m/dist/chunks/test.DqQZzsWf.js:234:21[90m)[39m
    at runTest [90m(file:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1654:12[90m)[39m {
  code: [32m'EAUTH'[39m,
  responseCode: [33m534[39m
}

[90mstderr[2m | backend/src/services/__tests__/emailService.test.ts[2m > [22m[2mEmailService[2m > [22m[2msendEmail[2m > [22m[2mshould throw error for other EAUTH errors
[22m[39m[2026-01-15T18:51:09.753Z] ERROR   | EMAIL | Error sending email to user@example.com: Error: Invalid credentials
    at D:/Code/habitus/backend/src/services/__tests__/emailService.test.ts:347:26
    at [90mfile:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
    at [90mfile:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:919:26
    at [90mfile:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1244:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1210:10[90m)[39m
    at [90mfile:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1654:37
    at Traces.$ [90m(file:///D:/Code/habitus/[39mnode_modules/[4mvitest[24m/dist/chunks/traces.U4xDYhzZ.js:115:27[90m)[39m
    at trace [90m(file:///D:/Code/habitus/[39mnode_modules/[4mvitest[24m/dist/chunks/test.DqQZzsWf.js:234:21[90m)[39m
    at runTest [90m(file:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1654:12[90m)[39m {
  code: [32m'EAUTH'[39m,
  response: [32m'Invalid login'[39m
}

[90mstderr[2m | backend/src/services/__tests__/emailService.test.ts[2m > [22m[2mEmailService[2m > [22m[2msendEmail[2m > [22m[2mshould throw error for generic email sending failures
[22m[39m[2026-01-15T18:51:09.754Z] ERROR   | EMAIL | Error sending email to user@example.com: Error: Network error
    at D:/Code/habitus/backend/src/services/__tests__/emailService.test.ts:359:21
    at [90mfile:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
    at [90mfile:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:919:26
    at [90mfile:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1244:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1210:10[90m)[39m
    at [90mfile:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1654:37
    at Traces.$ [90m(file:///D:/Code/habitus/[39mnode_modules/[4mvitest[24m/dist/chunks/traces.U4xDYhzZ.js:115:27[90m)[39m
    at trace [90m(file:///D:/Code/habitus/[39mnode_modules/[4mvitest[24m/dist/chunks/test.DqQZzsWf.js:234:21[90m)[39m
    at runTest [90m(file:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1654:12[90m)[39m

[90mstderr[2m | backend/src/services/__tests__/emailService.test.ts[2m > [22m[2mEmailService[2m > [22m[2msendReminderEmail[2m > [22m[2mshould throw error when SMTP credentials are missing
[22m[39m[2026-01-15T18:51:09.760Z] ERROR   | EMAIL | Error sending email to user@example.com: Error: SMTP credentials not configured. Please set SMTP_USER and SMTP_PASS environment variables.
    at EmailService.getTransporter (D:/Code/habitus/backend/src/services/emailService.ts:104:13)
    at EmailService.sendEmail (D:/Code/habitus/backend/src/services/emailService.ts:537:36)
    at EmailService.sendReminderEmail (D:/Code/habitus/backend/src/services/emailService.ts:486:16)
    at D:/Code/habitus/backend/src/services/__tests__/emailService.test.ts:530:31
    at [90mfile:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
    at [90mfile:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:919:26
    at [90mfile:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1244:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1210:10[90m)[39m
    at [90mfile:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1654:37

[90mstderr[2m | backend/src/services/__tests__/emailService.test.ts[2m > [22m[2mEmailService[2m > [22m[2msendReminderEmail[2m > [22m[2mshould handle email sending errors
[22m[39m[2026-01-15T18:51:09.761Z] ERROR   | EMAIL | Error sending email to user@example.com: Error: Network error
    at D:/Code/habitus/backend/src/services/__tests__/emailService.test.ts:543:21
    at [90mfile:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
    at [90mfile:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:919:26
    at [90mfile:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1244:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1210:10[90m)[39m
    at [90mfile:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1654:37
    at Traces.$ [90m(file:///D:/Code/habitus/[39mnode_modules/[4mvitest[24m/dist/chunks/traces.U4xDYhzZ.js:115:27[90m)[39m
    at trace [90m(file:///D:/Code/habitus/[39mnode_modules/[4mvitest[24m/dist/chunks/test.DqQZzsWf.js:234:21[90m)[39m
    at runTest [90m(file:///D:/Code/habitus/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1654:12[90m)[39m

 [32mâœ“[39m backend/src/services/__tests__/emailService.test.ts[2m > [22mEmailService[2m > [22msendMagicLink[2m > [22mshould throw error for generic email sending failures[33m 6019[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/emailService.test.ts[2m > [22mEmailService[2m > [22msendMagicLink[2m > [22mshould use secure connection for port 465[32m 1[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/emailService.test.ts[2m > [22mEmailService[2m > [22msendMagicLink[2m > [22mshould create new transporter for each send (due to retry mechanism)[32m 0[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/emailService.test.ts[2m > [22mEmailService[2m > [22msendEmail[2m > [22mshould send email successfully[32m 1[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/emailService.test.ts[2m > [22mEmailService[2m > [22msendEmail[2m > [22mshould send email with HTML content[32m 0[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/emailService.test.ts[2m > [22mEmailService[2m > [22msendEmail[2m > [22mshould convert newlines to <br> when no HTML provided[32m 0[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/emailService.test.ts[2m > [22mEmailService[2m > [22msendEmail[2m > [22mshould send email change verification email with button[32m 0[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/emailService.test.ts[2m > [22mEmailService[2m > [22msendEmail[2m > [22mshould throw error when SMTP credentials are missing[32m 1[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/emailService.test.ts[2m > [22mEmailService[2m > [22msendEmail[2m > [22mshould throw error for Gmail app-specific password requirement[32m 1[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/emailService.test.ts[2m > [22mEmailService[2m > [22msendEmail[2m > [22mshould throw error for other EAUTH errors[32m 1[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/emailService.test.ts[2m > [22mEmailService[2m > [22msendEmail[2m > [22mshould throw error for generic email sending failures[32m 1[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/emailService.test.ts[2m > [22mEmailService[2m > [22msendReminderEmail[2m > [22mshould send reminder email successfully[32m 2[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/emailService.test.ts[2m > [22mEmailService[2m > [22msendReminderEmail[2m > [22mshould send reminder email without tracking notes[32m 1[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/emailService.test.ts[2m > [22mEmailService[2m > [22msendReminderEmail[2m > [22mshould use default icon when tracking icon is not provided[32m 1[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/emailService.test.ts[2m > [22mEmailService[2m > [22msendReminderEmail[2m > [22mshould include Add Notes button in email[32m 0[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/emailService.test.ts[2m > [22mEmailService[2m > [22msendReminderEmail[2m > [22mshould format scheduled time correctly[32m 0[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/emailService.test.ts[2m > [22mEmailService[2m > [22msendReminderEmail[2m > [22mshould display tracking notes after scheduled time when provided[32m 0[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/emailService.test.ts[2m > [22mEmailService[2m > [22msendReminderEmail[2m > [22mshould not display tracking notes when empty[32m 0[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/emailService.test.ts[2m > [22mEmailService[2m > [22msendReminderEmail[2m > [22mshould throw error when SMTP credentials are missing[32m 1[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/emailService.test.ts[2m > [22mEmailService[2m > [22msendReminderEmail[2m > [22mshould handle email sending errors[32m 1[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/emailService.test.ts[2m > [22mEmailService[2m > [22mBrevo API[2m > [22mshould use Brevo API when BREVO_API_KEY is set[32m 2[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/emailService.test.ts[2m > [22mEmailService[2m > [22mBrevo API[2m > [22mshould include fromName in Brevo API request[32m 0[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/emailService.test.ts[2m > [22mEmailService[2m > [22mBrevo API[2m > [22mshould throw error if BREVO_API_KEY is set but SMTP_FROM_EMAIL is missing[32m 0[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/emailService.test.ts[2m > [22mEmailService[2m > [22mBrevo API[2m > [22mshould throw error if Brevo API returns error[32m 0[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/emailService.test.ts[2m > [22mEmailService[2m > [22mBrevo API[2m > [22mshould use SMTP when BREVO_API_KEY is not set[32m 0[2mms[22m[39m
 [32mâœ“[39m backend/src/services/__tests__/emailService.test.ts[2m > [22mEmailService[2m > [22mBrevo API[2m > [22mshould use SMTP when BREVO_API_KEY is empty string[32m 0[2mms[22m[39m

[31mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[39m[1m[41m Failed Tests 1 [49m[22m[31mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[39m

[41m[1m FAIL [22m[49m backend/src/__tests__/server.test.ts[2m > [22mServer Configuration - Integration Tests[2m > [22mServer.ts Complete Integration - Real Execution Tests[2m > [22mshould handle port conflict error with helpful message
[31m[1mAssertionError[22m: expected false to be true // Object.is equality[39m

[32m- Expected[39m
[31m+ Received[39m

[32m- true[39m
[31m+ false[39m

[36m [2mâ¯[22m backend/src/__tests__/server.test.ts:[2m1857:33[22m[39m
    [90m1855| [39m          call[[34m0[39m][33m?.[39m[34mtoString[39m()[33m.[39m[34mincludes[39m([32m"port"[39m)
    [90m1856| [39m      )[33m;[39m
    [90m1857| [39m      [34mexpect[39m(hasHelpfulMessage)[33m.[39m[34mtoBe[39m([35mtrue[39m)[33m;[39m
    [90m   | [39m                                [31m^[39m
    [90m1858| [39m    })[33m;[39m
    [90m1859| [39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[1/1]âŽ¯[22m[39m


[2m Test Files [22m [1m[31m1 failed[39m[22m[2m | [22m[1m[32m31 passed[39m[22m[90m (32)[39m
[2m      Tests [22m [1m[31m1 failed[39m[22m[2m | [22m[1m[32m921 passed[39m[22m[90m (922)[39m
[2m   Start at [22m 15:50:44
[2m   Duration [22m 25.26s[2m (transform 5.19s, setup 9.07s, import 16.12s, tests 41.59s, environment 7ms)[22m

